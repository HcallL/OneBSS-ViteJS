<div class="main-wrapper">
  <breadcrumb :header="header" />
  <div class="list-actions-top">
    <ul class="list">
      <li>
        <a @click="tsbtnLayTTMoi_Click"> <span class="icon one-file-attach1" title="Lấy thông tin mới"></span>Lấy TT
        </a>
      </li>
      <li :style="!tsbtnCapNhat.visible ? 'display: none' : ''">
        <a @click="tsbtnCapNhat_Click"  :class="tsbtnCapNhat.enable ?'':'disabled'"> <span class="icon nc-icon-glyph one-save"></span>Cập Nhật </a>
      </li>

      <li :style="!tsbtnNghiemThu.visible ? 'display: none' : ''">
        <a :class="tsbtnNghiemThu.enable ?'':'disabled'" @click="tsbtnNghiemThu_Click"> <span class="icon nc-icon-glyph ui-1_check-circle-08"></span>Nghiệm thu </a>
      </li>
      <li :style="!tsbtnHoanCong.visible ? 'display: none' : ''">
        <a @click="tsbtnHoanCong_Click" :class="tsbtnHoanCong.enable ?'':'disabled'"> <span class="icon nc-icon-glyph one-hoancong"></span>Hoàn công </a>
      </li>
      <li  :style="!tsbtnChuyenVNPTI.visible ? 'display: none' : ''">
        <a @click="tsbtnChuyenVNPTI_Click"> <span class="dropdown-icon nc-icon-glyph arrows-1_simple-right"
            title="Chuyển phiếu Trung tâm viễn thông"></span> Chuyển TTVT </a>
      </li>
      <li :class="!tsbtnChuyenMedia.enable ? 'non-ative' : ''" :style="!tsbtnChuyenMedia.visible ? 'display: none' : ''">
        <a @click="tsbtnChuyenMedia_Click"> <span class="dropdown-icon nc-icon-glyph arrows-1_simple-right"
            title="Chuyển phiếu ChuyenOMCData"></span> Chuyển Media </a>
      </li>
      <!-- <li :class="!tsbtnChuyenOMCData.enable ? 'non-ative' : ''" :style="!tsbtnChuyenOMCData.visible ? 'display: none' : ''">
        <a @click="tsbtnChuyenOMCData_Click"> <span class="dropdown-icon nc-icon-glyph arrows-1_simple-right"
            title="Chuyển phiếu ChuyenOMCData"></span> Chuyển OMCData </a>
      </li> -->
      <li id="atsbtnChuyenTTDH" :class="!tsbtnChuyenTTDH.enable ? 'non-ative' : ''" :style="!tsbtnChuyenTTDH.visible ? 'display: none' : ''">
        <a @click="tsbtnChuyenTTDH_Click"> <span class="dropdown-icon nc-icon-glyph arrows-1_simple-right" title="Chuyển phiếu xử lý mạng lớp trên"></span> Chuyển TTDH </a>
      </li>
      <li  :class="!baoHongId ? 'non-ative' : ''" :style="!tsbtnGiaoPhoiHop.visible ? 'display: none' : ''">
        <a @click="tsbtnGiaoPhoiHop_Click"> <span class="dropdown-icon nc-icon-glyph arrows-1_simple-right" title="Chuyển phiếu xử lý mạng lớp trên"></span> Giao Phối Hợp </a>
      </li>
      <li>
        <a @click="$refs.uploadFileHS.click()">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-upload" viewBox="0 0 16 16">
            <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>
            <path d="M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708l3-3z"/>
          </svg> Upload Hồ Sơ</a>
          <input type="file" ref="uploadFileHS" hidden  @change="handleUploadFile($event)" > 
      </li>
      <li>
        <a @click="handleShowPopupDownloadHS" >
          <span>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-down-circle-fill" viewBox="0 0 16 16">
              <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8.5 4.5a.5.5 0 0 0-1 0v5.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V4.5z"/>
            </svg>
        </span> Download Hồ sơ</a>

      </li>

      <li>
        <a  @click="handleShowCreateFormTienTrinh"> <span class="icon nc-icon-glyph ui-1_circle-add"></span>Nhập mới TT</a>
      </li>
      <li>
        <a @click="handleForwardIT360"> <span class="icon one-list-arrow-right"
            title="Chuyển phiếu theo dõi"></span>Chuyển IT360 </a>
      </li>
      <li >
        <a @click="tsbtnExportExcel_Click"  :class="{disabled: listBaoHong.length == 0}">  <span class="icon one-excel"></span>Xuất Excel </a>
      </li>
    </ul>
    <!-- <div class="more dropdown">
      <a href="#" data-toggle="dropdown">
        <span class="icon -ap  icon-dots-three-vertical"></span>
      </a>
      <div class="dropdown-menu">


      </div>
    </div> -->
  </div>
  <div class="page-content">
    <div class="grid-stack-box">
      <!-- Thong Tin Thue bao -->
      <div class="box-col box-form" id="boxLeft">
        <div class="legend-title"><span class="icon fa fa-angle-up"></span> Thông tin thuê bao</div>
        <div class="row">
          <div class="col-sm-4 col-12">
            <div class="info-row">
              <div class="key w100">Dịch vụ</div>
              <div class="value">
                <div class="select-custom">
                  <ejs-dropdownlist locale="vi-VN" @change="cboDichVuVT_Changed" v-model="cboDichVuVT.value"
                    :dataSource="cboDichVuVT.dataSource" :allowFiltering="true"
                    :fields="{ value: 'DICHVUVT_ID', text: 'TEN_DVVT' }" />
                </div>
              </div>
            </div>
          </div>
          <div class="col-sm-4 col-12">
            <div class="info-row">
              <div class="key w100">Loại hình</div>
              <div class="value">
                <input type="text" class="form-control bold" v-model="txtLoaiTB" />
              </div>
            </div>
          </div>
          <div class="col-sm-4 col-12">
            <div class="info-row">
              <div class="key w100">Quy trình</div>
              <div class="value">
                <div class="select-custom">
                  <ejs-dropdownlist id="quytrinh_id" locale="vi-VN"  v-model="cboQuyTrinh.value" :disable="true"
                    :dataSource="cboQuyTrinh.dataSource" :allowFiltering="true"
                    :fields="{ value: 'quytrinh_id', text: 'quytrinh' }" />
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-4 col-12">
            <div class="info-row">
              <div class="key w100">Số máy/Acc</div>
              <div class="value">
                <input type="text" class="form-control highlight bold" v-model="txtMaTB"
                  id="txtMaTB" />
              </div>
            </div>
          </div>
          <div class="col-sm-4 col-12">
            <div class="info-row">
              <div class="key w100">Tên Thuê Bao</div>
              <div class="value">
                <input type="text" class="form-control bold" v-model="txtTenTB" />
              </div>
            </div>
          </div>
          <div class="col-sm-4 col-12">
            <div class="info-row">
              <div class="key w100">Ngày BH</div>
              <div class="value">
                <vue-date format="DD/MM/YYYY HH:mm A" type="datetime" v-model="dtpNgayBH" id="dtpNgayBH"
                  :disable="true"></vue-date>
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-4 col-12">
            <div class="info-row">
              <div class="key w100">Tình trạng hỏng</div>
              <div class="value">
                <div class="select-custom">
                  <ejs-dropdownlist id="tinhtrang_id" locale="vi-VN"
                    v-model="cboTinhTrang.value" :dataSource="cboTinhTrang.dataSource" :allowFiltering="true"
                     :fields="{ value: 'tinhtrang_id', text: 'tinhtrang' }" />
                </div>
              </div>
            </div>
          </div>
          <div class="col-sm-8 col-12">
            <div class="info-row">
              <div class="key w100">Điện thoại LH</div>
              <div class="value">
                <input type="text" class="form-control bold" v-model="txtDienThoaiLH" />
              </div>

            </div>
          </div>
        </div>
        <div class="info-row">
          <div class="key w100">Địa chỉ LD</div>
          <div class="value">
            <input type="text" class="form-control" v-model="txtDiaChiLD" />
          </div>
        </div>
        <div class="info-row">
          <div class="key w100">Trạng thái TB</div>
          <div class="value">
            <input type="text" class="form-control" v-model="txtTrangThaiTB" />
          </div>
        </div>
        <div class="info-row">
          <div class="key w100">Ghi chú</div>
          <div class="value">
            <input type="text" class="form-control" v-model="txtGhiChuBH" />
          </div>
        </div>
        <div class="legend-title">
          <div class="pull-left"><span class="icon fa fa-angle-up"></span>Thông tin xử lý</div>

          <div class="clearfix"></div>
        </div>
        <!-- Thong tin Xu ly -->
        <ThongTinXuLy ref="refThongTinXuLyComponent" :dichVuVTid="cboDichVuVT.value"  :baoHongItem="baoHongInfo" @update-event="hanldeThongTinXulyUpdate"></ThongTinXuLy>
      </div>
      <TienTrinhXuLy ref="refTienTrinhXuLyComponent" :baoHongItem='baoHongInfo' @show-form-update-event="hanldeShowUpdateFormTienTrinh" @on-row-selected="handleTienTrinhSelected"/>
    </div>
    <DanhSachPhieuBaoHong ref="refDanhSachBaoHongComponent" 
        @on-row-selected="onRowGridBaoHongSelected" 
        @on-check-tinhtrang-phieu="hanldeTinhTrangPhieuChange"
        @get-danh-sach-bao-hong="hanldeGetListBaoHong"
    />
  </div>


  <ejs-dialog :enableResize="true" :visible="false" ref="dlg_chonsongay" :header='"Nhập thông tin"'
    showCloseIcon="false" target=".main-wrapper" width="50%" height="200">
  </ejs-dialog>

  <ppGuiSMSTienTrinhBH ref="dlg_GuiSmsTienTrinh" :nhom_id="2" :baohong_id="tienTrinhSelected.baohong_id" 
    :tientrinhbh_id="tienTrinhSelected.tientrinhbh_id" :ma_tb="txtMaTB" :noidung="tienTrinhSelected.noidung" 
    idModal="popupGuiSMSTienTrinhBH"
  />

  <ejs-dialog :enableResize="true" :visible="false" ref="dlg_trogiup"
    :header='"Hướng dẫn sử dụng chức năng nghiệm thu báo hỏng"' showCloseIcon="false" target=".main-wrapper" width="60%"
    height="700">
    <div class="modal-content popup-box">
      <div id="includedContent"></div>
    </div>
  </ejs-dialog>
  <PopUpDownloadFile ref="popupDownloadFildeHS" idModal="popupDownloadFileHSId"  />
  <ppCapNhatTienTrinh  ref="popupUpdateTienTrinh" idModal="popupUpdateTientrinhId" @save-tientrinh-success-event="handleSaveTienTrinhSuccess"/>
  <CreateIssue ref="frmCreateIssue"></CreateIssue>
</div>


