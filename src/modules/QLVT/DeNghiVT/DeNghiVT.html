<div class="">
    <div class="list-actions-top d-flex justify-content-start align-items-center">
        <ul class="list" style="overflow: visible !important; z-index: 99999;" >
            <li @click="btnTimKiem_Click">
                <a>
                    <span class="icon one-file-attach"></span> Lấy TT 
                </a>              
            </li>
            <li @click="tsbtnNhapMoi_Click" v-if="Visible.tsbtnNhapMoi" :class="{'disabled': !Enabled.tsbtnNhapMoi}">    
                <a>
                    <span class="icon nc-icon-glyph ui-1_circle-add"></span> Nhập mới 
                </a>                   
            </li>
            <li @click="tsbtnGhiLai_Click" v-if="Visible.tsbtnGhiLai" :class="{'disabled': !Enabled.tsbtnGhiLai}">    
                <a>
                    <span class="icon one-save"></span>Ghi lại 
                </a>             
            </li>           
            <li @click="tsbtnTraLai_Click" v-if="Visible.tsbtnTraLai">  
                <a>
                    <span class="icon one-save"></span>Trả phiếu
                </a>                
            </li>
            <li @click="tsbtnHuyBo_Click" v-if="Visible.tsbtnHuyBo" :class="{'disabled': !Enabled.tsbtnHuyBo}">     
                <a>
                    <span class="icon  nc-icon-glyph ui-1_circle-remove"></span> Hủy
                </a>           
            </li>
            <li @click="tsbtnXoa_Click" v-if="Visible.tsbtnXoa" :class="{'disabled': !Enabled.tsbtnXoa}">    
                <a>
                    <span class="icon  one-trash"></span> Xóa
                </a>             
            </li>
            <!-- <li @click="tstbtnDonHang_Click" v-if="Visible.tstbtnDonHang" :class="{'disabled': !Enabled.tstbtnDonHang}">
                <a>
                    <span class="icon  one-file-edit2"></span> Đơn hàng  
                </a>   
            </li> -->
            <li @click="tsbtnGiaoPhieu_Click">
                <a>
                    <span class="icon  one-file-edit2"></span> Giao phiếu 
                </a>
            </li>

            <li @click="tsbtnThemVT_Click" v-if="Visible.tsbtnThemVT" :class="{'disabled': !Enabled.tsbtnThemVT}">
                <a >
                    <span class="icon  nc-icon-glyph business_coins"></span> Chọn VT 
                </a>                
            </li>
            <!-- <li @click="tsbtnDongBo_Click" v-if="Visible.tsbtnDongBo" :class="{'disabled': !Enabled.tsbtnDongBo}">
                <a >
                    <span class="icon  one-sync1"></span> Đồng bộ KT
                </a>                 
            </li> -->
            <li  @click="tsbtnCopyCT_Click" v-if="Visible.tsbtnCopyCT" :class="{'disabled': !Enabled.tsbtnCopyCT}">
                <a>
                    <span class="icon  one-print"></span> Copy CT 
                </a>                   
            </li>
            <!-- <li  @click="tsbtnHoanThanh_Click" v-if="Visible.tsbtnHoanThanh" :class="{'disabled': !Enabled.tsbtnHoanThanh}">
                <a>
                    <span class="dropdown-icon one-file-check"></span> Hoàn thành 
                </a>                
            </li> -->
            
            <li  class="dropdown">                
                <a data-toggle="dropdown" >
                    <span class="icon one-print"></span>In phiếu
                    <span class="arrow fa fa-angle-down"></span>                   
                </a>
                          
                <ul class="dropdown-menu" style="color: #0176FF;">
                    <li @click="tsbtnPhieuNhap_Click" :class="{'disabled': !Enabled.tsbtnPhieuNhap}">
                        <a>  
                            <span class="dropdown-icon one-print"></span> Phiếu nhập
                        </a>
                    </li>
                    <li  @click="tsbtnPhieuXuat_Click" :class="{'disabled': !Enabled.tsbtnPhieuXuat}">
                        <a >
                            <span class="dropdown-icon one-print"></span> Phiếu xuất
                        </a>
                    </li>
                    <li  @click="tsbtnPhieuChuyen_Click" :class="{'disabled': !Enabled.tsbtnPhieuChuyen}">
                        <a >
                            <span class="dropdown-icon one-print"></span> Phiếu chuyển
                        </a>
                    </li>
                    <li @click="tsbtnChiTietSR_Click">
                        <a >
                            <span class="dropdown-icon one-print"></span> Chi tiết SR
                        </a>
                    </li>
                    <li @click="tstPhieuTUVT_Click" :class="{'disabled': !Enabled.tstPhieuTUVT}">
                        <a >
                            <span class="dropdown-icon one-print"></span> Phiếu tạm ứng VT
                        </a>
                    </li>                   
                </ul>
            </li>
            <ejs-dialog
                :visible='false'
                ref="popup_frmGanSeri"
                :animationSettings='animationSettings'
                :showCloseIcon=false 
                :enableResize=true
                :allowDragging=true
                width='80%'
                height ="100%"
                :isModal='true'
                :cssClass="'popup-box'"
                :zIndex='900'
                >
                <frmGanSeri ref="frmGanSeri" class=""></frmGanSeri>
            </ejs-dialog>
            <ejs-dialog
                :visible='false'
                ref="popup_frmChungTu_TBao"
                :animationSettings='animationSettings'
                :showCloseIcon=false 
                :enableResize=true
                :allowDragging=true
                width='80%'
                height ="100%"
                :isModal='true'
                :cssClass="'popup-box'"
                >
                <frmChungTu_TBao ref="frmChungTu_TBao" class=""></frmChungTu_TBao>
            </ejs-dialog>
            <ejs-dialog
                :visible='false'
                ref="popup_frmTaoSerial"
                :animationSettings='animationSettings'
                :showCloseIcon=false 
                :enableResize=true
                :allowDragging=true
                width='80%'
                height ="100%"
                :isModal='true'
                :cssClass="'popup-box'"
                >
                <frmTaoSerial ref="frmTaoSerial" class=""></frmTaoSerial>
            </ejs-dialog>
            <DSVatTu ref="frmDSVatTu"></DSVatTu>
           
            <ejs-dialog
                :visible='false'
                ref="popup_frmDonHangTT"
                :animationSettings='animationSettings'
                :showCloseIcon=true 
                :enableResize=true
                :allowDragging=true
                width='80%'
                height ="100%"
                :isModal='true'
                :close='XacNhan_frmDonHangTT'
                :closeOnEscape='true'
                >
                <TraCuuDonHangConHan ref="frmDonHangTT" class=""></TraCuuDonHangConHan>
            </ejs-dialog>
            
            <frmVatTuTrongKho  ref='frmVatTuTrongKho'/>
            <ejs-dialog
                :visible='false'
                ref="popup_frmNhapText"
                :animationSettings="{ effect: 'Zoom' }"
                :showCloseIcon=false 
                :closeOnEscape='true'
                :enableResize='true'
                :allowDragging='true'
                width='30%'
                :isModal='true'
                :cssClass="'popup-box'"
                >
                <frmNhapText ref="frmNhapText"></frmNhapText>
            </ejs-dialog>
            
            <frmNhapCap ref="frmNhapCap"></frmNhapCap>
            <frmGanSeri_Tbi ref="GanSeri_Tbi"></frmGanSeri_Tbi>
            
            <li  class="dropdown">                
                <a data-toggle="dropdown">
                    <span class="icon one-seri"></span>Serial
                    <span class="arrow fa fa-angle-down"></span>                          
                </a>
                          
                <ul class="dropdown-menu" style="color: #0176FF;">
                    <li @click="tsbtnSinhSr_Click" v-if="Visible.tsbtnSinhSr" :class="{'disabled': !Enabled.tsbtnSinhSr}" >
                        <a>  
                            <span class="dropdown-icon one-seri" ></span> Tạo serial
                        </a>
                    </li>
                    <li  @click="toolStripMenuItem3_Click" v-if="Visible.tsbtnSinhSr" :class="{'disabled': !Enabled.tsbtnSinhSr}">
                        <a >
                            <span class="dropdown-icon one-print"></span> In serial
                        </a>
                    </li>                
                </ul>
            </li>
        </ul>        
        
        <div class="more dropdown">
            <a href="#" data-toggle="dropdown">
                <span class="icon -ap  icon-dots-three-vertical"></span>
            </a>
            <ul class="dropdown-menu">
                <li>
                    <a @click="tsbtnSMS_Click">
                        <span class="dropdown-icon one-email"></span> Gửi SMS
                    </a>
                </li>
            </ul>
        </div>
    </div>
    <div class="page-content">
        <div class="row">
            <div class="grid-stack-box">
                <div class="box-col box-form" id="boxLeft">
                    <div class="legend-title">Thông tin chứng từ</div>
                    <div class="row">
                        <div class="col-sm-6 col-12">
                            <div class="info-row">
                                <div class="key w100">Số phiếu</div>
                                <div class="value">
                                    <input ref="txtSoPhieu" type="text" class="form-control" v-model="params.p_txtSoPhieu" readonly>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6 col-12">
                            <div class="check-action mart7">
                                <input type="checkbox" class="check" v-model="params.p_ckbSendSMS">
                                <span class="name">Send SMS tự động</span>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-6 col-12">
                            <div class="info-row">
                                <div class="key w100">Loại chứng từ <span style="color: red;">*</span></div>
                                <div class="value">
                                    <div class="select-custom">                                       
                                        <ejs-dropdownlist
                                            class="form-control"
                                            ref="cboLoaiChungTu"
                                            locale='vi'
                                            v-model="params.p_LoaiChungTu"
                                            :dataSource='cboLoaiChungTu' 
                                            :fields="{value:'loaiCtId', text: 'loaiCt'}"
                                            :allowFiltering="true"
                                            @change='cboLoaiChungTu_EditValueChanged'
                                            >
                                        </ejs-dropdownlist>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6 col-12">
                            <div class="info-row">
                                <div class="key w100">Ngày yêu cầu <span style="color: red;">*</span></div>
                                <div class="value">
                                    <div class="input-icon-right">                                        
                                        <ejs-datepicker 
                                            locale='vi'
                                            v-model="params.p_dtpNgayDK"
                                            :format="'dd/MM/y hh:mm'">
                                        </ejs-datepicker>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key w100">Mục đích <span style="color: red;">*</span></div>
                        <div class="value">
                            <div class="select-custom">                                
                                <ejs-dropdownlist
                                    class="form-control"
                                    ref="cboMucDich"
                                    locale='vi'
                                    v-model="params.p_MucDich"
                                    :dataSource='cboMucDich' 
                                    :fields="{value:'mucDichId', text: 'mucDich'}"
                                    :allowFiltering="true"
                                    >
                                </ejs-dropdownlist>
                            </div>
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key w100">
                            <div class="check-action">
                                <input type="checkbox" class="check" v-model="params.p_ckbTuKho" @change='ckbTuKho_CheckedChanged'>
                                <span class="name">Từ kho <span style="color: red;">*</span></span>
                            </div>
                        </div>
                        <div class="value">
                            <div class="input-more-button -right">
                                <button class="btn" @click='cboTuKho_ButtonClick'>
                                    <span class="-ap icon-more_horiz"></span>
                                </button>
                                <div class="select-custom">                                  
                                    <ejs-dropdownlist
                                        class="form-control"
                                        ref="cboTuKho"
                                        locale='vi'
                                        v-model="params.p_TuKho"
                                        :dataSource='cboTuKho' 
                                        :fields="{value:'khoId', text: 'tenKho'}"
                                        :allowFiltering="true"
                                        @change="cboTuKho_EditValueChanged"
                                        :readonly="ReadOnly.cboTuKho"
                                        :filtering='onFilteringTuKho'
                                        >
                                    </ejs-dropdownlist>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key w100">
                            <div class="check-action">
                                <input type="checkbox" class="check" v-model="params.p_ckbDenKho" @change='ckbDenKho_CheckedChanged'>
                                <span class="name">Đến kho <span style="color: red;">*</span></span>
                            </div>
                        </div>
                        <div class="value">
                            <div class="select-custom">                               
                                <ejs-dropdownlist
                                    class="form-control"
                                    ref="cboDenKho"
                                    locale='vi'
                                    v-model="params.p_DenKho"
                                    :dataSource='cboDenKho' 
                                    :fields="{value:'khoId', text: 'tenKho'}"
                                    :allowFiltering="true"
                                    @change='cboDenKho_EditValueChanged'
                                    :readonly="ReadOnly.cboDenKho"
                                    :filtering='onFilteringDenKho'
                                    >
                                </ejs-dropdownlist>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-6 col-12">
                            <div class="info-row">
                                <div class="key w100">Ngày xuất</div>
                                <div class="value">
                                    <div class="input-more-button -right">
                                        <button class="btn" @click="dtpNgayGuiTT_ButtonClick">
                                            <span class="one-save"></span>
                                        </button>
                                        <div class="input-icon-right">                                            
                                            <ejs-datepicker 
                                                locale='vi'
                                                v-model="params.p_dtpNgayGuiTT"
                                                :format="'dd/MM/y HH:mm:ss'">
                                            </ejs-datepicker>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6 col-12">
                            <div class="info-row">
                                <div class="key w90">Ngày nhận</div>
                                <div class="value">
                                    <div class="input-more-button -right" @click="dtpNgayNhanTT_ButtonClick">
                                        <button class="btn">
                                            <span class="one-save"></span>
                                        </button>
                                        <div class="input-icon-right">                                            
                                            <ejs-datepicker 
                                                locale='vi'
                                                v-model="params.p_dtpNgayNhanTT"
                                                :format="'dd/MM/y HH:mm:ss'">
                                            </ejs-datepicker>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key w100">
                            Công trình
                        </div>
                        <div class="value">
                            <div class="select-custom">                                
                                <ejs-dropdownlist
                                    class="form-control"
                                    locale='vi'
                                    v-model="params.p_CongTrinh"
                                    :dataSource='cboCongTrinh' 
                                    :fields="{value:'congTrinhId', text: 'tenCt'}"
                                    :allowFiltering="true"
                                    >
                                </ejs-dropdownlist>
                            </div>
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key w100">
                            Nội dung
                        </div>
                        <div class="value">
                            <textarea ref="txtNoiDung" class="form-control" style="height: 120px;" v-model="params.p_txtNoiDung"></textarea>
                        </div>
                    </div>
                </div>
            <div class="box-col box-form" id="boxRight" style="width: 65%">
                    <div class="legend-title">
                        <div class="pull-left">Danh sách các phiếu chứng từ</div>
                        <div class="pull-right">
                            <a @click="vbtnRefresh_MouseClick" class="link">
                                <span class="one-reload1 f20"></span>
                            </a>
                        </div>
                        <div class="clearfix"></div>
                    </div>
                    <div class="row">
                        <div class="col-sm-3 col-12">
                            <div class="info-row">
                                <div class="key w120">Ngày yêu cầu từ <span style="color: red;">*</span></div>
                                <div class="value">
                                    <div class="input-icon-right">                                       
                                        <ejs-datepicker 
                                            locale='vi'
                                            v-model="params.p_dtpTuNgay"
                                            :format="'dd/MM/y'">
                                        </ejs-datepicker>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-3 col-12">
                            <div class="info-row">
                                <div class="key w70">Đến ngày <span style="color: red;">*</span></div>
                                <div class="value">
                                    <div class="input-icon-right">                                      
                                        <ejs-datepicker 
                                            locale='vi'
                                            v-model="params.p_dtpDenNgay"
                                            :format="'dd/MM/y'">
                                        </ejs-datepicker>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-4 col-12">
                            <div class="list-checks mart7">
                                <div class="item">
                                    <div class="check-action">
                                        <input type="checkbox" class="check" v-model="params.p_chkAll_Phieu">
                                        <span class="name">Xem tất cả các phiếu</span>
                                    </div>
                                </div>
                                <div class="item">
                                    <div class="check-action">
                                        <input type="checkbox" class="check" v-model="params.p_ckb_nd">
                                        <span class="name">Lọc theo người dùng</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-2 col-12">
                            <div class="info-row">
                                <div class="value padl0">
                                    <div class="input-more-button -right">
                                        <button class="btn" >
                                            <span class="one-search"></span>
                                        </button>
                                        <div class="select-custom">                                            
                                            <div class="vattu_box">
                                                <div class="input-group">
                                                  <div class="li input-text">
                                                    <div class="select-custom">
                                                      <input type="select" v-model="selectedLocVT" class="form-control" readonly @click="showLocVT = !showLocVT" style="background-color: white;">
                                                      </input>
                                                    </div>
                                                  </div>
                                                </div>
                                                <div class="vattu_table" v-if="showLocVT">
                                                  <DataGrid2 v-bind:columns="[
                                                  {fieldName: 'maVatTu', headerText: 'Mã vật tư', allowFiltering: true, allowSorting: false, width: '30%'},
                                                  {fieldName: 'tenVatTu', headerText: 'Tên vật tư', allowFiltering: true, allowSorting: false, width: '70%'}
                                                  ]" v-bind:dataSource="cboLocVattu" :showFilter="true"
                                                    @selectedRowChanged="cboLocVattu_selected" :showColumnCheckbox="true"
                                                    dataKeyField="vatTuID"
                                                    :defaultColumnCheckboxChecked="false"
                                                    ref="TableLocVT">
                                                  </DataGrid2>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                                    
                        
                    <DataGrid
                        v-bind:columns="[
                        {fieldName: '', headerText: '',  template: iconStatus, cssClass: 'text-center', width: '70', allowFiltering: false,allowSorting: false,},   
                        {fieldName: 'SOPHIEU', headerText: 'Số phiếu',textAlign: 'Left', allowFiltering: true, allowSorting: false},
                        {fieldName: 'LOAI_CT' , headerText: 'Loại chứng từ' ,textAlign: 'Left', allowFiltering: true, allowSorting: true },
                        {fieldName: 'TRANGTHAI' , headerText: 'Trạng thái' ,textAlign: 'Left', allowFiltering: true, allowSorting: true },
                        {fieldName: 'NGAY_CT' , headerText: 'Ngày yêu cầu' ,textAlign: 'Right', allowFiltering: true, allowSorting: true },
                        {fieldName: 'TIEN' , headerText: 'Tiền' ,textAlign: 'Right', format: 'n3', type: 'number', allowFiltering: true, allowSorting: true },
                        {fieldName: 'KHO_GIAO' , headerText: 'Từ kho' ,textAlign: 'Left', allowFiltering: true, allowSorting: true },
                        {fieldName: 'KHO_NHAN' , headerText: 'Đến kho' ,textAlign: 'Left', allowFiltering: true, allowSorting: true },
                        {fieldName: 'MUCDICH' , headerText: 'Mục đích' ,textAlign: 'Left', allowFiltering: true, allowSorting: true },
                        {fieldName: 'ND_GIAO' , headerText: 'Nội dung' ,textAlign: 'Left', allowFiltering: true, allowSorting: true },
                        {fieldName: 'NGUOI_CN' , headerText: 'Người lập' ,textAlign: 'Left', allowFiltering: true, allowSorting: true },
                        {fieldName: 'NGUOI_XN' , headerText: 'Người XN' ,textAlign: 'Left', allowFiltering: true, allowSorting: true },
                        {fieldName: 'NGUOI_HT' , headerText: 'Người HT' ,textAlign: 'Left', allowFiltering: true, allowSorting: true },
                        {fieldName: 'DSTB' , headerText: 'DS TB' ,textAlign: 'Left', allowFiltering: true, allowSorting: true,  template: btnTBTemplate,width: '80' },
                        {fieldName: 'CHUNGTU_ID', headerText:'', visible:false, isPrimaryKey:true} 
                        ]"
                        v-bind:dataSource="gridChungTu"
                        :showFilter="true"
                        :enablePagingServer="false"
                        :allowPaging="true"
                        dataKeyField="CHUNGTU_ID"
                        :allowExcelExport="true"
                        :totalRecords="gridChungTuPage.totalElement"
                        :pageSize="gridChungTuPage.maxSize"
                        :pageIndex="gridChungTuPage.page"
                        @selectedRowChanged="gridviewChungTu_FocusedRowChanged_sender"
                        @pageChanged="gridChungTuPageHandler"
                        :showColumnCheckbox='true'
                        ref="gridviewChungTu"
                        :selectionSettings="{enableToggle: false, type: 'Single', checkboxMode: 'ResetOnRowClick'}"
                        >
                    </DataGrid>   
                </div>
            </div>
        </div>
        <div class="box-form">
            <div class="legend-title">Danh sách vật tư</div>
            <div class="box-move-select-table">
                <div class="box-col"  :style="{width: isTab1 && Visible.ThongTinHDDA ? `calc(75% - 50px)` : `100%`}">
                    <div class="nav tabs tab-over">
                        <a href="#tab1" data-toggle="tab" class="active" @click="isTab1 = true" >Nội dung</a>
                        <a href="#tab2" data-toggle="tab"  @click="isTab1 = false">Danh sách thiết bị</a>
                        <a href="#tab3" data-toggle="tab" @click="isTab1 = false" v-if="Visible.xtraTabPage3">Nhập tình trạng VT</a>
                    </div>
                    <div class="tab-content">
                        <div class="tab-pane active" id="tab1">
                            <div class="top marb5">
                                <div class="row">
                                    <div class="col-sm-8 col-12">
                                        <div class="group-buttons mart0">
                                            <button class="btn btn-second padt3 padb3" @click="btnXuatExcelVT_Click">
                                                <span class="one-xlsx-import f20 normal inline vcenter lh14 marr5"></span> Xuất excel
                                            </button>
                                            <button class="btn btn-second padt3 padb3" @click="btnTaoTbi_Click">
                                                <span class="nc-icon-glyph ui-2_square-add-11 f16 normal inline vcenter lh14 marr5"></span>Tạo thiết bị
                                            </button>
                                            <button class="btn btn-second padt3 padb3" @click="btnChonTamUng_Click" v-if="Visible.layoutbtnTBi">
                                                <span class="one-file-attach1 f20 normal inline vcenter lh14 marr5"></span> Chọn thiết bị
                                                <frmChonThietBiCT  ref="frmChonTBi_CT" @closed="XacNhan_frmChonTBi_CT"></frmChonThietBiCT>
                                            </button>
                                            <button class="btn btn-second padt3 padb3" @click="btnChuyenTT_Click" v-if="Visible.layoutControlItem29">
                                                <span class="one-file-check f20 normal inline vcenter lh14 marr5"></span> Chuyển TT đầu vào
                                            </button>
                                        </div>
                                    </div>
                                    <div class="col-sm-4 col-12">
                                        <div class="info-row">
                                            <div class="value w30 nowrap tright">
                                                                                                
                                                <button class="btn btn-second padt3 padb3" @click="btnXoaHetVT_Click">
                                                    <span class="nc-icon-glyph ui-1_simple-remove"></span> Xóa hết
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>                            
                            <DataGrid3
                                v-bind:columns="[
                                { allowEditing: false  , fieldName: 'btnXoaVT', headerText: 'Xóa', textAlign: 'Left', allowFiltering: true, template:XoaVTTemplate, width: '80', freeze: 'Left'},
                                { allowEditing: false  , fieldName: 'ISCHECK', headerText: '', type: 'checkbox', headerText:'Center', textAlign: 'Center', allowFiltering: true, width: '60', freeze: 'Left'},

                                { allowEditing: false  , fieldName: 'LOHANG', headerText: 'Lô hàng', textAlign: 'Left', allowFiltering: true},
                                { allowEditing: false  , fieldName: 'MA_VT', headerText: 'Mã vật tư', textAlign: 'Left', allowFiltering: true},
                                { allowEditing: false  , fieldName: 'TEN_VT', headerText: 'Tên vật tư', textAlign: 'Left', allowFiltering: true},
                                { allowEditing: false  , fieldName: 'DVI_TINH', headerText: 'ĐVT', textAlign: 'Left', allowFiltering: true},
                                { allowEditing: true , fieldName: 'SOLUONG', headerText: 'Số lượng', textAlign: 'Right', format: 'n3', type: 'number', allowFiltering: true},
                                { allowEditing: false  , fieldName: 'DONGIA', headerText: 'Đơn giá', textAlign: 'Right', format: 'n3', type: 'number', allowFiltering: true},
                                { allowEditing: true , fieldName: 'TIEN', headerText: 'Thành tiền', textAlign: 'Right', format: 'n3', type: 'number', allowFiltering: true},
                                { allowEditing: true , fieldName: 'SOTHANG_PB', headerText: 'Số tháng PB', textAlign: 'Right', allowFiltering: true},
                                { allowEditing: false  , fieldName: 'LOAI_TBI', headerText: 'Loại thiết bị', textAlign: 'Left', allowFiltering: true},
                                { allowEditing: false  , fieldName: 'Trạng thái', headerText: 'Trạng thái', textAlign: 'Left', allowFiltering: true},
                                { allowEditing: false  , fieldName: 'HAN_BH', headerText: 'Hạn BH', textAlign: 'Left', allowFiltering: true},
                                { allowEditing: false  , fieldName: 'MA_HD', headerText: 'Mã HĐ', textAlign: 'Left', allowFiltering: true},
                                { allowEditing: false  , fieldName: 'MA_TH', headerText: 'Đợt TH', textAlign: 'Left', allowFiltering: true},
                                { allowEditing: false  , fieldName: 'DUAN' , headerText: 'Dự án', textAlign: 'Left', allowFiltering: true},
                                { allowEditing: false  , fieldName: 'GHICHU_HD', headerText: 'Ghi chú HĐ', textAlign: 'Left', allowFiltering: true},

                                { allowEditing: false  , fieldName: 'TachCap', headerText: 'Cuộn cáp', textAlign: 'Left', allowFiltering: true, template: btnEdit_Template, width: '80', freeze: 'Right'},
                                { allowEditing: false  , fieldName: 'CTCT_ID', headerText: '',isPrimaryKey:true, textAlign: 'Left', allowFiltering: true, visible: false},
                                 
                                ]"
                                v-bind:dataSource="gridVatTu"
                                ref="gridViewVatTu"
                                :showColumnCheckbox='false'
                                :showFilter="true"
                                :editSettings="{ allowEditing: true , mode:'Batch'}"
                                :allowPaging="true"
                                :enablePagingServer='false'
                                :totalRecords="gridVatTuPage.totalElement"
                                :pageSize="gridVatTuPage.maxSize"
                                :pageIndex="gridVatTuPage.page"
                                @pageChanged="gridVatTuPageHandler"    
                                @rowSelected="selected_gridVatTuRow"  
                                :aggregates="PTAggregatesColumns" 
                                :enabledSelectFirstRow="false" 
                                >
                            </DataGrid3>
                           
                        </div>
                        <div class="tab-pane" id="tab2">
                            <div class="form-group">
                                <div class="row">
                                    <div class="col-sm-5 col-12">
                                        <b-form-file id="fileUpload" v-model="arrayImportFile.filexcel" ref="fileUpload" @change="this.onChange" accept=".xls, .xlsx" class="-ap icon-more_horiz hidden" plain></b-form-file>
                                        <button class="btn btn-main" @click="btnExcelTbi_Click">
                                            <span class="icon one-xlsx1 f20 inline vcenter"></span>Nhập từ excel
                                        </button>
                                        <button class="btn btn-main" @click="txtExcelTbiMau_Click">
                                            <span class="icon one-excel f20 inline vcenter"></span>File excel mẫu
                                        </button>
                                        <button class="btn btn-main" @click="simpleButton2_Click">
                                            <span class="icon one-xlsx-import f20 inline vcenter"></span>Xuất excel
                                        </button>
                                        <button class="btn btn-main" @click="btnXuatTonTbi_Click">
                                            <span class="icon one-xlsx-import f20 inline vcenter"></span>Xuất excel Tbi tồn kho
                                        </button>
                                    </div>
                                    <div class="col-sm-3 col-12">
                                        <div class="info-row">
                                            <div class="value">
                                                <div class="select-custom">
                                                    
                                                    <div class="vattu_box">
                                                        <div class="input-group">
                                                          <div class="li input-text">
                                                            <div class="select-custom">
                                                              <input value="Lấy danh sách seri theo vật tư" :disabled="ReadOnly.CboVatTu" 
                                                                class="form-control" @click="showDSVatTu = !showDSVatTu">
                                                              </input>
                                                            </div>
                                                          </div>
                                                        </div>
                                                        <div class="vattu_table" v-if="showDSVatTu">
                                                            <div class="legend-title pl-3 d-flex justify-content-between">
                                                                <div class="d-flex justify-content-center align-items-center">Danh sách vật tư</div>
                                                                <button class="btn btn-main d-flex justify-content-center align-items-center mr-3"
                                                                @click="btnFilter_Click">
                                                                    <span class="icon fa fa-check" style="color: white;"></span>
                                                                    <span class="icon ">Lấy serial</span>
                                                                </button>                                                                
                                                            </div>
                                                          <DataGrid3 v-bind:columns="[
                                                          {fieldName: 'LOHANG', headerText: 'Lô hàng', allowFiltering: true, allowSorting: false,},
                                                          {fieldName: 'MA_VT', headerText: 'Mã vật tư', allowFiltering: true, allowSorting: false,},
                                                          {fieldName: 'TEN_VT', headerText: 'Tên vật tư', allowFiltering: true, allowSorting: false,}
                                                          ]" v-bind:dataSource="this.grcVT" :showFilter="true"
                                                            :showColumnCheckbox="true"
                                                            :allowPaging='false'
                                                            @selectedItemsChanged="grcVT_selectedRow" dataKeyField="VATTU_ID"
                                                            :defaultColumnCheckboxChecked="false"
                                                            ref="grvVT">
                                                          </DataGrid3>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-3 col-12">
                                        <div class="info-row">
                                            <div class="key w60">Serial</div>
                                            <div class="value">
                                                <input type="text" class="form-control" v-model="params.p_txtQuetSerial" @keyup.enter="txtQuetSerial_KeyPress">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-1 col-12">
                                        <button class="btn btn-main" @click="simpleButton1_Click">
                                            <span class="icon one-trash f20 inline vcenter"></span>Xoá hết
                                        </button>
                                    </div>
                                </div>
                                
                            </div>
                            <div class="table-content" style="overflow-x: hidden;">                            
                                <DataGrid3
                                    v-bind:columns="[
                                    { allowEditing: false  ,fieldName: 'LOHANG', headerText: 'Lô hàng', textAlign: 'Left', allowFiltering: true,},
                                    { allowEditing: false  ,fieldName: 'MA_VT', headerText: 'Mã vật tư', textAlign: 'Left', allowFiltering: true,},
                                    { allowEditing: false  ,fieldName: 'TEN_VT', headerText: 'Tên vật tư', textAlign: 'Left', allowFiltering: true,},
                                    { allowEditing: false  ,fieldName: 'MA_TBI', headerText: 'Mã thiết bị', textAlign: 'Left', allowFiltering: true,},
                                    { allowEditing: false  ,fieldName: 'MATHUNG', headerText: 'Mã thùng', textAlign: 'Left', allowFiltering: true, visible:Visible.colMaThung},
                                    { allowEditing: true ,fieldName: 'SERIAL', headerText: 'Serial', textAlign: 'Left', allowFiltering: true,},
                                    { allowEditing: false  ,fieldName: 'DVI_TINH', headerText: 'ĐVT', textAlign: 'Left', allowFiltering: true,},
                                    { allowEditing: true ,fieldName: 'SOLUONG', headerText: 'Số lượng', textAlign: 'Right', format: 'n3', type: 'number', allowFiltering: true,},
                                    { allowEditing: false  ,fieldName: 'DONGIA', headerText: 'Đơn giá', textAlign: 'Right', format: 'n3', type: 'number', allowFiltering: true,},
                                    { allowEditing: false  ,fieldName: 'TIEN', headerText: 'Thành tiền', textAlign: 'Right', format: 'n3', type: 'number', allowFiltering: true,},
                                    { allowEditing: true ,fieldName: 'GHICHU', headerText: 'Ghi chú', textAlign: 'Left', allowFiltering: true,},
                                    { allowEditing: false  ,fieldName: 'SERIAL_GP', headerText: 'Serial GP', textAlign: 'Left', allowFiltering: true,},
                                    { allowEditing: true ,fieldName: 'MATBI_GOC', headerText: 'Mã TB Gốc', textAlign: 'Left', allowFiltering: true,},
                                    { allowEditing: false  ,fieldName: 'MAC', headerText: 'MAC', textAlign: 'Left', allowFiltering: true,visible: Visible.colMac},
                                    { allowEditing: false  ,fieldName: 'btnXoatbI', headerText: 'Xóa', textAlign: 'Left', allowFiltering: true,template: XoatbITemplate, width: '70'},
                                    { allowEditing: false  ,fieldName: 'CTCT_ID', isPrimaryKey:true ,headerText: '', textAlign: 'Left', allowFiltering: true, visible: false},
                                    ]"
                                    v-bind:dataSource="gridThietBi"
                                    ref="gridViewThietBi"
                                    :showColumnCheckbox='false'
                                    :showFilter="true"
                                    :allowPaging="true"
                                    :enablePagingServer='true'
                                    :totalRecords="gridThietBiPage.totalElement"
                                    :pageSize="gridThietBiPage.maxSize"
                                    :pageIndex="gridThietBiPage.page"
                                    @pageChanged="gridThietBiPageHandler"
                                    :editSettings="{ allowEditing: true, mode:'Batch'}"
                                    :enabledSelectFirstRow="false" 
                                    >
                                </DataGrid3>

                            </div>
                        </div>
                        <div class="tab-pane" id="tab3" v-if="Visible.xtraTabPage3">
                            <div class="form-group">
                                <div class="row">
                                    <div class="info-row">
                                        <div class="key w80">
                                            <div class="check-action">
                                                <input type="checkbox" class="check">
                                                <span class="name">Tinh trạng VT</span>
                                            </div>
                                        </div>
                                        <div class="value">
                                            <div class="select-custom">
                                                <select name="" id="" class="form-control">
                                                    <option value=""></option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                            </div>
                            <DataGrid3
                                v-bind:columns="[
                                {fieldName: 'LOHANG', headerText: 'Lô hàng', textAlign: 'Left', allowFiltering: true,freeze: 'Left'},
                                {fieldName: 'MA_VT', headerText: 'Mã vật tư', textAlign: 'Left', allowFiltering: true},
                                {fieldName: 'TEN_VT', headerText: 'Tên vật tư', textAlign: 'Left', allowFiltering: true},
                                {fieldName: 'SERIAL', headerText: 'Serial', textAlign: 'Left', allowFiltering: true},
                                {fieldName: 'DVI_TINH', headerText: 'ĐVT', textAlign: 'Left', allowFiltering: true},
                                {fieldName: 'SOLUONG', headerText: 'Số lượng', textAlign: 'Right', format: 'n3', type: 'number', allowFiltering: true},
                                {fieldName: 'DONGIA', headerText: 'Đơn giá', textAlign: 'Right', format: 'n3', type: 'number',  allowFiltering: true},
                                {fieldName: 'TIEN', headerText: 'Thành tiền', textAlign: 'Right', format: 'n3', type: 'number', allowFiltering: true},
                                {fieldName: 'TINHTRANG', headerText: 'Tình trạng', textAlign: 'Left', allowFiltering: true},
                                ]"
                                v-bind:dataSource="gridTinhTrang"
                                :showFilter="true"
                                :allowPaging="true"
                                :allowExcelExport="true"
                                :totalRecords="gridTinhTrang.length"
                                :pageSize="gridTinhTrangPage.maxSize"
                                :pageIndex="gridTinhTrangPage.page"
                                @pageChanged="gridTinhTrangPageHandler"
                                :showColumnCheckbox='false'
                                :enabledSelectFirstRow="false" 
                                ref="gridviewTinhTrang"
                                >
                            </DataGrid3>
                        </div>
                    </div>
                </div>
                <div class="actions" v-if="isTab1 && Visible.ThongTinHDDA">
                    <button class="btn">
                        <span class="-ap icon-chevron-thin-right" @click='btnGo_Click'></span>
                    </button>
                    <button class="btn">
                        <span class="-ap icon-chevron-thin-left" @click="btnGan_Click"></span>
                    </button>
                </div>
                <div class="box-col box-form" v-if="isTab1 && Visible.ThongTinHDDA" :style="{width: isTab1 && Visible.ThongTinHDDA ? `35%` : ``}">
                    <div class="title-bg-main">
                        <div class="pull-left title">
                            Thông tin hợp đồng dự án
                        </div>
                        <div class="pull-right">
                            <a class="btn btn-main pad3 lh14" @click="btnRef_Click">
                                <span class="nc-icon-outline arrows-1_refresh-69"></span>
                            </a>
                            <a class="btn btn-main pad3 lh14" @click="btnDelete_VTDK_Click">
                                <span class="-ap icon-close"></span>
                            </a>
                        </div>
                        <div class="clearfix"></div>
                    </div>
                    <div class="info-row">
                        <div class="key w80">
                            Hợp đồng
                        </div>
                        <div class="value">
                            <div class="select-custom">                               
                                <div class="vattu_box">
                                    <div class="input-group">
                                      <div class="li input-text">
                                        <div class="select-custom">
                                          <input type="select" v-model="selectedHopDong" class="form-control" readonly @click="showHopDong = !showHopDong" style="background-color: white;">
                                          </input>
                                        </div>
                                      </div>
                                    </div>
                                    <div class="vattu_table" v-if="showHopDong">
                                        <DataGrid
                                        v-bind:columns="[
                                          {fieldName: 'maHd', headerText: 'Mã hợp đông', textAlign: 'Left', allowFiltering: true},
                                          {fieldName: 'noiDung', headerText: 'Nội dung', textAlign: 'Left', allowFiltering: true},
                                          {fieldName: 'ngayYc', headerText: 'Ngày yêu cầu', textAlign: 'Left', allowFiltering: true},
                                          ]"
                                        v-bind:dataSource="cboHopDong"
                                        :showFilter="true"
                                        :allowPaging="false"
                                        @selectedRowChanged="cboHopDong_selectedRow"
                                        ref="cboHopDong"
                                        >
                                      </DataGrid>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key w80">
                            <div class="check-action">
                                <input type="checkbox" class="check" v-model="params.p_ckbDuAn">
                                <span class="name">Dự án</span>
                            </div>
                        </div>
                        <div class="value">
                            <div class="select-custom">
                                <!-- <select name="" id="" class="form-control">
                                    <option value=""></option>
                                </select> -->
                                <ejs-dropdownlist
                                    class="form-control"
                                    ref="cboLoaiChungTu"
                                    locale='vi'
                                    v-model="params.p_DuAn"
                                    :dataSource='cbo_DuAn' 
                                    :fields="{value:'duAnId', text: 'maCt'}"
                                    :allowFiltering="true"
                                    >
                                </ejs-dropdownlist>
                            </div>
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key w80">
                            Ghi chú
                        </div>
                        <div class="value">
                            <textarea class="form-control" style="height: 200px;" v-model="params.p_txtGhiChuHD"></textarea>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
    </div>
    <b-modal 
        no-close-on-backdrop
        hide-footer 
        hide-header 
        hide-header-close 
        class="modal" 
        id="popupTenNguoiNhan">
        
            <div class="modal-content popup-box">
                <div class="popup-header">
                    <div class="title">Tên người nhận</div>
                    <div class="close -ap icon-close"  @click="$bvModal.hide('popupTenNguoiNhan')" data-dismiss="modal">
                    </div>
                </div>
                <div class="list-actions-top">
                    <ul class="list">
                        <li>
                            <a  @click="onClickXacNhanInPhieu()">
                                <span class="icon nc-icon-glyph ui-1_check-circle-08"></span> Xác nhận
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="popup-body">
                    <div class="info-row">
                        <div class="key w90">
                            Nhập tên người nhận
                        </div>
                        <div class="value">
                            <textarea class="form-control" v-model="tenNguoiNhan" value="tenNguoiNhan" style="height: 100px;resize: vertical;"></textarea>
                        </div>
                    </div>
                </div>
            </div>
        
    </b-modal>
    <!-- <frmGanSeri_Tbi ref="frmGanSeri_Tbi" class=""></frmGanSeri_Tbi> -->
    <frmGiaoPhieu ref="frmGiaoPhieu" /> 
</div>