<div>
    <div class="list-actions-top">
        <ul class="list">
            <li @click="onClickTimKiem">
                <a >
                    <span class="icon one-search"></span>Tìm kiếm
                </a>
            </li>
            <li @click="onClickInBaoCao" :class="{ disabledInput: params.baoCaoId == 7 }" >
                <a >
                    <span class="icon  one-print"></span> In báo cáo
                </a>
            </li>
            <li @click="onClickXuatExcel">
                <a >
                    <span class="icon  one-xlsx-import"></span> Xuất Excel
                </a>
            </li>
            <li @click="onClickHSDienTu">
                <a >
                    <span class="icon  one-file-search"></span> Xem hồ sơ điện tử
                </a>
            </li>
        </ul>
    </div>
    <div class="page-content">
        <div class="box-form">
            <div class="legend-title">
                <span :class="classSpanTieuChi" @click="hiddenBoxTieuChi"></span> Tiêu chí tìm kiếm
            </div>
            <div class="row" v-if="isBoxTieuChi">
                <div class="col-sm-4 col-12">
                    <div class="info-row">
                        <div class="key w80">
                            Nhân viên
                        </div>
                        <div class="value">
                            <div class="select-custom">
                                <ejs-dropdownlist
                                    class="form-control"                                   
                                    locale='vi'
                                    v-model="params.nhanVienId"
                                    :dataSource='dataResponse.DSNhanVien' 
                                    :fields="{value:'NHANVIEN_ID', text: 'TEN_NEW'}"
                                    :allowFiltering="true"                                        
                                    :filtering='onFilteringNhanVien'  
                                    @change="onChangeNhanVien"                                  
                                    >
                                </ejs-dropdownlist>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-sm-4 col-12">
                    <div class="info-row">
                        <div class="key w80">
                            Hình thức
                        </div>
                        <div class="value">
                            <div class="select-custom">
                                <ejs-dropdownlist
                                    class="form-control"                                   
                                    locale='vi'
                                    v-model="params.hinhThucId"
                                    :dataSource='DSHinhThuc' 
                                    :fields="{value:'NHOM_ID', text: 'TEN_NHOM'}"
                                    :allowFiltering="false"                                      
                                    @change="onChangeHinhThuc"                                  
                                    >
                                </ejs-dropdownlist>
                                
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-sm-4 col-12">
                    <div class="list-checks mart7">
                        <div class="item">
                            <div class="check-action">
                                <input type="radio"  name="tinhTrangGiao"  :checked="params.chuaGiao" @change="onChangeTinhTrangGiao">
                                <span class="name">Chưa giao</span>
                            </div>
                        </div>
                        <div class="item">
                            <div class="check-action">
                                <input type="radio"  name="tinhTrangGiao" :checked="!params.chuaGiao" @change="onChangeTinhTrangGiao">
                                <span class="name">Đã giao</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row" v-if="isBoxTieuChi">
                <div class="col-sm-4 col-12">
                    <div class="info-row">
                        <div class="key w80">
                            Kho
                        </div>
                        <div class="value">
                            <div class="select-custom">
                                <ejs-dropdownlist
                                    class="form-control"                                   
                                    locale='vi'
                                    v-model="params.khoId"
                                    :dataSource='dataResponse.DSKho' 
                                    :fields="{value:'KHO_ID', text: 'TEN_K_NEW'}"
                                    :allowFiltering="true"                                        
                                    :filtering='onFilteringKho'                                    
                                    >
                                </ejs-dropdownlist>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-sm-4 col-12">
                    <div class="info-row">
                        <div class="key w80">
                            Dịch vụ
                        </div>
                        <div class="value">
                            <div class="select-custom">
                                <ejs-dropdownlist
                                    class="form-control"                                   
                                    locale='vi'
                                    v-model="params.dichVuId"
                                    :dataSource='dataResponse.DSDichVu' 
                                    :fields="{value:'dichVuVTId', text: 'tenDVVT'}"
                                    :allowFiltering="true"                                        
                                    :filtering='onFilteringDichVu'  
                                    @change="onChangeDichVu"                                  
                                    >
                                </ejs-dropdownlist>
                               
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-sm-4 col-12">
                    <div class="info-row">
                        <div class="key w80">
                            Loại hình
                        </div>
                        <div class="value">
                            <div class="select-custom">
                                <ejs-dropdownlist
                                    class="form-control"                                   
                                    locale='vi'
                                    v-model="params.loaiHinhId"
                                    :dataSource='dataResponse.DSLoaiHinh' 
                                    :fields="{value:'loaiTBId', text: 'loaiHinhTB'}"
                                    :filtering='onFilteringLoaiHinh'                                                                   
                                    >
                                </ejs-dropdownlist>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row" v-if="isBoxTieuChi">
                <div class="col-sm-4 col-12">
                    <div class="info-row">
                        <div class="key w80">
                            Báo cáo
                        </div>
                        <div class="value">
                            <div class="select-custom">
                                <select name="" id="" class="form-control" @change="" 
                                    v-model="params.baoCaoId">
                                    <option v-for="baoCao in DSBaoCao" v-bind:value="baoCao.BAOCAO_ID">
                                        {{baoCao.TEN_BAOCAO}}</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-sm-4 col-12">
                    <div class="info-row">
                        <div class="key w80">
                            Từ ngày
                        </div>
                        <div class="value">
                            <div class="input-icon-right">
                                <ejs-datepicker class="form-control" 
                                    :format="dateConfig.formatDay" v-model="params.tuNgay">
                                </ejs-datepicker>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-sm-4 col-12">
                    <div class="info-row">
                        <div class="key w80">
                            Đến ngày
                        </div>
                        <div class="value">
                            <div class="input-icon-right">
                                <ejs-datepicker class="form-control" 
                                    :format="dateConfig.formatDay" v-model="params.denNgay">
                                </ejs-datepicker>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row" v-if="isBoxTieuChi">
                <div class="col-sm-2 col-12">
                    <div class="info-row">
                        <div class="key w80">
                            Lý do cấp
                        </div>
                        <div class="value">
                            <div class="select-custom">
                                <ejs-multiselect 
                                    ref="cboLyDoCap"
                                    locale='vi'
                                    placeholder="Chọn lý do cấp"
                                    v-model="params.lyDoCapId"                                     
                                    :showDropDownIcon='true' 
                                    :dataSource='dataResponse.DSLyDoCap' 
                                    :showSelectAll='true' 
                                    :mode="'CheckBox'"     
                                    :selectAllText="'Tất cả'"                                
                                    :fields='fieldsCheckBox.lyDoCap'
                                    :close='onClose'    
                                    :created='onDropdownCreate'
                                    >
                                </ejs-multiselect>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-sm-2 col-12">
                    <div class="info-row">
                        <div class="key w80">
                            Kiểu lắp đặt
                        </div>
                        <div class="value">
                            <div class="select-custom">

                                <ejs-dropdownlist
                                    ref="cboKieuLapDat"
                                    class="form-control"                                   
                                    locale='vi'
                                    v-model="params.kieuLapDatId"
                                    :dataSource='dataResponse.DSKieuLapDat' 
                                    :fields="{value:'kieuLdId', text: 'tenKieuLd'}"
                                    :allowFiltering="true"                                        
                                    :filtering='onFilteringKieuLapDat'                                    
                                    >
                                </ejs-dropdownlist>
                               
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-sm-4 col-12">
                    <div class="info-row">
                        <div class="key w80">
                            Trạng thái
                        </div>
                        <div class="value">
                            <div class="select-custom">
                                <ejs-multiselect 
                                    placeholder="Chọn trạng thái"
                                    locale='vi'
                                    v-model="params.trangThaiId"                                     
                                    :showDropDownIcon='true' 
                                    :dataSource='DSTrangThai' 
                                    :showSelectAll='false' 
                                    :mode="'CheckBox'"                                     
                                    :fields='fieldsCheckBox.trangThai'>
                                </ejs-multiselect>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-sm-4 col-12">
                    <div class="list-checks mart7">
                        <div class="item">
                            <div class="check-action">
                                <input type="radio"  name="theoNgay" :checked="params.theoNgayNT" @change="onChangeTheoNgay('NT')">
                                <span class="name">Theo ngày NT</span>
                            </div>
                        </div>
                        <div class="item">
                            <div class="check-action">
                                <input type="radio"  name="theoNgay" :checked="params.theoNgayCap" @change="onChangeTheoNgay('CAP')">
                                <span class="name">Theo ngày cấp</span>
                            </div>
                        </div>
                        <div class="item">
                            <div class="check-action">
                                <input type="radio" name="theoNgay" :checked="params.theoNgayGiao" @change="onChangeTheoNgay('GIAO')">
                                <span class="name">Theo ngày giao</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="box-form">
            <div class="legend-title">Danh sách thuê bao</div>
            <div class="table-content">
                <DataGrid v-if="params.isQuyetToan" ref="gridDSThueBao" class="table-result table-gachle" v-bind:columns="[
                    {fieldName: 'Loại', headerText: 'Loại', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Lý do cấp', headerText: 'Lý do cấp', allowFiltering: true, allowSorting: true}, 
                    {fieldName: 'Mục đích cấp', headerText: 'Mục đích cấp', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Kiểu lắp đặt', headerText: 'Kiểu lắp đặt', allowFiltering: true, allowSorting: true}, 
                    {fieldName: 'Loại dịch vụ', headerText: 'Loại dịch vụ', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Mã HĐ', headerText: 'Mã HĐ', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Số máy/Acc', headerText: 'Số máy/Acc', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Số ảo', headerText: 'Số ảo', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Tên thuê bao', headerText: 'Tên thuê bao', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Địa chỉ lắp đặt', headerText: 'Địa chỉ lắp đặt', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Mã vật tư', headerText: 'Mã vật tư', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Tên vật tư', headerText: 'Tên vật tư', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Serial', headerText: 'Serial', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Serial_GP', headerText: 'Serial GP', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Mã thiết bị', headerText: 'Mã thiết bị', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Số lượng', headerText: 'Số lượng', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Đơn vị tính', headerText: 'Đơn vị tính', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Đơn giá', headerText: 'Đơn giá', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Thành tiền', headerText: 'Thành tiền', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Mã kho', headerText: 'Mã kho', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Ngày cấp', headerText: 'Ngày cấp', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Ngày giao', headerText: 'Ngày giao', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Ngày nghiệm thu', headerText: 'Ngày nghiệm thu', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Tên cán bộ', headerText: 'Tên cán bộ', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Trạng thái', headerText: 'Trạng thái', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Tốc độ', headerText: 'Tốc độ', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Ghi chú', headerText: 'Ghi chú', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Nguyên nhân hỏng', headerText: 'Nguyên nhân hỏng', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Tình trạng hỏng', headerText: 'Tình trạng hỏng', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Mã khu vực', headerText: 'Mã khu vực', allowFiltering: true, allowSorting: true},
                    ]" 
                    v-bind:dataSource="dataResponse.DSThueBao" 
                    :showFilter="true" 
                    dataKeyField=""
                    @selectedRowChanged="DSThueBaoFocus" 
                    :showColumnCheckbox="false"
                    @selectedItemsChanged=""
                    :allowPaging="true"
                    :enablePagingServer="false"               
                    >
                </DataGrid>

                <DataGrid v-if="!params.isQuyetToan" ref="gridDSThueBaov2" class="table-result table-gachle" v-bind:columns="[
                    {fieldName: 'Loại', headerText: 'Loại', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Tổ', headerText: 'Lý do cấp', allowFiltering: true, allowSorting: true}, 
                    {fieldName: 'Số máy/Acc', headerText: 'Số máy/Acc', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Số ảo', headerText: 'Số ảo', allowFiltering: true, allowSorting: true}, 
                    {fieldName: 'Tên thuê bao', headerText: 'Tên thuê bao', allowFiltering: true, allowSorting: true},                    
                    {fieldName: 'Địa chỉ', headerText: 'Địa chỉ', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Serial', headerText: 'Serial', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Serial_GP', headerText: 'Serial GP', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Mã vật tư', headerText: 'Mã vật tư', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Lô hàng', headerText: 'Lô hàng', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Kho', headerText: 'Kho', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Ngày nghiệm thu', headerText: 'Ngày nghiệm thu', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Tình trạng thiết bị', headerText: 'Tình trạng thiết bị', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Loại dịch vụ', headerText: 'Loại dịch vụ', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Mã HĐ', headerText: 'Mã HĐ', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Cán bộ thu hồi', headerText: 'Cán bộ thu hồi', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Ngày thu hồi', headerText: 'Ngày thu hồi', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Ngày giao', headerText: 'Ngày giao', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Tên vật tư', headerText: 'Tên vật tư', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Lý do thu hồi', headerText: 'Lý do thu hồi', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Số lượng thu hồi', headerText: 'Số lượng thu hồi', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Loại HĐ', headerText: 'Loại HĐ', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Số phiếu', headerText: 'Số phiếu', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Tốc độ', headerText: 'Tốc độ', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Ghi chú', headerText: 'Ghi chú', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Nguyên nhân hỏng', headerText: 'Nguyên nhân hỏng', allowFiltering: true, allowSorting: true},
                    {fieldName: 'Tình trạng hỏng', headerText: 'Tình trạng hỏng', allowFiltering: true, allowSorting: true},  
                    {fieldName: 'Mã khu vực', headerText: 'Mã khu vực', allowFiltering: true, allowSorting: true},                  
                    ]" 
                    v-bind:dataSource="dataResponse.DSThueBao" 
                    :showFilter="true" 
                    dataKeyField=""
                    @selectedRowChanged="DSThueBaoFocus" 
                    :showColumnCheckbox="false"
                    @selectedItemsChanged=""
                    :allowPaging="true"
                    :enablePagingServer="false"                  
                    >
                </DataGrid>
            </div>
        </div>
    </div>
    <ejs-dialog
        :visible='false'
        ref="popupTraCuuHSDT"            
        showCloseIcon=true 
        :enableResize='true'
        :allowDragging='true'
        width='100%'
        height ="100%"
        :isModal='true'
        :cssClass="'popup-box'"
        >
        <SearchEProfile ref="frmTraCuuHSDT"></SearchEProfile>
    </ejs-dialog>
</div>