<div>
    <!-- <breadcrumb :header="header" /> -->
    <div class="list-actions-top">
        <ul class="list" style="overflow: visible !important; z-index: 99999;">
            <li @click="btnLayTT()">
                <a>
                    <span class="icon one-file-attach"></span>Lấy TT
                </a>
            </li>
            <li v-show="btnNhapMoi_Visible" @click="btnNhapMoi_Click()">
                <a v-if="btnNhapMoi_Enabled">
                    <span class="icon one-file-check"></span>Nhập mới
                </a>
                <a v-else class="disabledInput">
                    <span class="icon one-file-check"></span>Nhập mới
                </a>
            </li>
            <li v-show="statusBtnCapNhap" @click="btnCapNhat_Click()">
                <a>
                    <span class="icon one-save"></span>Cập nhật
                </a>
            </li>
            <li v-show="statusBtnHuy" @click="tsbtnHuyBo_Click()">
                <a>
                    <span class="icon nc-icon-glyph ui-1_circle-remove"></span>Hủy
                </a>
            </li>
            <li v-show="statusBtnTuDongCap" @click="tsbtnAutoCap_Click()">
                <a>
                    <span class="icon one-folder-sync"></span>Tự động cấp
                </a>
            </li>
            <!-- <li>
                <a>
                    <span class="icon one-print"></span>In biên bản <span class="fa fa-angle-down text-desc"></span>
                </a>
            </li> -->
            <li class="dropdown">
                <a data-toggle="dropdown" @click="isShowInBB = !isShowInBB">
                    <span class="icon one-print"></span>In biên bản
                    <span class="arrow fa fa-angle-down"></span>
                </a>

                <ul :class="['dropdown-menu', isShowInBB ? 'show' : '']" style="color: #0176FF;">
                    <li @click="inBBTWifiToolStripMenuItem_Click">
                        <a>
                            <span class="dropdown-icon one-print"></span> In BB nghiệm thu wifi
                        </a>
                    </li>
                    <li
                        @click="loaiNhomSelected == 1 ? inBBToolStripMenuItem_Click() : inBBToolStripMenuItem_Click_BH()">
                        <a>
                            <span class="dropdown-icon one-print"></span> In BB bàn giao
                        </a>
                    </li>
                </ul>
            </li>
            <li class="dropdown">
                <a data-toggle="dropdown" @click="isShowXuatExcel = !isShowXuatExcel">
                    <span class="icon icon one-xlsx-import"></span>Xuất Excel
                    <span class="arrow fa fa-angle-down"></span>
                </a>

                <ul :class="['dropdown-menu', isShowXuatExcel ? 'show' : '']" style="color: #0176FF;">
                    <li @click="exportExcelLSVT()">
                        <a>
                            <span class="dropdown-icon icon one-xlsx-import"></span> Excel VT
                        </a>
                    </li>
                    <li @click="exportExcelDSTB()">
                        <a>
                            <span class="dropdown-icon icon one-xlsx-import"></span> Excel DSTB
                        </a>
                    </li>
                </ul>
            </li>
            <li href="javascript:void(0)" @click="btnHoanCong_Click()">
                <a>
                    <span class="icon one-file-check"></span>Hoàn thành
                </a>
            </li>
            <li href="javascript:void(0)" @click="btnUpLoadHS()">
                <a>
                    <span class="icon one-upload"></span>Up hồ sơ
                </a>
            </li>
            <li @click="tsbtnXemHSDT_Click()">
                <a>
                    <span class="icon nc-icon-glyph files_search"></span>Xem hồ sơ điện tử
                </a>
            </li>
            <li href="javascript:void(0)" @click="showPort()">
                <a>
                    <span class="icon one-clipart-arrow-right"></span>Show port
                </a>
            </li>
            <li  @click="chuyenTo()">
                <a>
                    <span class="icon one-clipart-arrow-right"></span>Chuyển tổ
                </a>
            </li>
        </ul>
    </div>
    <div class="page-content">
        <div class="box-form">
            <div class="legend-title"><span class="icon fa fa-angle-up"></span>Các thông tin liên quan</div>
            <div class="row">
                <Split :gutterSize="20">
                    <SplitArea :size="50" :minSize="200">
                        <div class="box-col box-form">
                            <div class="title-bg-main padt4 padb4">
                                <div class="pull-left">
                                    <span class="title mart5">Thông tin tìm kiếm</span>
                                </div>
                                <div class="pull-right">
                                    <div class="info-row marb0">
                                        <div class="key w20 nowrap" v-if="statusCkbDaCap">
                                            <div class="check-action">
                                                <input type="checkbox" class="check" v-model="ckbDaCap">
                                                <span class="name">Đã cấp vật tư</span>
                                            </div>
                                        </div>
                                        <div class="key w20 nowrap pad5">
                                            <div class="check-action">
                                                <input type="checkbox" class="check" v-model="statusCkbTKTinhtrangVT"
                                                    :disabled="!ckbDaCap">
                                                <span class="name"></span>
                                            </div>
                                        </div>
                                        <div class="value">
                                            <div class="select-custom" v-if="statusCkbTKTinhtrangVT && ckbDaCap">
                                                <b-form-select v-model="tinhTrangVTTHSelected" class="form-control"
                                                    :options="listTinhTrangVTTH">
                                                </b-form-select>
                                            </div>
                                            <div class="select-custom disabledInput" v-else>
                                                <b-form-select v-model="tinhTrangVTTHSelected" class="form-control"
                                                    :options="listTinhTrangVTTH">
                                                </b-form-select>
                                            </div>
                                        </div>
                                        <div class="key w20 nowrap padl10">
                                            <div class="check-action">
                                                <input type="checkbox" class="check">
                                                <span class="name">Tìm chính xác phiếu</span>
                                            </div>
                                        </div>
                                        <div class="key w20 nowrap padl10">
                                            <div class="check-action">
                                                <input type="checkbox" class="check" v-model="ckbSerial">
                                                <span class="name">Tìm theo serial</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="clearfix"></div>
                            </div>
                            <div class="row">
                                <div class="col-sm-6 col-12">
                                    <div class="info-row">
                                        <div class="key w80">Loại nhóm</div>
                                        <div class="value">
                                            <div class="select-custom">
                                                <b-form-select v-model="loaiNhomSelected" class="form-control"
                                                    :options="listLoaiNhom">
                                                </b-form-select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-6 col-12">
                                    <div class="info-row">
                                        <div class="key w80">Loại HĐ/PL</div>
                                        <div class="value">
                                            <div class="select-custom">
                                                <b-form-select v-model="loaiHDSelected" class="form-control"
                                                    :options="listLoaiHDvaPL">
                                                </b-form-select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-6 col-12">
                                    <div class="info-row">
                                        <div class="key w80">Dịch vụ</div>
                                        <div class="value" v-click-outside="hideCbxDichVu">
                                            <div class="li input-text">
                                                <div class="select-custom">
                                                    <input @click="statusDichVu = !statusDichVu"
                                                        v-model="text_DichVuSelected" class="form-control"
                                                        :options="listDichVu">
                                                    </input>
                                                </div>
                                            </div>
                                            <div class="vattu_table">
                                                <DataGrid2 v-if="statusDichVu" v-bind:columns="[
                                                                    {fieldName: 'tenDVVT', headerText: 'Tên dịch vụ', allowFiltering: true, allowSorting: false}
                                                                    ]" v-bind:dataSource="listDichVu"
                                                    :showFilter="true"
                                                    @selectedRowChanged="gridDichVu_selectedRowChanged"
                                                    :showColumnCheckbox="false" dataKeyField="dichVuVTId">
                                                </DataGrid2>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-6 col-12">
                                    <div class="info-row">
                                        <div v-if="ckbSerial == false" class="key w80">Số máy/Acc</div>
                                        <div v-else class="key w80">Serial</div>
                                        <div class="value">
                                            <input type="text" class="form-control highlight" v-model="soMaySelected"
                                                @keyup.enter="txtSoThueBao_KeyDown">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-6 col-12">
                                    <div class="info-row">
                                        <div class="key w80">
                                            <div class="check-action">
                                                <input type="checkbox" class="check" v-model="showTuNgay">
                                                <span class="name">Từ ngày</span>
                                            </div>
                                        </div>
                                        <div class="value">
                                            <ejs-datepicker v-model="tuNgay" locale="vi" :allowEdit=false
                                                :enabled="showTuNgay" :showClearButton=false>
                                            </ejs-datepicker>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-6 col-12">
                                    <div class="info-row">
                                        <div class="key w80">Đến ngày</div>
                                        <div class="value">
                                            <ejs-datepicker v-model="denNgay" locale="vi" :allowEdit=false
                                                :enabled="showTuNgay" :showClearButton=false>
                                            </ejs-datepicker>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-6 col-12">
                                    <div class="info-row">
                                        <div class="key w80">Nhân viên</div>
                                        <div class="value" v-click-outside="hideCbxNhanVien">
                                            <div class="li input-text">
                                                <div class="select-custom">
                                                    <input @click="statusCbxNhanVien = !statusCbxNhanVien"
                                                        v-model="text_NhanVienSelected" class="form-control"
                                                        :options="listNhanVien">
                                                    </input>
                                                </div>
                                            </div>
                                            <div class="vattu_table">
                                                <DataGrid2 v-if="statusCbxNhanVien" v-bind:columns="[
                                                                    {fieldName: 'TEN_NEW', headerText: '', allowFiltering: true, allowSorting: false},
                                                                    {fieldName: 'TEN_DV', headerText: '', allowFiltering: true, allowSorting: false}
                                                                    ]" v-bind:dataSource="listNhanVien"
                                                    :showFilter="true"
                                                    @selectedRowChanged="gridNhanVien_selectedRowChanged"
                                                    :showColumnCheckbox="false" dataKeyField="NHANVIEN_ID">
                                                </DataGrid2>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-6 col-12">
                                    <div class="info-row">
                                        <div class="key w80">Kho</div>
                                        
                                         <div class="value" v-click-outside="hideCbxKho"> 
                                            <ejs-dropdownlist
                                                class="form-control"
                                                ref=""
                                                locale='vi'
                                                v-model="value_KhoSelected"
                                                :dataSource='listKho' 
                                                :fields="{value:'KHO_ID', text: 'TEN_K_NEW'}"
                                                :allowFiltering="true"  
                                                :filtering='onFilteringKho'    
                                                popupWidth="600px"                                      
                                                @change=""
                                                >
                                            </ejs-dropdownlist>  
                                            <!-- <div class="li input-text">
                                                <div class="select-custom">
                                                    <input @click="statusCbxKho = !statusCbxKho"
                                                        v-model="text_KhoSelected" class="form-control"
                                                        :options="listKho">
                                                    </input>
                                                </div>
                                            </div>
                                            <div class="vattu_table">
                                                
                                                <DataGrid v-if="statusCbxKho" v-bind:columns="[
                                                                {fieldName: 'TEN_K_NEW', headerText: 'Mã kho  - Tên kho', allowFiltering: true, allowSorting: false}
                                                                ]" v-bind:dataSource="listKho" :showFilter="true"
                                                    @selectedRowChanged="gridKho_selectedRowChanged"
                                                    :showColumnCheckbox="false" dataKeyField="KHO_ID">
                                                </DataGrid>
                                            </div> -->
                                        </div> 
                                    </div>
                                </div>
                            </div>
                            <div class="nav tabs tab-over">
                                <a href="#TTTB" data-toggle="tab" class="active">Thông tin thuê bao</a>
                                <a href="#DSGVNV" data-toggle="tab">Danh sách giao việc nhân viên</a>
                            </div>
                            <div class="tab-content">
                                <div class="tab-pane active" id="TTTB">
                                    <div class="info-row">
                                        <div class="key w100">Tên thuê bao</div>
                                        <div class="value">
                                            <input type="text" class="form-control highlight" v-model="dsTB.txtTenTB">
                                        </div>
                                    </div>
                                    <div class="info-row">
                                        <div class="key w100">Địa chỉ LĐ</div>
                                        <div class="value">
                                            <input type="text" class="form-control highlight"
                                                v-model="dsTB.txtDiaChiLD">
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-7 col-12">
                                            <div class="info-row">
                                                <div class="key w100">Kiểu LĐ</div>
                                                <div class="value">
                                                    <input type="text" class="form-control" v-model="dsTB.txtKieuLD">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-sm-5 col-12">
                                            <div class="info-row">
                                                <div class="key w100">Số ảo</div>
                                                <div class="value">
                                                    <input type="text" class="form-control" v-model="dsTB.txtSoAo">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="tab-pane" id="DSGVNV">
                                    <DataGrid v-bind:columns="[
                                        {fieldName: 'TEN_NV', headerText: 'Tên nhân viên', allowFiltering: true, allowSorting: false},
                                        {fieldName: 'SO_DT', headerText: 'Số điện thoại', allowFiltering: true, allowSorting: false},
                                        {fieldName: 'NHIEMVU', headerText: 'Nhiệm vụ', allowFiltering: true, allowSorting: false},
                                        {fieldName: 'GHICHU', headerText: 'Ghi chú', allowFiltering: true, allowSorting: false},
                                    ]" v-bind:dataSource="listNhanVienTheoPhieuID" :showFilter="false"
                                        :showColumnCheckbox="false" dataKeyField="NHANVIEN_GIAO_ID"
                                        :defaultColumnCheckboxChecked="false"
                                        @selectedRowChanged="DSNhanVien_selectedRowChanged" :enablePagingServer="false"
                                        :allowPaging="true" ref="DSNhanVien">
                                    </DataGrid>
                                </div>
                            </div>
                        </div>
                    </SplitArea>
                    <SplitArea :size="50" :minSize="200">
                        <div class="box-col box-form">
                            <div class="title-bg-main">
                                <span class="title">Thông tin cấp vật tư</span>
                            </div>
                            <div class="row">
                                <div class="col-sm-7 col-12">
                                    <div class="info-row">
                                        <div class="key w100">Kiểu Tbị</div>
                                        <div class="value">
                                            <div class="select-custom">
                                                <b-form-select v-model="kieuTBSelected" class="form-control"
                                                    :options="listKieuTB">
                                                </b-form-select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-5 col-12">
                                    <div class="info-row">
                                        <div class="key w100">Ngày thực hiện </div>
                                        <div class="value">
                                            <ejs-datetimepicker v-model="ngayTH" locale="vi" :allowEdit=true
                                                :showClearButton=false :format="'dd/MM/yyyy HH:mm'"
                                                @change="changeNgayTH">
                                            </ejs-datetimepicker>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-7 col-12">
                                    <div class="info-row">
                                        <div class="key w100">Kết quả thu hồi</div>
                                        <div class="value">
                                            <div class="select-custom">
                                                <b-form-select v-model="kqThuHoiSelected" class="form-control"
                                                    :options="ketQuaThuHoi">
                                                </b-form-select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-5 col-12">
                                    <div class="info-row">
                                        <div class="key w100">Lý do tồn</div>
                                        <div class="value">
                                            <div class="select-custom" v-if="statusLyDoTon">
                                                <b-form-select v-model="lyDoTonSelected" class="form-control"
                                                    :options="listLyDoTon">
                                                </b-form-select>
                                            </div>
                                            <div class="select-custom" v-else>
                                                <b-form-select v-model="lyDoTonSelected" class="form-control"
                                                    :options="listLyDoTon" disabled>
                                                </b-form-select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-7 col-12">
                                    <div class="info-row">
                                        <div class="key w100">Mục đích cấp</div>
                                        <div class="value">
                                            <div class="select-custom">
                                                <b-form-select v-model="mucDichCapSelected" class="form-control"
                                                    :options="listMucDichCap">
                                                </b-form-select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-5 col-12">
                                    <div class="info-row">
                                        <div class="key w100">Tình trạng T.bị</div>
                                        <div class="value">
                                            <div class="select-custom">
                                                <b-form-select v-model="tinhTrangTBCapSelected" class="form-control"
                                                    :options="listTinhTrangTBCap">
                                                </b-form-select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-7 col-12">
                                    <div class="info-row">
                                        <div class="key w100">Lý do cấp</div>
                                        <div class="value">
                                            <ComboboxGrid ref="cbx_LyDoCap" id="cbx_LyDoCap" data-key-field="mucDichId"
                                                :allow-paging="false" :columns="[
                                                {fieldName: 'nhomMd', headerText: '', allowFiltering: true, allowSorting: false, isGroupedColumn:true, width: '50px'},
                                                    {fieldName: 'mucDich', headerText: '', allowFiltering: true, allowSorting: false} 
                                                ]" :data-source="listLyDoCap" :show-filter="true" textField="mucDich" :allowPaging="true" :enablePagingServer="false"
                                                valueField="mucDichId" @selectedChanged="gridDSLyDoCap_selectedRowChanged">
                                            </ComboboxGrid>
                                        </div>
                                             
                                        <!-- <div class="value" v-click-outside="hideLyDoCap">
                                            <div class="select-custom">
                                                <div class="li input-text">
                                                    <div class="select-custom">
                                                        <input @click="statusLyDoCap = !statusLyDoCap"
                                                            v-model="lyDoCapSelected_text" class="form-control"
                                                            :options="listTenTb">
                                                        </input>
                                                    </div>
                                                </div>
                                                <div class="vattu_table" id="cbx_LyDoCap">
                                                    <DataGrid v-if="statusLyDoCap" v-bind:columns="[
                                                    {fieldName: 'nhomMd', headerText: '', allowFiltering: true, allowSorting: false, isGroupedColumn:true, width: '50px'},
                                                    {fieldName: 'mucDich', headerText: '', allowFiltering: true, allowSorting: false}                                        
                                                    ]" v-bind:dataSource="listLyDoCap" :showFilter="true"
                                                        @selectedRowChanged="gridDSLyDoCap_selectedRowChanged"
                                                        :showColumnCheckbox="false" dataKeyField="vatTuId"
                                                        :enablePagingServer="false" :allowPaging="false">
                                                    </DataGrid>
                                                </div>
                                            </div>
                                        </div> -->
                                    </div>
                                </div>
                                <div class="col-sm-5 col-12">
                                    <div class="info-row">
                                        <div class="key w100">Trang bị</div>
                                        <div class="value">
                                            <div class="select-custom">
                                                <b-form-select v-model="trangBiSelected" class="form-control"
                                                    :options="listTrangBi">
                                                </b-form-select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div v-if="params.pnlThuHoi">
                                <div class="title-bg-main mart10">
                                    <span class="title">Thông tin vật tư thu hồi</span>
                                </div>
                                <div class="row">
                                    <div class="col-sm-7 col-12">
                                        <div class="info-row">
                                            <div class="key w100">Tên thiết bị</div>
                                            <div class="value" v-click-outside="hideCbxTenTb">
                                                <div class="select-custom">
                                                    <div class="li input-text">
                                                        <div class="select-custom">
                                                            <input @click="statusTenTb = !statusTenTb"
                                                                v-model="text_tenTbSelected" class="form-control"
                                                                :options="listTenTb">
                                                            <!-- :readonly="readonlyTenTbSelected" -->
                                                            </input>
                                                        </div>
                                                    </div>
                                                    <div class="vattu_table">
                                                        <DataGrid2 v-if="statusTenTb" v-bind:columns="[
                                                                    {fieldName: 'tenVatTu', headerText: 'Tên vật tư', allowFiltering: true, allowSorting: false},
                                                                    {fieldName: 'donViTinh', headerText: 'Đơn vị tính', allowFiltering: true, allowSorting: false},
                                                                    {fieldName: 'loaiThietBi', headerText: 'Loại thiết bị', allowFiltering: true, allowSorting: false}
                                                                    ]" v-bind:dataSource="listTenTb" :showFilter="true"
                                                            @selectedRowChanged="gridTenTb_selectedRowChanged"
                                                            :showColumnCheckbox="false" dataKeyField="vatTuId">
                                                        </DataGrid2>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-5 col-12">
                                        <div class="info-row">
                                            <div class="key w100">Số lượng</div>
                                            <div class="value">
                                                <input type="number" class="form-control" v-model="soluong_cu">
                                                <!-- :readonly="statusSoluong_cu" -->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-7 col-12">
                                        <div class="info-row">
                                            <div class="key w100">Serial</div>
                                            <div class="value">
                                                <input type="text" class="form-control highlight" v-model="txtSerialCu"
                                                    :readonly="statusTxtSerialCu" ref="" serial_th>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-5 col-12">
                                        <div class="info-row">
                                            <div class="key w100">Tình trạng T.bị</div>
                                            <div class="value">
                                                <div class="select-custom">
                                                    <b-form-select v-model="tinhTrangTBSelected" class="form-control"
                                                        :options="listTinhTrangVTTH">
                                                    </b-form-select>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="info-row">
                                    <div class="key w100">Ghi chú</div>
                                    <div class="value">
                                        <input type="text" class="form-control highlight" v-model="txtGhiChu">
                                    </div>
                                </div>
                            </div>
                            <div class="disabledInput" v-else>
                                <div class="title-bg-main mart10">
                                    <span class="title">Thông tin vật tư thu hồi</span>
                                </div>
                                <div class="row" v-if="">
                                    <div class="col-sm-7 col-12">
                                        <div class="info-row">
                                            <div class="key w100">Tên thiết bị</div>
                                            <div class="value">
                                                <div class="select-custom">
                                                    <div class="li input-text">
                                                        <div class="select-custom">
                                                            <input class="form-control" :options="listTenTb" disabled
                                                                :readonly="disabledTenTb">
                                                            </input>
                                                        </div>
                                                    </div>
                                                    <div class="vattu_table">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-5 col-12">
                                        <div class="info-row">
                                            <div class="key w100">Số lượng</div>
                                            <div class="value">
                                                <input type="number" class="form-control">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-7 col-12">
                                        <div class="info-row">
                                            <div class="key w100">Serial</div>
                                            <div class="value">
                                                <input type="text" class="form-control highlight">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-5 col-12">
                                        <div class="info-row">
                                            <div class="key w100">Tình trạng T.bị</div>
                                            <div class="value">
                                                <div class="select-custom">
                                                    <b-form-select class="form-control" :options="listTinhTrangVTTH">
                                                    </b-form-select>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="info-row">
                                    <div class="key w100">Ghi chú</div>
                                    <div class="value">
                                        <input type="text" class="form-control highlight">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </SplitArea>
                </Split>


            </div>
        </div>
        <div class="box-form">
            <div class="legend-title">
                <div class="pull-left"> <span :class="status_TTTCCT ? 'icon fa fa-angle-down' : 'icon fa fa-angle-up'"
                        @click="status_TTTCCT = !status_TTTCCT"></span> Danh sách thuê bao</div>
                <div class="pull-left ml-5">
                    <div class="list-checks red">
                        <div class="item">
                            <div class="check-action">
                                <input type="radio" class="check" v-model="rdioCKb" value="2" id="radio_2">
                                <div class="name">Phiếu chờ duyệt ({{count.choDuyet}})
                                </div>
                            </div>
                        </div>
                        <div class="item">
                            <div class="check-action">
                                <input type="radio" class="check" v-model="rdioCKb" value="3" id="radio_3">
                                <div class="name">Trả lại ({{count.traLai}})</div>
                            </div>
                        </div>
                        <div class="item">
                            <div class="check-action">
                                <input type="radio" class="check" v-model="rdioCKb" value="4" id="radio_4">
                                <div class="name">Cấp bổ sung ({{count.boSung}})</div>
                            </div>
                        </div>
                        <div class="item">
                            <div class="check-action">
                                <input type="radio" class="check" v-model="rdioCKb" value="6" id="radio_6">
                                <div class="name">Phiếu đã giao ({{count.daGiao}})</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="clearfix"></div>
            </div>
            <div class="table-content table_donVi" v-if="status_TTTCCT">
                <DataGrid v-bind:columns="[
                        {fieldName: '', headerText: 'Hủy', allowFiltering: true, allowSorting: false, template: template, textAlign: 'center', width:'100px', freeze: 'left'},
                        {fieldName: 'MA_TB', headerText: 'Số máy/Acc', allowFiltering: true, allowSorting: false, freeze: 'left'},
                        {fieldName: 'MA_LT', headerText: 'Số ảo', allowFiltering: true, allowSorting: false, freeze: 'left'},
                        {fieldName: 'MA_GD', headerText: 'Mã GD', allowFiltering: true, allowSorting: false},
                        {fieldName: 'MA_HD_CHA', headerText: 'Mã HĐ cha', allowFiltering: true, allowSorting: false},
                        {fieldName: 'TEN_KIEULD', headerText: 'Kiểu yêu cầu', allowFiltering: true, allowSorting: false},
                        {fieldName: 'TEN_TB', headerText: 'Tên thuê bao', allowFiltering: true, allowSorting: false},
                        {fieldName: 'DIACHI_LD', headerText: 'Địa chỉ lắp đặt', allowFiltering: true, allowSorting: false},
                        {fieldName: 'LOAIHINH_TB', headerText: 'Loại hình', allowFiltering: true, allowSorting: false},
                        {fieldName: 'NGAY_YC', headerText: 'Ngày YC', allowFiltering: true, allowSorting: false},
                        {fieldName: 'NGAY_HT', headerText: 'Ngày HT', allowFiltering: true, allowSorting: false},
                        {fieldName: 'NGAYTRA_CON', headerText: 'Ngày trả', allowFiltering: true, allowSorting: false},
                        {fieldName: '', headerText: 'Ghi chú', allowFiltering: true, allowSorting: false},
                        {fieldName: 'ND_TRA_CON', headerText: 'Nội dung trả', allowFiltering: true, allowSorting: false},
                        {fieldName: 'NGUOI_CN', headerText: 'Người CN', allowFiltering: true, allowSorting: false},
                        {fieldName: 'DONVI_TC', headerText: 'Đơn vị TC', allowFiltering: true, allowSorting: false},
                        {fieldName: 'KENH_TN', headerText: 'Kênh tiếp nhận', allowFiltering: true, allowSorting: false, visible: colKenhTn_Visible},
                        {fieldName: 'TINHTRANG_BH', headerText: 'Tình trạng BH', allowFiltering: true, allowSorting: false, visible: colTinhTrang_Visible},
                        {fieldName: 'NGUOI_CN', headerText: 'NV thực hiện', allowFiltering: true, allowSorting: false},
                        {fieldName: 'DIABAN', headerText: 'Địa bàn', allowFiltering: true, allowSorting: false},
                        {fieldName: 'DIEM', headerText: 'Điểm', allowFiltering: true, allowSorting: false},
                        {fieldName: 'BH_ID', headerText: 'BH ID', allowFiltering: true, allowSorting: false},
                        {fieldName: 'ID', headerText: 'HDTB ID', allowFiltering: true, allowSorting: false},
                        ]" v-bind:dataSource="listThueBaoCapVT" :showFilter="true" :showColumnCheckbox="false"
                    dataKeyField="MA_TB" :defaultColumnCheckboxChecked="false" :allowPaging="true"
                    @selectedRowChanged="DSThueBaoCapVT_selectedRowChanged" :enablePagingServer="false"
                    ref="DSThueBaoCapVT" v-if="statusGrcHuy">
                </DataGrid>
                <DataGrid v-bind:columns="[
                    {fieldName: 'MA_TB', headerText: 'Số máy/Acc', allowFiltering: true, allowSorting: false, freeze: 'left'},
                    {fieldName: 'MA_LT', headerText: 'Số ảo', allowFiltering: true, allowSorting: false, freeze: 'left'},
                    {fieldName: 'MA_GD', headerText: 'Mã GD', allowFiltering: true, allowSorting: false},
                    {fieldName: 'MA_HD_CHA', headerText: 'Mã HĐ cha', allowFiltering: true, allowSorting: false},
                    {fieldName: 'TEN_KIEULD', headerText: 'Kiểu yêu cầu', allowFiltering: true, allowSorting: false},
                    {fieldName: 'TEN_TB', headerText: 'Tên thuê bao', allowFiltering: true, allowSorting: false},
                    {fieldName: 'DIACHI_LD', headerText: 'Địa chỉ lắp đặt', allowFiltering: true, allowSorting: false},
                    {fieldName: 'LOAIHINH_TB', headerText: 'Loại hình', allowFiltering: true, allowSorting: false},
                    {fieldName: 'NGAY_YC', headerText: 'Ngày YC', allowFiltering: true, allowSorting: false},
                    {fieldName: 'NGAY_HT', headerText: 'Ngày HT', allowFiltering: true, allowSorting: false},
                    {fieldName: 'NGAYTRA_CON', headerText: 'Ngày trả', allowFiltering: true, allowSorting: false},
                    {fieldName: '', headerText: 'Ghi chú', allowFiltering: true, allowSorting: false},
                    {fieldName: 'ND_TRA_CON', headerText: 'Nội dung trả', allowFiltering: true, allowSorting: false},
                    {fieldName: 'NGUOI_CN', headerText: 'Người CN', allowFiltering: true, allowSorting: false},
                    {fieldName: 'DONVI_TC', headerText: 'Đơn vị TC', allowFiltering: true, allowSorting: false},
                    {fieldName: 'KENH_TN', headerText: 'Kênh tiếp nhận', allowFiltering: true, allowSorting: false, visible: colKenhTn_Visible},
                    {fieldName: 'TINHTRANG_BH', headerText: 'Tình trạng BH', allowFiltering: true, allowSorting: false, visible: colTinhTrang_Visible},
                    {fieldName: 'NGUOI_CN', headerText: 'NV thực hiện', allowFiltering: true, allowSorting: false},
                    {fieldName: 'DIABAN', headerText: 'Địa bàn', allowFiltering: true, allowSorting: false},
                    {fieldName: '', headerText: 'Điểm', allowFiltering: true, allowSorting: false},
                    {fieldName: 'BH_ID', headerText: 'BH ID', allowFiltering: true, allowSorting: false},
                    {fieldName: 'ID', headerText: 'HDTB ID', allowFiltering: true, allowSorting: false},
                    ]" v-bind:dataSource="listThueBaoCapVT" :showFilter="true" :showColumnCheckbox="false"
                    dataKeyField="MA_TB" :defaultColumnCheckboxChecked="false" :allowPaging="true"
                    @selectedRowChanged="DSThueBaoCapVT_selectedRowChanged" :enablePagingServer="false"
                    ref="DSThueBaoCapVT" v-else>
                </DataGrid>
            </div>
        </div>
        <div class="row">
            <Split :gutterSize="10">
                <SplitArea :size="50" :minSize="200">
                    <div class="box-form">
                        <div class="legend-title">
                            <div class="pull-left">Danh sách vật tư đã cấp cho thuê bao</div>
                            <div class="pull-right">
                                <button class="btn btn-main pad4 lh14" @click="reloadLSVT()">
                                    <span class="nc-icon-outline arrows-1_refresh-69"></span>
                                </button>
                            </div>
                            <div class="clearfix"></div>
                        </div>
                        <div class="table-content">
                            <DataGrid v-bind:columns="[
                            {fieldName: '', headerText: 'Xóa', allowFiltering: true, allowSorting: false, template: templateXoaLSVT, textAlign: 'center', width:'100px', visible: templateXoaLSVT_show},
                            {fieldName: 'NGAY_CAP', headerText: 'Ngày cấp', allowFiltering: true, allowSorting: false, isGroupedColumn:true},
                            {fieldName: 'TEN_VT', headerText: 'Tên vật tư', allowFiltering: true, allowSorting: false},
                            {fieldName: 'SERIAL', headerText: 'Serial', allowFiltering: true, allowSorting: false},
                            {fieldName: 'SERIAL_GP', headerText: 'Serial GP', allowFiltering: true, allowSorting: false},
                            {fieldName: 'MA_TBI', headerText: 'Mã Tbị', allowFiltering: true, allowSorting: false},
                            {fieldName: 'SOLUONG', headerText: 'Số lượng', allowFiltering: true, allowSorting: false},
                            {fieldName: 'DVI_TINH', headerText: 'ĐVT', allowFiltering: true, allowSorting: false},
                            {fieldName: 'DONGIA', headerText: 'Đơn giá', allowFiltering: true, allowSorting: false},
                            {fieldName: 'LOHANG', headerText: 'Lô hàng', allowFiltering: true, allowSorting: false},
                            {fieldName: '', headerText: 'Mô tả', allowFiltering: true, allowSorting: false, template: templateFile, textAlign: 'center', width:'100px'},                           
                            {fieldName: 'KIEU_TBI', headerText: 'Kiểu T.Bị', allowFiltering: true, allowSorting: false},
                            {fieldName: 'TT_TBI', headerText: 'Trạng thái', allowFiltering: true, allowSorting: false},
                            {fieldName: 'TINHTRANGTBI_ID', headerText: 'Tình trạng T.Bị', allowFiltering: true, allowSorting: false},
                            {fieldName: 'TRANGBI', headerText: 'Kiểu trang bị', allowFiltering: true, allowSorting: false},
                            {fieldName: 'MUCDICH', headerText: 'Mục đích cấp', allowFiltering: true, allowSorting: false}, 
                            {fieldName: 'LYDO_CAP', headerText: 'Lý do cấp', allowFiltering: true, allowSorting: false},
                            {fieldName: 'KHOCAP', headerText: 'Kho cấp', allowFiltering: true, allowSorting: false}
                            ]" v-bind:dataSource="listVatTuDaCap" :showFilter="true" :showColumnCheckbox="false"
                                dataKeyField="MA_TB" :defaultColumnCheckboxChecked="false"
                                @selectedRowChanged="DSVatTuDaCap_selectedRowChanged" :enablePagingServer="false"
                                :allowPaging="true" ref="DSVatTuDaCap">
                            </DataGrid>
                            <b-form-file v-show="false" ref="ref-choose-file"  @change="onChangeFile" accept=".jpg, .jpeg, .jpe, .jfif, .png"></b-form-file>                            
                        </div>
                    </div>
                </SplitArea>
                <SplitArea :size="50" :minSize="200">
                    <div class="box-form">
                        <div class="legend-title" v-if="xtraTabPage2">
                            <div class="pull-left mart10">Danh sách vật tư thuê bao sử dụng</div>
                            <div class="pull-right">
                                <div class="list-checks">
                                    <div class="item">
                                        <button class="btn btn-main pad4 lh14"
                                            @click="fetchDSVatTuThueBaoSuDung(params.vthuebao_id)">
                                            <span class="nc-icon-outline arrows-1_refresh-69"></span>
                                        </button>
                                    </div>
                                    <div class="item vcenter">
                                        <div class="info-row">
                                            <div class="key w50">Serial</div>
                                            <div class="value">
                                                <input type="text" class="form-control highlight">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="clearfix"></div>
                        </div>
                        <div class="table-content table_donVi" v-if="xtraTabPage2">
                            <DataGrid v-bind:columns="[
                            {fieldName: '', headerText: '', allowFiltering: true, allowSorting: false, template: tempThuHoi, textAlign: 'center', width:'100px'},
                            {fieldName: 'TEN_VT_NEW', headerText: 'Thiết bị', allowFiltering: true, allowSorting: false},
                            {fieldName: 'SERIAL', headerText: 'Serial', allowFiltering: true, allowSorting: false},
                            {fieldName: 'MA_TBI', headerText: 'Mã T.bị', allowFiltering: true, allowSorting: false},
                            {fieldName: 'SOLUONG', headerText: 'Số lượng', allowFiltering: true, allowSorting: false},
                            {fieldName: 'KIEU_TBI', headerText: 'Kiểu tbi', allowFiltering: true, allowSorting: false},
                            {fieldName: 'TINHTRANG_TBI', headerText: 'Tình trạng', allowFiltering: true, allowSorting: false},
                            {fieldName: 'DONGIA', headerText: 'Trang bị', allowFiltering: true, allowSorting: false},
                            {fieldName: 'NGAY_SD', headerText: 'Ngày cấp', allowFiltering: true, allowSorting: false},
                            {fieldName: '', headerText: 'Sửa', allowFiltering: true, allowSorting: false, template: suaTemplate, textAlign: 'center'}
                            ]" v-bind:dataSource="listVatTuTBDaSuDung" :showFilter="true" :showColumnCheckbox="false"
                                dataKeyField="SERIAL" :defaultColumnCheckboxChecked="false" :allowPaging="true"
                                @selectedRowChanged="DSVatTuTBDaSuDung_selectedRowChanged" :enablePagingServer="false"
                                ref="DSVatTuDaSuDung">
                            </DataGrid>
                        </div>
                        <div class="legend-title" v-if="xtraTabPage1">
                            <div class="pull-left mart10">Danh sách vật tư trong kho</div>
                            <div class="pull-right">
                                <div class="list-checks">
                                    <div class="item">
                                        <div class="check-action normal" v-if="show_ckbLocVT">
                                            <input type="checkbox" class="check" v-model="ckbLocVT">
                                            <span class="name">Chưa dùng</span>
                                        </div>
                                    </div>
                                    <div class="item" v-if="show_ckbLocVT">
                                        <button class="btn btn-main pad4 lh14"
                                            @click="fetchDSVatTuTrongKho(params.loaitb_id)">
                                            <span class="nc-icon-outline arrows-1_refresh-69"></span>
                                        </button>
                                    </div>
                                    <div class="item vcenter">
                                        <div class="info-row">
                                            <div class="key w50">Serial</div>
                                            <div class="value">
                                                <input v-model="txtSerial" type="text" class="form-control highlight"
                                                    :readonly="readonlyTxtSerial">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="clearfix"></div>
                        </div>
                        <div class="table-content table_donVi" v-if="xtraTabPage1">
                            <DataGrid v-bind:columns="[
                                {fieldName: 'TEN_VT', headerText: 'Tên thiết bị', allowFiltering: true, allowSorting: false, width: '400px'},
                                {fieldName: 'LOHANG', headerText: 'Lô hàng', allowFiltering: true, allowSorting: false, width: '100px'},
                                {fieldName: 'SL_TON', headerText: 'Số lượng', allowFiltering: true, allowSorting: false, width: '100px'},
                                {fieldName: '', headerText: '', allowFiltering: true, allowSorting: true, template: gridVatTuSDTemplate, textAlign: 'center', width:'100px', allowEditing:false, width: '70px'},
                                {fieldName: 'LUONGCAP', headerText: 'SL Cấp', allowFiltering: true, allowSorting: false, allowEditing:true, width:'100px', editType: 'numericedit', format:'N1'},
                                {fieldName: 'TUOI_TON', headerText: 'Tuổi Tbi (Năm)', allowFiltering: true, allowSorting: false},
                                {fieldName: 'MA_TBI', headerText: 'Mã Tbị', allowFiltering: true, allowSorting: false},
                                {fieldName: 'SERIAL', headerText: 'Serial', allowFiltering: true, allowSorting: false},
                                {fieldName: 'SERIAL_GP', headerText: 'Serial GP', allowFiltering: true, allowSorting: false},
                                {fieldName: 'DVI_TINH', headerText: 'ĐVT', allowFiltering: true, allowSorting: false},
                                {fieldName: 'DONGIA', headerText: 'Đơn giá', allowFiltering: true, allowSorting: false},
                                {fieldName: 'TIEN', headerText: 'Thành tiền', allowFiltering: true, allowSorting: false},
                                {fieldName: 'TINHTRANG_TBI', headerText: 'Tình trạng T.Bị', allowFiltering: true, allowSorting: false},
                                {fieldName: 'SO_PHIEU', headerText: 'Số phiếu', allowFiltering: true, allowSorting: false},
                                {fieldName: 'CHATLUONG', headerText: 'Chất lượng', allowFiltering: true, allowSorting: false},
                                {fieldName: 'NGAY_CT', headerText: 'Ngày chuyển', allowFiltering: true, allowSorting: false},
                                ]" v-bind:dataSource="listVatTuTrongKho" :showFilter="true" :showColumnCheckbox="false"
                                :editSettings='editSettings' dataKeyField="TUVT_ID"
                                :defaultColumnCheckboxChecked="false"
                                @selectedRowChanged="DSVatTuTrongKho_selectedRowChanged" :enablePagingServer="false"
                                :allowPaging="true" ref="DSVatTuTrongKho" @cellSaved="editGridVatTuDaCap">
                            </DataGrid>
                        </div>
                    </div>
                </SplitArea>
            </Split>
        </div>
    </div>

    <!-- <b-modal ref="bfrmTestPortV2" id="bfrmTestPortV2" size="xl" title="Kiểm tra Port thuê bao" hide-footer
        body-class="p-0 thanhtoan-modal">
        <frmTestPortV2 ref="frmTestPortV2" :ma_tb="frmTestPortV2_ma_tb" :thuebao_id="frmTestPortV2_vthuebao_id" :kieu="frmTestPortV2_kieu"/>
    </b-modal> -->
    <DoiSerial modalId="modal-doiSerial" :serialCu="txtSerialCu" :vatTuIdCu="value_tenTbSelected"
        @update-serial="updateSerialCu" @cancel-update-serial="huyDoiSerial"></DoiSerial>

    <!-- Đức fix UI Showport theo ERP-->
    <ejs-dialog :visible='false' ref="popupTestPortV2" showCloseIcon=true :enableResize='true' :allowDragging='true'
        :header='"Kiểm tra Port thuê bao"' target=".main-wrapper" width="60%" height="500" :isModal='false'
        :cssClass="'popup-box'">
        <div>
            <frmTestPortV2 ref="frmTestPort" v-if="checkPortDialog.isVisiable" type="modal"
                v-bind="checkPortDialog.input"></frmTestPortV2>
        </div>
    </ejs-dialog>

    <ejs-dialog :visible='false' ref="popupTraCuuHSDT" showCloseIcon=true :enableResize='true' :allowDragging='true'
        width='100%' height="100%" :isModal='true' :cssClass="'popup-box'">
        <SearchEProfile ref="frmTraCuuHSDT"></SearchEProfile>
    </ejs-dialog>

    <!-- <ejs-dialog :enableResize='true' :allowDragging='true' :visible='false' ref="popupUploadHoSo"
        :header='"Upload hồ sơ"' showCloseIcon=true width='95%' height='100%' target='.main-wrapper'>
        <uploadEProfile :isPopup="true" :Tag="1" :ma_gd="selectedMaGD" :is_ca="true" />
    </ejs-dialog> -->
    <b-modal no-close-on-backdrop hide-footer hide-header hide-header-close class="modal" id="popupNoiDung">

        <div class="modal-content popup-box">
            <div class="popup-header">
                <div class="title">Nhập nội dung chuyển tổ</div>
                <div class="close -ap icon-close" @click="$bvModal.hide('popupNoiDung')" data-dismiss="modal">
                </div>
            </div>
            <div class="list-actions-top">
                <ul class="list">
                    <li>
                        <a @click="XacNhanChuyenTo()">
                            <span class="icon nc-icon-glyph ui-1_check-circle-08"></span> Xác nhận
                        </a>
                    </li>
                </ul>
            </div>
            <div class="popup-body">
               
                <div class="info-row">
                    <div class="key w90">
                        Nội dung
                    </div>
                    <div class="value">
                        <textarea class="form-control" v-model="NDChuyenTo" value="NDChuyenTo"
                            style="height: 100px;resize: vertical;"></textarea>
                    </div>
                </div>
            </div>
        </div>

    </b-modal>

</div>