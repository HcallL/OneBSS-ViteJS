<div class="quanly-hoso-dauchuyen">
    <div class="list-actions-top">
        <ul class="list">
            <li class="tooltip-e" @click="onClickBtnTraCuu" v-on:mousemove="onMousemoveTraCuu($event)">
                <a href="javascript:void(0)">
                    <span class="icon one-file-search"></span> Tra cứu
                </a>
                <span id="tooltip-span-tracuu">Lấy danh sách hồ sơ</span>
            </li>
            <li class="tooltip-e" @click="onClickBtnThemMoi" v-on:mousemove="onMousemoveThemMoi($event)">
                <a href="javascript:void(0)">
                    <span class="icon one-file-plus"></span> Thêm mới
                </a>
                <span id="tooltip-span-themmoi">Thêm mới hồ sơ</span>
            </li>
        </ul>
    </div>
    <div class="page-content">
        <div class="box-form">
            <div class="legend-title">
                Lọc hồ sơ
            </div>
            <div class="row">
                <div class="col-sm-4 col-12">
                    <div class="info-row">
                        <div class="key w120">Tên hồ sơ</div>
                        <div class="value">
                            <input type="text" class="form-control" ref="ref-ten-hoso" v-model.trim="tenHoSo" v-on:keyup.enter="onClickBtnTraCuu">
                        </div>
                    </div>
                </div>
                <div class="col-sm-4 col-12">
                    <div class="info-row">
                        <div class="key w120">Loại hồ sơ</div>
                        <div class="value">
                            <SelectExt 	
                                v-model="loaiHoSoId" 
                                :dataSource="dsLoaiHoSo" 
                                dataValueField="LOAIHSCC_ID" 
                                dataTextField="LOAI_HS_CC"/>
                        </div>
                    </div>
                </div>
                <div class="col-sm-4 col-12">
                    <div class="info-row">
                        <div class="key w120">Hình thức</div>
                        <div class="value">
                            <SelectExt 	
                                v-model="kieuCatChuyenId" 
                                :dataSource="dsKieuCatChuyen" 
                                dataValueField="KIEUCC_ID" 
                                dataTextField="TEN_KIEU"/>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-4 col-12">
                    <div class="info-row">
                        <div class="key w120">
                            <div class="check-action">
                                <input type="checkbox" class="check" v-model="chkNgayDangKy">
                                <span class="name">Ngày đăng ký</span>
                            </div>
                        </div>
                        <div class="value">
                            <ejs-datepicker 	
                                class="form-control bg-none bor0 fw6 text h24" 
                                :style="{'padding-top': '7px'}"
                                placeholder=""
                                format="dd/MM/yyyy"
                                v-model="ngayDangKy"
                                :enabled="chkNgayDangKy"></ejs-datepicker>

                        </div>
                    </div>
                </div>
                <div class="col-sm-4 col-12">
                    <div class="info-row">
                        <div class="key w120">
                            <div class="check-action">
                                <input type="checkbox" class="check" v-model="chkNgayBatDau">
                                <span class="name">Ngày bắt đầu</span>
                            </div>
                        </div>
                        <div class="value">
                            <ejs-datepicker 	
                                class="form-control bg-none bor0 fw6 text h24" 
                                :style="{'padding-top': '7px'}"
                                placeholder=""
                                format="dd/MM/yyyy"
                                v-model="ngayBatDau"
                                :enabled="chkNgayBatDau"></ejs-datepicker>
                        </div>
                    </div>
                </div>
                <div class="col-sm-4 col-12">
                    <div class="info-row">
                        <div class="key w120">
                            <div class="check-action">
                                <input type="checkbox" class="check" v-model="chkNgayKetThuc">
                                <span class="name">Ngày kết thúc</span>
                            </div>
                        </div>
                        <div class="value">
                            <ejs-datepicker 	
                                class="form-control bg-none bor0 fw6 text h24" 
                                :style="{'padding-top': '7px'}"
                                placeholder=""
                                format="dd/MM/yyyy"
                                v-model="ngayKetThuc"
                                :enabled="chkNgayKetThuc"></ejs-datepicker>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-4 col-12">
                    <div class="info-row">
                        <div class="key w120">
                            Trung tâm VT
                        </div>
                        <div class="value">
                            <SelectExt 	
                                v-model="ttvtId" 
                                :dataSource="dsTtvt" 
                                dataValueField="DONVI_ID" 
                                dataTextField="TEN_DV"/>
                        </div>
                    </div>
                </div>
                <div class="col-sm-4 col-12">
                    <div class="info-row">
                        <div class="key w120">
                            <div class="check-action">
                                <input type="checkbox" class="check" v-model="chkToQuanLy">
                                <span class="name">Tổ quản lý</span>
                            </div>
                        </div>
                        <div class="value">
                            <SelectExt 	
                                v-model="toQuanLyId" 
                                :dataSource="dsToQuanLy" 
                                :disabled="!chkToQuanLy"
                                dataValueField="DONVI_ID" 
                                dataTextField="TEN_DV"/>
                        </div>
                    </div>
                </div>
                <div class="col-sm-4 col-12">
                    <div class="info-row">
                        <div class="key w120">
                            Trạng thái
                        </div>
                        <div class="value">
                            <SelectExt 	
                                v-model="trangThaiId" 
                                :dataSource="dsTrangThaiCatChuyen" 
                                dataValueField="TTCC_ID" 
                                dataTextField="TRANGTHAI_CC"/>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-4 col-12">
                    <div class="info-row">
                        <div class="key w120">
                            <div class="check-action">
                                <input type="checkbox" class="check" v-model="chkVeTinh">
                                <span class="name">Vệ tinh</span>
                            </div>
                        </div>
                        <div class="value">
                            <SelectExt 	
                                v-model="veTinhId" 
                                :dataSource="dsVeTinh" 
                                :disabled="!chkVeTinh"
                                dataValueField="DONVI_ID" 
                                dataTextField="TEN_DV"/>
                        </div>
                    </div>
                </div>
                <div class="col-sm-8 col-12">
                    <div class="info-row">
                        <div class="key w120">
                            Người đăng ký
                        </div>
                        <div class="value">
                            <input type="text" class="form-control" v-model.trim="nguoiDangKy" v-on:keyup.enter="onClickBtnTraCuu">
                        </div>
                    </div>
                </div>
                
            </div>
            <div class="group-buttons -bottom">
                <div class="pull-left">
                    <a href="javascript:void(0)" class="btn btn-main" @click="onClickBtnThemMoi">
                        <span class="-ap icon-plus3"></span> Thêm mới
                    </a>
                </div>
                <div class="pull-right">
                    <a href="javascript:void(0)" class="btn btn-main" @click="onClickBtnTraCuu">
                        <span class="f20 inline vcenter one-file-search"></span> Tra cứu
                    </a>
                    <a href="javascript:void(0)" class="btn btn-main" @click="onClickBtnXuatExcel">
                        <span class="f20 inline vcenter one-xlsx-import"></span> Xuất Excel
                    </a>
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
        <div class="box-form" v-show="!showGridDsHoSo">
            <div class="legend-title">
                <div class="pull-left">
                    Danh sách hồ sơ -- Có {{dsHoSo.length}} hồ sơ.
                </div>
                <div class="pull-right">
                    <a href="javascript:void(0)" class="link -ap icon-apps f20" @click="showGridDsHoSo = !showGridDsHoSo"></a>
                </div>
                <div class="clearfix"></div>
            </div>
            <div class="bss-13180-list-grid row">
                <div v-show="dsThuGon.length > 0" class="col-xl-3 col-lg-4 col-md-4 col-sm-6">
                    <div class="item open" style="width: 100%; border: 0; box-shadow: none;">
                        <div v-for="hoSo in dsHoSo"
                            v-show="dsThuGon.indexOf(hoSo.HSCC_ID) >= 0"
                            class="head" 
                            style="text-overflow: ellipsis; overflow: hidden; padding-right: 24px; margin-bottom: 5px;"
                            :title="hoSo.TEN_HS">
                            {{hoSo.TEN_HS}} {{hoSo.HSCC_ID}} 
                            <span class="down" @click="dsThuGon = dsThuGon.filter(item => item != hoSo.HSCC_ID)"></span>
                        </div>
                    </div>
                </div>
                <div v-for="hoSo in dsHoSo" 
                    v-show="!(dsThuGon.indexOf(hoSo.HSCC_ID) >= 0)"
                    class="col-xl-3 col-lg-4 col-md-4 col-sm-6" 
                    style="padding-left: 0; margin-bottom: 10px;">
                    <div class="item" style="width: 100%; height: 100%;">
                        <div class="head" :title="hoSo.TEN_HS" style="text-overflow: ellipsis; overflow: hidden; padding-right: 24px;">
                            {{hoSo.TEN_HS}} 
                            <span class="down" @click="dsThuGon.push(hoSo.HSCC_ID)"></span>
                        </div>
                        <div class="content">
                            <table class="table-info-row">
                                <tr>
                                    <td class="key">Loại:</td>
                                    <td class="value" style="font-weight: normal;">{{hoSo.LOAI_HS_CC}}</td>
                                </tr>
                                <tr>
                                    <td class="key">Hình thức:</td>
                                    <td class="value" style="font-weight: normal;">{{hoSo.TEN_KIEU}}</td>
                                </tr>
                                <tr>
                                    <td class="key">Trạng thái:</td>
                                    <td class="value" style="font-weight: normal;">{{hoSo.TRANGTHAI_CC}}</td>
                                </tr>
                                <tr>
                                    <td class="key">Người ĐK:</td>
                                    <td class="value" style="font-weight: normal;">{{hoSo.NGUOI_DK}}</td>
                                </tr>
                                <tr>
                                    <td class="key">Ngày ĐK:</td>
                                    <td class="value" style="font-weight: normal;">{{hoSo.NGAY_YC}}</td>
                                </tr>
                                <tr>
                                    <td class="key">Ngày bắt đầu:</td>
                                    <td>{{hoSo.NGAYBD_DK}}</td>
                                </tr>
                                <tr>
                                    <td class="key">Ngày kết thúc:</td>
                                    <td class="value" style="font-weight: normal;">{{hoSo.NGAYKT_DK}}</td>
                                </tr>
                                <tr>
                                    <td class="key">Số lượng thuê bao:</td>
                                    <td class="value" style="font-weight: normal;">{{hoSo.SO_TB_DK}}</td>
                                </tr>
                                <tr>
                                    <td class="key">Mã hs:</td>
                                    <td class="value" style="font-weight: normal;">{{hoSo.MA_HS_CC}}</td>
                                </tr>
                            </table>
                            <div class="group-buttons tright">
                                <button class="pad5 minw0 btn btn-main" @click="onClickBtnEditHoSo(hoSo.HSCC_ID)">
                                    <span class="lh20 f20 nc-icon-glyph ui-1_edit-76"></span>
                                </button>
                                <button class="pad5 minw0 btn btn-second" @click="onClickBtnXoaHoSo(hoSo.HSCC_ID, hoSo.SO_TB_DK)">
                                    <span class="lh20 f20 one-trash"></span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="box-form" v-show="showGridDsHoSo">
            <div class="legend-title">
                <div class="pull-left">
                    Danh sách hồ sơ -- Có {{dsHoSo.length}} hồ sơ.
                </div>
                <div class="pull-right">
                    <a href="javascript:void(0)" class="link -ap icon-list-unordered f20" @click="showGridDsHoSo = !showGridDsHoSo"></a>
                </div>
                <div class="clearfix"></div>
            </div>
            <div class="table-content">
                <DataGrid 
                    ref="grid-hoso"
                    v-bind:columns="[
                        {fieldName: 'TEN_HS', headerText: 'Tên hồ sơ', allowFiltering: true, width: '130' },
                        {fieldName: 'LOAI_HS_CC', headerText: 'Loại', allowFiltering: true, width: '130' },
                        {fieldName: 'TEN_KIEU', headerText: 'Hình thức', allowFiltering: true, width: '130' },
                        {fieldName: 'TRANGTHAI_CC', headerText: 'Trạng thái', allowFiltering: true, width: '130' },
                        {fieldName: 'NGUOI_DK', headerText: 'Người đăng ký', allowFiltering: true, width: '130' },
                        {fieldName: 'NGAY_YC_HT', headerText: 'Ngày đăng ký', allowFiltering: true, width: '130' },
                        {fieldName: 'NGAYBD_DK_HT', headerText: 'Ngày bắt đầu', textAlign: 'Right', allowFiltering: true, width: '150' },
                        {fieldName: 'NGAYKT_DK_HT', headerText: 'Ngày kết thúc', textAlign: 'Right', allowFiltering: true, width: '150' },
                        {fieldName: 'SO_TB_DK', headerText: 'Số lượng thuê bao', allowFiltering: true, width: '150' },
                        {fieldName: '', headerText: 'Thao tác', textAlign: 'Center', freeze: 'Right', allowFiltering: false, width: '100', template: getColumnTemplateChucNang(this) },
                    ]"
                    v-bind:dataSource="dsHoSo" 
                    :showFilter="true"
                    :allowPaging="true"
                    :enablePagingServer="false"></DataGrid>
            </div>
        </div>
    </div>
    <modal-lap-ho-so modal-id="id-modal-lap-hoso" :hscc-id="idHoSoDuocChon" @change="onChangeModalLapHoso" />
    <b-modal id="modal-xacnhan-xoa-hoso" centered title="Thông báo" size="sm" @ok="okXoaHoSo">        
        <span>Bạn có chắc muốn xóa hồ sơ này?</span>
        <template #modal-footer="{ ok, cancel }">
             <b-button variant="secondary" style="color: white" @click="cancel()">Hủy</b-button>
             <b-button variant="primary" style="color: white" @click="ok()">Đồng ý</b-button>
        </template>
   </b-modal>
   
</div>