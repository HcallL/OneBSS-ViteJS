<div class="xetduyet-phantu-mang-hodan-thuthap">
  <div class="list-actions-top">
    <ul class="list">
      <li @click="this.btnHienThi">
        <a href="javascript:void(0)">
          <span class="icon one-search"></span>Hiển thị
        </a>
      </li>
      <li>
        <a href="javascript:void(0)" @click="btnDuyet">
          <span class="icon nc-icon-glyph ui-1_check-circle-08"></span>Duyệt
        </a>
      </li>
      <li>
        <a href="javascript:void(0)" @click="btnKhongDat">
          <span class="one-cancel  f20 inlien vcenter"></span>Không đạt
        </a>
      </li>
      <li>
        <a href="javascript:void(0)" @click="btnXuatFile">
          <span class="icon one-download"></span>Xuất file
        </a>
      </li>

    </ul>
  </div>
  <div class="page-content">
    <div class="row">
      <div class="col-sm-3 col-12">
        <div class="box-form">
          <div class="legend-title">Đối tượng</div>
          <div class="select-custom">
<!--            <button class="btn form-control tleft text">-->
<!--              <span class="icon nc-icon-outline ui-2_archive text-main f20 inline vcenter lh14"></span> Hạ tầng mạng-->
<!--            </button>-->
            <select name="" class="form-control" v-model="cboDoiTuong">
              <option v-for="(item,index) in this.dsDoiTuong" :value="index">{{item}}</option>
            </select>
          </div>
        </div>
        <div class="box-form">
          <div class="legend-title">Trạng thái</div>
          <div class="select-custom">
<!--            <select name="" class="form-control" v-model="cboTrangThai">-->
<!--              <option v-for="item in this.dsTrangThai" :value="item">{{item}}</option>-->
<!--            </select>-->
            <ejs-multiselect
              mode="CheckBox"
              selectAllText="Chọn tất cả"
              unSelectAllText="Bỏ chọn tất cả"
              v-model="cboTrangThai"
              locale='vi-VN'
              :dataSource='dsTrangThai'
              :allowFiltering='true'
              :fields="{value:'TRANGTHAI_VALUE', text: 'TRANGTHAI_TEXT'}"
              :showSelectAll="true"
              :showDropDownIcon="true"
            ></ejs-multiselect>
          </div>
        </div>
        <div v-show="isShowChuQuan" class="box-form">
          <div class="legend-title">Chủ quản</div>
          <div v-if="this.cboDoiTuong !==1" class="select-custom">
<!--            <select name="" id="" class="form-control">-->
<!--              <option value="">Điện lực, Viettel, Địa phương, CMC, VTC, ...</option>-->
<!--            </select>-->
            <ejs-multiselect
              mode="CheckBox"
              selectAllText="Chọn tất cả"
              unSelectAllText="Bỏ chọn tất cả"
              v-model="cboChuQuan"
              locale='vi-VN'
              :dataSource='dsChuQuan'
              :allowFiltering='true'
              :fields="{value:'CHUQUAN_ID', text: 'TENCHUQUAN'}"
              :showSelectAll="true"
              :showDropDownIcon="true"
              ></ejs-multiselect>
          </div>
          <div v-if="this.cboDoiTuong ===1" class="select-custom">
            <ejs-multiselect
              mode="CheckBox"
              selectAllText="Chọn tất cả"
              unSelectAllText="Bỏ chọn tất cả"
              v-model="cboChuQuan"
              locale='vi-VN'
              :dataSource='dsChuQuan'
              :allowFiltering='true'
              :fields="{value:'CHUQUAN_ID', text: 'TENCHUQUAN'}"
              :showSelectAll="true"
              :showDropDownIcon="true"
              :open="onOpen"
              :select="onSelect"
              cssClass="custom"
              ></ejs-multiselect>
          </div>
        </div>
        <div class="box-form">
          <div class="legend-title">Đơn vị</div>
          <div class="tree-plus-ext tree-icon" style="height: 485px;overflow: auto;">
              <ejs-treeview id="treeview" ref="treeObj" :nodeChecked="this.nodeChecked" :fields='this.fieldsDonVi' :showCheckBox='true'></ejs-treeview>
<!--            <ul class="">-->
<!--              <li class="haschild open">-->
<!--                <a href="#">-->
<!--                  <div class="check-action">-->
<!--                    <input type="checkbox" class="check">-->
<!--                    <span class="name">Viễn thông Hải Phòng</span>-->
<!--                  </div>-->
<!--                </a>-->
<!--                <ul>-->
<!--                  <li>-->
<!--                    <a href="#">-->
<!--                      <div class="check-action">-->
<!--                        <input type="checkbox" class="check">-->
<!--                        <span class="name">Trung tâm viễn thông 1</span>-->
<!--                      </div>-->
<!--                    </a>-->
<!--                  </li>-->
<!--                  <li>-->
<!--                    <a href="#">-->
<!--                      <div class="check-action">-->
<!--                        <input type="checkbox" class="check">-->
<!--                        <span class="name">Trung tâm viễn thông 2</span>-->
<!--                      </div>-->
<!--                    </a>-->
<!--                  </li>-->
<!--                  <li>-->
<!--                    <a href="#">-->
<!--                      <div class="check-action">-->
<!--                        <input type="checkbox" class="check">-->
<!--                        <span class="name">Trung tâm viễn thông 3</span>-->
<!--                      </div>-->
<!--                    </a>-->
<!--                  </li>-->
<!--                  <li>-->
<!--                    <a href="#">-->
<!--                      <div class="check-action">-->
<!--                        <input type="checkbox" class="check">-->
<!--                        <span class="name">Trung tâm viễn thông 4</span>-->
<!--                      </div>-->
<!--                    </a>-->
<!--                  </li>-->
<!--                  <li>-->
<!--                    <a href="#">-->
<!--                      <div class="check-action">-->
<!--                        <input type="checkbox" class="check">-->
<!--                        <span class="name">Trung tâm viễn thông 4</span>-->
<!--                      </div>-->
<!--                    </a>-->
<!--                  </li>-->
<!--                  <li>-->
<!--                    <a href="#">-->
<!--                      <div class="check-action">-->
<!--                        <input type="checkbox" class="check">-->
<!--                        <span class="name">Trung tâm viễn thông 4</span>-->
<!--                      </div>-->
<!--                    </a>-->
<!--                  </li>-->
<!--                </ul>-->
<!--              </li>-->

<!--            </ul>-->
          </div>
        </div>
      </div>
      <div class="col-sm-9 col-12">
        <div class="box-form">
          <div class="legend-title">{{ gridTitle }}</div>
          <div v-show="isShowFilter">
            <div class="row">
              <div class="col-sm-6 col-12">
                <div class="info-row">
                  <div class="key w30 nowrap padr10">
                    <div class="check-action">
                      <input v-model="checkAll" type="checkbox" class="check">
                      <span class="name">Chọn tất</span>
                    </div>
                  </div>
                  <div class="key w80">Lọc theo NV</div>
                  <div class="value">
                    <div class="select-custom">
                      <!--                    <select name="" id="" class="form-control">-->
                      <!--                      <option value=""></option>-->
                      <!--                    </select>-->
                      <SelectExt v-model.trim="cboNhanVien" :dataSource="dsNhanVien" dataTextField="TEN_NV"
                                 dataValueField="NHANVIEN_ID"/>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-sm-6 col-12">
                <div class="info-row">
                  <div class="key w100" v-if="cboDoiTuong !== 2">Lọc theo kí hiệu</div>
                  <div class="key w100" v-if="cboDoiTuong === 2">Lọc theo tên</div>
                  <div class="value">
                    <input v-on:keyup.enter="filterByKyHieu" v-model="kyHieuFilterInput" type="text" class="form-control">
                  </div>
                  <div class="value w30 nowrap">
                    <div class="list-checks mart7 text-main">
                      <div class="item">Tổng số: {{this.totalRows}}</div>
                      <div class="item">Đang xem: {{ this.pSize * (pNo - 1) + 1}} - {{(this.pSize * (pNo - 1) + 1 + this.pSize) < this.totalRows ? this.pSize * (pNo - 1) + 1 + this.pSize : this.totalRows}}</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="box-form marb30">
              <div class="pagination-box">
                <span class="text">Trang</span>
                <div id="paging" class="pagination inline">
                  <template v-for="i in this.dsPage">
                    <a :class="i === 1 ? 'active':''"  href="javascript:void(0)" @click="chonTrang(i)">{{i}}</a>
                  </template>
                </div>
              </div>
            </div>
          </div>
          <div class="box-fix-h" style="height: 828px; overflow: auto;">
            <template v-for="(item,index) in this.dsGrouped">
              <div style="cursor: pointer" class="legend-title" @click="btnCollapse(index)">
                <div :id="'title'+index" class="icon fa fa-angle-down" ></div> {{item.TEN_NV_NHAP}}: {{ item.size }} kết cuối
              </div>
              <div :id="index" class="bss-1803-list-kc">
                <template v-if="cboDoiTuong !== 2" v-for="(i,idx) in item.list">
                  <div class="item">
                    <div class="info-row">
                      <div class="value padl0 w10">
                        <button class="btn btn-main padl5 padr5">{{ idx +1 }}</button>
                      </div>
                      <div class="value">
                        <div class="title-bg-main">
                          <div class="pull-left">
                            <span class="normal">{{i.TEN_KC}}</span>
                          </div>
                          <div class="pull-right">
                            <div v-if="i.TT_DUYET === 0" class="text-success fw6">Chờ duyệt</div>
                            <div v-if="i.TT_DUYET === 1" class="text-danger fw6">Không đạt</div>
                            <div v-if="i.TT_DUYET === 2" class="text-primary fw6">Đã duyệt</div>
                          </div>
                          <div class="clearfix"></div>
                        </div>
                      </div>
                      <div class="value w30 nowrap">
                        <button v-if="i.CHUQUAN_ID !== 1" class="btn btn-main pad7 lh16" @click="showQLKetCuoiDoiThu(i)">
                          <span class="icon business_award-49 nc-icon-outline f20"></span>
                        </button>
                        <button v-if="i.CHUQUAN_ID === 1" class="btn btn-main pad7 lh16" @click="showQLKetCuoi(i)">
                          <span class="icon business_award-49 nc-icon-outline f20"></span>
                        </button>

                        <button class="btn btn-main pad7 lh16" @click="showChonToaDo(i)">
                          <span class="icon location_map-pin nc-icon-outline f20"></span>
                        </button>
                        <button v-if="i.LOAI_DT === 1 ||(i.LOAI_DT !== 1 && i.TT_DUYET === 1)" class="btn btn-main pad7 lh16" @click="btnXoaKCDoiThu(i)">
                          <span class="icon ui-1_trash-simple nc-icon-outline f20"></span>
                        </button>
                      </div>
                      <div class="value w10">
                        <div class="check-action padt8 padl5">
                          <input v-model="checkedKC" type="checkbox" class="check" :value="i">
                          <span class="name"></span>
                        </div>
                      </div>
                    </div>
                    <div class="box-content">
                      <div class="row" style="width: 100%">
                        <div class="col-sm-3 col-12" style="width: 30%">
                          <div class="info-row">
                            <div class="image" style="height: 80%">
                              <img v-if="i.CURRENT_IMG > 0" class="thumbnail" :src="i.IMG[i.CURRENT_IMG-1].url" alt="">
                              <img v-if="i.CURRENT_IMG ===0" class="thumbnail" src="static/icons/no-image.png" alt="">
                            </div>
                            <div class="tc-pagination mart10">
                              <a href="javascript:void(0)" class="btn fa fa-angle-left" @click="previousImage(i)" :class="{'disabled': i.CURRENT_IMG === 0 ? true: (i.CURRENT_IMG === 1)}"></a>
                              <div class="dropdown inline">
                                <div class="fw6 input-number1" data-toggle="dropdown" style="text-align: center;">
                                  <span class="text-main">{{ i.CURRENT_IMG  }}</span>/{{ i.IMG.length }}
                                </div>
                                <!--                                <div class="dropdown-menu">-->
                                <!--                                  <a href="javascript:void(0)" class="dropdown-item">10</a>-->
                                <!--                                  <a href="javascript:void(0)" class="dropdown-item">20</a>-->
                                <!--                                </div>-->
                              </div>
                              <a href="javascript:void(0)" class="btn fa fa-angle-right" @click="nextImage(i)" :class="{'disabled': i.CURRENT_IMG === 0 ? true: (i.CURRENT_IMG === i.IMG.length)}"></a>
                            </div>
                          </div>
                        </div>

                        <div class="col-sm-9 col-12" style="width: 70%">
                          <div class="info">
                            <p>Ký hiệu: {{i.KYHIEU}}</p>
                            <p>Dung lượng: {{ i.DUNGLUONG }}</p>
                            <p>Chủ quản: {{ i.TENCHUQUAN }}</p>
                            <p>Địa chỉ: {{i.DIACHI}}</p>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </template>
                <template v-if="cboDoiTuong === 2" v-for="(i,idx) in item.list">
                  <div class="item">
                    <div class="info-row">
                      <div class="value padl0 w10">
                        <button class="btn btn-main padl5 padr5">{{ idx +1 }}</button>
                      </div>
                      <div class="value">
                        <div class="title-bg-main">
                          <div class="pull-left">
                            <span class="normal">{{i.TEN_KH}}</span>
                          </div>
                          <div class="pull-right">
                            <div v-if="i.TT_DUYET === 0" class="text-success fw6">Chờ duyệt</div>
                            <div v-if="i.TT_DUYET === 1" class="text-danger fw6">Không đạt</div>
                            <div v-if="i.TT_DUYET === 2" class="text-primary fw6">Đã duyệt</div>
                          </div>
                          <div class="clearfix"></div>
                        </div>
                      </div>
                      <div class="value w30 nowrap">
                        <button class="btn btn-main pad7 lh16" @click="showQuanLyHoDan(i)">
                          <span class="icon business_award-49 nc-icon-outline f20"></span>
                        </button>

                        <button class="btn btn-main pad7 lh16" @click="showChonToaDo(i)">
                          <span class="icon location_map-pin nc-icon-outline f20"></span>
                        </button>
                        <button v-if="i.LOAI_DT === 1 ||(i.LOAI_DT !== 1 && i.TT_DUYET === 1)" class="btn btn-main pad7 lh16">
                          <span class="icon ui-1_trash-simple nc-icon-outline f20"></span>
                        </button>
                      </div>
                      <div class="value w10">
                        <div class="check-action padt8 padl5">
                          <input v-model="checkedKC" type="checkbox" class="check" :value="i">
                          <span class="name"></span>
                        </div>
                      </div>
                    </div>
                    <div class="box-content">
                      <div class="row" style="width: 100%">
                        <div class="col-sm-3 col-12" style="width: 30%">
                          <div class="info-row">
                            <div class="image" style="height: 80%;">
                              <img v-if="i.CURRENT_IMG > 0" class="thumbnail" :src="i.IMG[i.CURRENT_IMG-1].url" alt="">
                              <img v-if="i.CURRENT_IMG ===0" class="thumbnail" src="static/icons/no-image.png" alt="">
                            </div>
                            <div class="tc-pagination mart10">
                              <a href="javascript:void(0)" class="btn fa fa-angle-left" @click="previousImage(i)" :class="{'disabled': i.CURRENT_IMG === 0 ? true: (i.CURRENT_IMG === 1)}"></a>
                              <div class="dropdown inline">
                                <div class="fw6 input-number1" data-toggle="dropdown" style="text-align: center;">
                                  <span class="text-main">{{ i.CURRENT_IMG  }}</span>/{{ i.IMG.length }}
                                </div>
<!--                                <div class="dropdown-menu">-->
<!--                                  <a href="javascript:void(0)" class="dropdown-item">10</a>-->
<!--                                  <a href="javascript:void(0)" class="dropdown-item">20</a>-->
<!--                                </div>-->
                              </div>
                              <a href="javascript:void(0)" class="btn fa fa-angle-right" @click="nextImage(i)" :class="{'disabled': i.CURRENT_IMG === 0 ? true: (i.CURRENT_IMG === i.IMG.length)}"></a>
                            </div>
                          </div>
                        </div>
                        <div class="col-sm-9 col-12" style="width: 70%">
                          <div class="info">
                            <p>Chủ hộ: {{i.TEN_KH}}</p>
                            <p v-if="i.SO_DT">SĐT: {{ i.SO_DT }}</p>
                            <p>Phân loại: {{ i.LOAI_HODAN }}</p>
                            <p>Mức sống: {{ i.MUCSONG }}</p>
                            <p>Địa chỉ: {{i.DIACHI}}</p>
                            <p>Thông tin thuê bao: {{i.TT_THUEBAO}}</p>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </template>
              </div>
            </template>
          </div>
        </div>
      </div>
    </div>
  </div>
  <QuanLyKetCuoiDoiThu  id="popupQuanLyKetCuoiDoiThu" :ketCuoiObject="ketCuoiObject" @reload="btnHienThi" />
  <QuanLyKetCuoi  id="popupQuanLyKetCuoi" :ketCuoiObject="ketCuoiObject" />
  <QuanLyHoDan id="popupQuanLyHoDan" :hoDan="getHoDan" @reload="btnHienThi"/>
  <ModalChonToaDo  idModalChonToaDo="ModalChonToaDo" @XacNhanToaDo="XacNhanToaDo" :position="getPosition" :diachi="getDiachi" :ten_kc="getTenKC"></ModalChonToaDo>
  <ModalXuatDuLieu
    id="modal-xuat-dulieu"
    :thuocTinh="dsThuocTinh"
    :data="dsIn"
    @close="closeFormXuatDuLieu"
  ></ModalXuatDuLieu>
  <GhiChuDuyet id="popupGhiChuDuyet" :checkedKC="checkedKC" :isDuyet="isDuyet" @reload="btnHienThi"></GhiChuDuyet>
</div>
