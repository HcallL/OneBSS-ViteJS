<div class="quan-ly-truyen-dan">
  <div class="list-actions-top">
    <ul class="list">
      <li>
        <a href="javascript:void(0)" @click="NAP_GIANDO_TRUYENDAN()">
          <span class="icon one-file-refresh"></span>Nạp lại
        </a>
      </li>
      <li>
        <a href="javascript:void(0)" @click="btnInGD">
          <span class="icon one-file-refresh"></span>In giản đồ
        </a>
      </li>
      <li>
        <a href="javascript:void(0)" @click="zoomInGD">
          <span class="icon ui-1_zoom-in nc-icon-outline"></span>
        </a>
      </li>
      <li>
        <a href="javascript:void(0)" style="border-left: 0px;" @click="zoomOutGD">
          <span class="icon ui-1_zoom-out nc-icon-outline"></span>
        </a>
      </li>
      <li>
        <a href="javascript:void(0)" style="border-left: 0px;" @click="fitToPageGD">
          <span class="icon one-zoom-default"></span>
        </a>
      </li>
      <li>
        <a href="javascript:void(0)">
          <span class="icon  one-book1"></span> Hướng dẫn
        </a>
      </li>
    </ul>
  </div>
  <div class="page-content">
    <Split>
      <SplitArea :size="20" :minSize="100">
        <div class="box-form">
          <div class="legend-title">Tuyến cáp truyền dẫn</div>
          <div class="info-row">
            <div class="key w70">Tuyến cáp</div>
<!--            <div class="value">-->
<!--              <div class="select-custom">-->
<!--                <select name="" id="" class="form-control" v-model="selected.TUYENCAP_ID">-->
<!--                  <option v-for="item in data.dsTuyenCap" :value="item.TUYENCAP_ID">{{item.TUYEN_CAP}}</option>-->
<!--                </select>-->
<!--              </div>-->
<!--            </div>-->
             <div class="value">
                <ComboboxGrid ref="tuyen-cap" v-bind:columns="[
                {fieldName: 'TUYEN_CAP', headerText: 'Tuyến cáp', allowFiltering: true},
                {fieldName: 'MA_TC', headerText: 'Mã tuyến cáp', allowFiltering: true},
                {fieldName: 'TEN_DV', headerText: 'Đơn vị QL', allowFiltering: true},
                ]"
                  v-bind:dataSource="data.dsTuyenCap"
                  textField="TUYEN_CAP" valueField="TUYENCAP_ID"
                  v-model="selected.TUYENCAP_ID"
                  @selectedChanged="tuyencap_selectedChanged">
                </ComboboxGrid>
            </div>
          </div>

          <div class="info-row">
            <div class="key w70">Ghi chú</div>
            <div class="value">
              <input v-model="txt_ghichuTuyenCap" type="text" class="form-control" :disabled="true">
            </div>
          </div>

        </div>
        <div class="box-form">
          <div class="legend-title">Danh sách trạm thiết bị</div>
          <div class="info-row">
            <div class="key w90">Trung tâm VT</div>
            <div class="value">
              <div class="select-custom">
                <select name="" id="" class="form-control" v-model="selected.TTVT_ID">
                  <option v-for="item in data.dsTTVT" :value="item.DONVI_ID">{{item.TEN_DV}}</option>
                </select>
              </div>
            </div>
          </div>

          <div class="info-row">
            <div class="key w90">Tổ kỹ thuật</div>
            <div class="value">
              <div class="select-custom">
                <select name="" id="" class="form-control" v-model="selected.TOVT_ID">
                  <option v-for="item in data.dsTOVT" :value="item.DONVI_ID">{{item.TEN_DV}}</option>
                </select>
              </div>
            </div>
          </div>
          <DataGrid :columns="[
            {fieldName: 'TEN_DV', headerText: ''}
            ]"
                    :dataSource="data.dsTRAMTB"
                    :visibleHeader="false"
                    @recordDoubleClick="recordDoubleClickTRAM_TB"
                    panelDataHeight="50px">

          </DataGrid>

          <!-- <ejs-grid ref="gridTTB" :actionComplete="onActionComplete" :created="onCreateGridTTB"
            :rowSelected="onRowSelectedTTB" locale="vi-VN" :enableHover='false' :recordDoubleClick='onDoubleClickTTB'
            :dataBound='dataBoundTTB' height='200' width='auto' gridLines='Both' :allowFiltering='true'
            :dataSource="data.dsTRAMTB" :allowPaging="false" :allowResizing='true' :allowScrolling='true'>
            <e-columns>
              <e-column headerText="" textAlign="Center" width="10" :allowFiltering="false" :template="columnTemplate">
              </e-column>
              <e-column field='TEN_DV' headerText='' headerTextAlign="Center" textAlign='Left' width=70
                :filterBarTemplate="filterBarTemplate"></e-column>
            </e-columns>
          </ejs-grid> -->
        </div>
        <div class="box-form">
          <div class="legend-title">Danh sách cáp gốc</div>
          <div class="info-row">
            <div class="key w90">Trung tâm VT</div>
            <div class="value">
              <div class="select-custom">
                <select name="" id="" class="form-control" v-model="selected.TTVT_ID_2">
                  <option v-for="item in data.dsTTVT" :value="item.DONVI_ID">{{item.TEN_DV}}</option>
                </select>
              </div>
            </div>
          </div>

          <div class="info-row">
            <div class="key w90">Tổ kỹ thuật</div>
            <div class="value">
              <div class="select-custom">
                <select name="" id="" class="form-control" v-model="selected.TOVT_ID_2">
                  <option v-for="item in data.dsTOVT_2" :value="item.DONVI_ID">{{item.TEN_DV}}</option>
                </select>
              </div>
            </div>
          </div>
          <div class="info-row">
            <div class="key w90">Đài/Trạm</div>
            <div class="value">
              <div class="select-custom">
                <select name="" id="" class="form-control" v-model="selected.TRAMTB_ID">
                  <option v-for="item in data.dsTRAMTB_2" :value="item.DONVI_ID">{{item.TEN_DV}}</option>
                </select>
              </div>
            </div>
          </div>
          <DataGrid :columns="[
            {fieldName: 'NHOM_LC', headerText: 'Nhóm loại cáp', isGroupedColumn: true},
            {fieldName: 'KYHIEU', headerText: ''}
            ]" :dataSource="data.dsCAPGOC"
                    panelDataHeight="70px"
                    :showColumnCheckbox="true"
                    :visibleHeader="true"
                    @rowSelected="capgoc_rowSelected"
                    @rowDeselected="capgoc_rowDeselected"
                    :enabledSelectFirstRow="false"></DataGrid>
          <!-- <ejs-grid ref="gridCG" :allowGrouping='true' :groupSettings='groupOptions' :actionComplete="onActionComplete"
            :created="onCreateGridCG" :rowSelected="onRowSelectedCG" locale="vi-VN" :enableHover='false'
            :recordDoubleClick='onDoubleClickCG' :dataBound='dataBoundCG' height='200' gridLines='Both'
            :allowFiltering='true' :dataSource="data.dsCAPGOC" :allowPaging="false" :allowResizing='true'
            :allowScrolling='true'>
            <e-columns>
              <e-column headerText="" textAlign="Center" width="20" :allowFiltering="false" :template="columnTemplate">
              </e-column>
              <e-column type='checkbox' textAlign='Center' :allowFiltering='false' :allowSorting='false' width='35'>
              </e-column>
              <e-column field='NHOM_LC' headerText='Nhóm loại cáp' width='140'></e-column>
              <e-column field='KYHIEU' headerText='' headerTextAlign="Center" textAlign='Left' width=70
                :filterBarTemplate="filterBarTemplate"></e-column>
            </e-columns>
          </ejs-grid> -->
        </div>
      </SplitArea>
      <SplitArea :size="80" :minSize="300">
        <div class="nav tabs tab-over">
          <a href="#tabGianDo" class="active" data-toggle="tab" @click="showtabGianDo=true">
            Giản đồ
          </a>
          <a href="#tabBanDo" data-toggle="tab" @click="showtabGianDo=false">
            Bản đồ
          </a>
        </div>
        <div class="banner" v-show="showtabGianDo">
          <div class="banner-diagram" style="display: flex">
            <div class="info-row">
              <div class="text-main" v-if="this.chuthich1.visible">
                <b>{{ chuthich1.lblChuThich1 }}</b>
              </div>
              <div class="value w200" v-if="this.chuthich2.visible">
                <b>{{ chuthich2.lblChuThich2 }}</b>
              </div>
              <div class="text-main" v-if="this.ditu1.visible">
                <b>{{ ditu1.lblDiTu1 }}</b>
              </div>
              <div class="value w200" v-if="this.ditu2.visible">
                <b>{{ ditu2.lblDiTu2 }}</b>
              </div>
              <div class="text-main" v-if="this.diden1.visible">
                <b>{{ diden1.lblDiDen1 }}</b>
              </div>
              <div class="value w200" v-if="this.diden2.visible">
                <b>{{ diden2.lblDiDen2 }}</b>
              </div>

              <div class="text-main">
                <b>Bố cục</b>
              </div>
              <div class="value w200">
                <b>{{ this.lblBocuc }}</b>
              </div>
            </div>
          </div>
        </div>
        <div class="tab-content">
          <div class="tab-pane active" id="tabGianDo" v-show="showtabGianDo">
            <div class="sitemap-chart-canvas relative">
              <Diagram ref="GianDo"
                :ADD_TRAM_TB_FLAG="ADD_TRAM_TB_FLAG"
                @mniChuyenKieuCap_Click="mniChuyenKieuCap_Click"
                @mniLuuBoCuc_Click="mniLuuBoCuc_Click" @mniXoaCap_Click="mniXoaCap_Click"
                @CAPNHAT_BOCUC_GIANDO="CAPNHAT_BOCUC_GIANDO" @mniLamTuoi_Click="mniLamTuoi_Click"
                @diaGianDo_ObjectAdded="diaGianDo_ObjectAdded" @QLCapIsOk="QLCapIsOk"
                @SUA_THUOCTINH_KETCUOI="SUA_THUOCTINH_KETCUOI" @SUA_THUOCTINH_TRAM_TB="SUA_THUOCTINH_TRAM_TB"
                @showInforSelected="showInforSelected" @currentZoomScale="getCurrentZoomScale"></Diagram>
               <div class="box-search" v-show="isSearch%2==1">
                                <div class="info-row marb0">
                                    <div class="key w80 text-main">Tìm kiếm</div>
                                    <div class="value" style="width: 120px">
                                        <div class="select-custom">
                                            <select name="" class="form-control" v-model="searchCategory">
                                                <option value="TRAM_TB">Trạm</option>
                                                <option value="KETCUOI">Kết cuối</option>
                                                <option value="CAP">Cáp</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="value">
                                        <div class="dropdown">
                                            <div class="input-icon-right" data-toggle="dropdown">
                                                <input type="text" class="form-control" @click="showDataSearch = !showDataSearch; txttimkiem=''" v-model="txttimkiem">
                                                <span class="nc-icon-outline icon ui-1_circle-remove red pointer" @click="isSearch++"></span>
                                            </div>

                                            <div class="dropdown-menu dropdown-search dropdown-icon show" v-show="showDataSearch"
                                                 style="max-height: 300px;margin-bottom: 10px;overflow: scroll;">
<!--                                                <a href="#">-->
<!--                                                    <span class="title">A-HLD/02/82(CapXMM)</span>-->
<!--                                                    <span class="desc">Cáp quang - Chưa xác định - Dung lượng :12</span>-->
<!--                                                </a>-->
<!--                                                <a href="#">-->
<!--                                                    <span class="title">A-HLD/02/82(CapXMM)</span>-->
<!--                                                    <span class="desc">Cáp quang - Chưa xác định - Dung lượng :12</span>-->
<!--                                                </a>-->
<!--                                                <a href="#">-->
<!--                                                    <span class="title">A-HLD/02/82(CapXMM)</span>-->
<!--                                                    <span class="desc">Cáp quang - Chưa xác định - Dung lượng :12</span>-->
<!--                                                </a>-->
<!--                                                <a href="#">-->
<!--                                                    <span class="title">A-HLD/02/82(CapXMM)</span>-->
<!--                                                    <span class="desc">Cáp quang - Chưa xác định - Dung lượng :12</span>-->
<!--                                                </a>-->
                                              <b-list-group v-show="searchCategory === 'TRAM_TB'" v-for="(item) in dsTramTBSearch"
                                                            @click="timkiemNode(item)" v-bind:key="item.properties.id">
                                                <b-list-group-item>
                                                  <a class="btn" style="display: flex; align-items: center;">
                                                    <span class="image-connector-search">
                                                      <img :src="item.properties.shape.properties.source" style="width: 20px; margin-right: 10px;">
                                                    </span>
                                                    <span class="title">{{item.Name}}</span>
<!--                                                    <span class="desc">{{item.ICON_STYLE}}</span>-->
                                                  </a>
                                                </b-list-group-item>
                                              </b-list-group>
                                              <b-list-group v-show="searchCategory === 'KETCUOI'" v-for="(item) in dsKetCuoiSearch"
                                                            @click="timkiemNode(item)" v-bind:key="item.properties.id">
                                                <b-list-group-item>
                                                  <a class="btn" style="display: flex; align-items: center;">
                                                    <span class="image-connector-search">
                                                      <img :src="item.properties.shape.properties.source" style="width: 20px; margin-right: 10px;">
                                                    </span>
                                                    <span class="title">{{item.Name}}</span>
<!--                                                    <span class="desc">{{item.ICON_STYLE}}</span>-->
                                                  </a>
                                                </b-list-group-item>
                                              </b-list-group>
                                              <b-list-group v-show="searchCategory === 'CAP'" v-for="(item) in dsCapSearch"
                                                            @click="timkiemConnector(item)" v-bind:key="item.properties.id">
                                                <b-list-group-item>
                                                  <a class="btn" style="display: flex; align-items: center;">
                                                    <span class="icon one-td-journey1"></span>
                                                    <span class="title">{{item.Name}}</span>
<!--                                                    <span class="desc">{{item.ICON_STYLE}}</span>-->
                                                  </a>
                                                </b-list-group-item>
                                              </b-list-group>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
<!--                            <div class="menu-context" style="top: 10%;">-->
<!--                                <a href="#">-->
<!--                                    <span class="icon nc-icon-outline arrows-1_tail-right"></span> Tạo cáp tới-->
<!--                                </a>-->
<!--                                <a href="#">-->
<!--                                    <span class="icon nc-icon-outline ui-2_link-72"></span> Đấu nối cáp-->
<!--                                </a>-->
<!--                                <a href="#">-->
<!--                                    <span class="icon nc-icon-outline ui-1_circle-remove"></span> Xóa kết cuối-->
<!--                                </a>-->
<!--                                <a href="#">-->
<!--                                    <span class="icon -ap icon-info_outline"></span> Thuộc tính-->
<!--                                </a>-->
<!--                            </div>-->
<!--                            <div class="menu-context" style="top: 20%;left: 20%;">-->
<!--                                <a href="#">-->
<!--                                    <span class="icon nc-icon-outline ui-1_simple-add"></span> Thêm điểm uốn-->
<!--                                </a>-->
<!--                                <a href="#">-->
<!--                                    <span class="icon one-trash"></span> Xóa toàn bộ điểm uốn-->
<!--                                </a>-->
<!--                                <a href="#">-->
<!--                                    <span class="icon one-td-journey"></span> Chèn kết cuối-->
<!--                                </a>-->
<!--                                <a href="#">-->
<!--                                    <span class="icon one-td-usb"></span> Chi tiết đầu nối-->
<!--                                </a>-->
<!--                                <div class="item">-->
<!--                                    <a href="#">-->
<!--                                        <span class="icon one-td-arrow-change"></span>Chuyển kiểu cáp...-->
<!--                                    </a>-->
<!--                                </div>-->
<!--                                <div class="item">-->
<!--                                    <a href="#">-->
<!--                                        <span class="icon one-td-journey1"></span> Chuyển kiểu đi cáp...-->
<!--                                    </a>-->
<!--                                    <div class="menu-child">-->
<!--                                        <a href="#">-->
<!--                                            <span class="icon one-td-line"></span> Kéo cổng-->
<!--                                        </a>-->
<!--                                        <a href="#">-->
<!--                                            <span class="icon one-td-line2"></span> Kéo treo-->
<!--                                        </a>-->
<!--                                        <a href="#">-->
<!--                                            <span class="icon one-td-line3"></span> Chôn-->
<!--                                        </a>-->
<!--                                        <a href="#">-->
<!--                                            <span class="icon one-td-line4"></span> Đề xuất kéo mới-->
<!--                                        </a>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                                <a href="#">-->
<!--                                    <span class="icon nc-icon-outline ui-1_circle-remove red"></span> Xóa cáp-->
<!--                                </a>-->
<!--                                <a href="#">-->
<!--                                    <span class="icon -ap icon-info_outline"></span> Thuộc tính-->
<!--                                </a>-->
<!--                            </div>-->
<!--                            <div class="menu-context" style="top: 40%;left: 60%;">-->

<!--                                <a href="#">-->
<!--                                    <span class="icon one-td-journey2"></span> Đấu nối thiết bị-->
<!--                                </a>-->
<!--                                <div class="item">-->
<!--                                    <a href="#">-->
<!--                                        <span class="icon nc-icon-outline ui-1_eye-17"></span>Đổi biểu tượng...-->
<!--                                    </a>-->
<!--                                    <div class="menu-child">-->
<!--                                        <a href="#">-->
<!--                                            <span class="icon one-td-host"></span> Host-->
<!--                                        </a>-->
<!--                                        <a href="#">-->
<!--                                            <span class="icon one-td-play2"></span> Trạm MSAN, RSU có BTS-->
<!--                                        </a>-->
<!--                                        <a href="#">-->
<!--                                            <span class="icon one-td-arrow-up"></span> Trạm MSAN, RSU không có BTS-->
<!--                                        </a>-->
<!--                                        <a href="#">-->
<!--                                            <span class="icon one-td-settings"></span> Trạm BTS-->
<!--                                        </a>-->
<!--                                    </div>-->
<!--                                </div>-->


<!--                                <a href="#">-->
<!--                                    <span class="icon one-chart-radar"></span> Đổi đánh dấu...-->
<!--                                </a>-->
<!--                                <a href="#">-->
<!--                                    <span class="icon nc-icon-outline arrows-1_tail-right"></span> Tạo cáp tới-->
<!--                                </a>-->
<!--                                <a href="#">-->
<!--                                    <span class="icon -ap icon-info_outline"></span> Thuộc tính-->
<!--                                </a>-->

<!--                            </div>-->
                            <div class="bss-1826-map-options">
                                <div class="list">
                                    <a href="javascript:void(0)" v-on:click="isSearch++" class="btn btn-second">
                                        <span class="one-search"></span>
                                    </a>
                                    <a href="javascript:void(0)" title="Ẩn/Hiện lưới" @click="this.btnShowHiddenGridLine" class="btn btn-second">
                                        <span class="one-td-app-outline"></span>
                                    </a>
                                </div>
                                <div class="list">
                                    <a v-show="this.isShowLayer" href="javascript:void(0)" title="Ẩn/Hiện đối tượng" @click="this.btnShowHiddenDoiTuong" :class="[isShowDoiTuong ? 'btn btn-second' : 'btn btn-second cancel']">
                                        <span>O</span>
                                    </a>
                                    <a v-show="this.isShowLayer" href="javascript:void(0)" title="Ẩn/Hiện liên kết" @click="this.btnShowHiddenLienKet" :class="[isShowLienKet ? 'btn btn-second' : 'btn btn-second cancel']">
                                        <span>L</span>
                                    </a>
                                    <a v-show="this.isShowLayer" href="javascript:void(0)" title="Ẩn/Hiện chữ" @click="this.btnShowHiddenTitle" :class="[isShowTitle ? 'btn btn-second' : 'btn btn-second cancel']">
                                        <span>T</span>
                                    </a>

                                    <a href="javascript:void(0)" title="Ẩn/Hiện Lớp" @click="btnShowHiddenLayer" class="btn btn-second">
                                        <span class="one-layer"></span>
                                    </a>
                                </div>
                            </div>
                            <div class="zoom-actions-bottom">
                                <a href="javascript:void(0)" class="btn btn-main" @click="zoomInGD">
                                    <span class="icon -ap icon-plus3"></span>
                                </a>
                                <a href="javascript:void(0)" class="btn btn-main" @click="zoomOutGD">
                                    <span class="icon -ap icon-minus3"></span>
                                </a>

                            </div>
<!--                            <div class="map-note">-->
<!--                                <p style="margin-bottom: 5px; margin-left: 30px;">   E02 - BTRO_QUSO [96] - 1300m</p>-->
<!--                                <p style="margin-bottom: 5px;"><span class="fw6">Cáp</span> Dự án: phát triển mạng cáp quang FTTC năm 2009 trên địa bàn đài viễn thông Lê Chân <span class="fw6">Đi từ Trạm thiết bị (BTRO)</span></p>-->
<!--                                <p style="margin-bottom: 5px;margin-left: 30px;">Mã TS: 4942.0003</p>-->
<!--                            </div>-->
            </div>
          </div>
          <div class="tab-pane" id="tabBanDo" v-show="!showtabGianDo">
            <div class="sitemap-chart-canvas relative" style="height: 910px;">
              <Gmap ref="BanDo" @diaGianDo_ObjectAdded="diaGianDo_ObjectAdded" @QLCapIsOk="QLCapIsOk"
                @SUA_THUOCTINH_KETCUOI="SUA_THUOCTINH_KETCUOI" @SUA_THUOCTINH_TRAM_TB="SUA_THUOCTINH_TRAM_TB"></Gmap>
              <div class="map-options">
                <a href="javascript:void(0)" class="image" @click="thaydoiMapType()">
                  <img
                    src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRp_6mkJlHX8nZiFY5S_9xYVIJPbmpTwi4dKA&usqp=CAU"
                    alt="">
                </a>
                <a href="javascript:void(0)" class="btn btn-second" @click="luuToaDoBanDo()">
                  <span class="one-save"></span>
                </a>
                <a href="javascript:void(0)" class="btn btn-second" @click="allowMoveNode()">
                  <span class="one-drag"></span>
                </a>
                <a href="javascript:void(0)" class="btn btn-second" :style="{'background-color': color}"
                  @click="onClickCmd(-1)">
                  <span class="one-dots"></span>
                </a>
                <div class="bss-1826-list">
                  <a href="javascript:void(0)" v-for="(item , index) in data.dsPHANCAP" :key="index"
                    class="btn btn-second" v-show="!cmd">
                    <span class="-ap  icon-controller-record" :style="{color : '#' + item.MAU}"
                      @click="onClickCmd(index)"></span>
                  </a>
                </div>
              </div>
              <div class="zoom-actions-bottom">
                <a href="#" class="btn btn-main">
                  <span class="icon -ap icon-plus3"></span>
                </a>
                <a href="#" class="btn btn-main">
                  <span class="icon -ap icon-minus3"></span>
                </a>
              </div>
            </div>
          </div>
        </div>
        <QLCap id="QLCap" :capObj="capObject" :taomoi="true" :editable="false" @isOk="QLCapIsOk"></QLCap>
        <XemTruocKhiIn id="popupXemTruocKhiIn"></XemTruocKhiIn>
      </SplitArea>
    </Split>
  </div>
</div>
