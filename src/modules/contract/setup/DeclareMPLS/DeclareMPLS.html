<div class="main-wrapper" @click="hideDropdownMenu">  
  <breadcrumb :header="header" />
  <div class="list-actions-top" style="position:relative;">
    <ul class="list" style="position: static;">
      <li class="cursor-pointer">
        <a @click="btnLayTTOnClick()" :class="controls.btnLayTTMoi.enabled  ? '' : 'disabled'">
          <span class="icon one-file-attach"></span> Lấy TT
        </a>
      </li>
      <li>
        <a @click.prevent="tsbtnChapNhan_Click" :class="controls.tsbtnChapNhan.enabled  ? '' : 'disabled'">
          <span class="icon one-reload1"></span> Cập nhật
        </a>
      </li>
      <li v-if="controls.tsbtnGiaoViec.visible" >
        <a @click="btnGiaoViecOnClick()"  :class="controls.tsbtnGiaoViec.enabled  ? '' : 'disabled'">
          <span class="icon one-file-arrow-right1"></span>
          Giao việc
        </a>
      </li>
      
      <li v-if="controls.tsbtnGiaoPhieu.visible" >
        <a :class="controls.tsbtnGiaoPhieu.enabled  ? '' : 'disabled'" @click="tsbtnGiaoPhieu_Click()">
          <span class="icon one-file-arrow-right1"></span>
          Giao phiếu
        </a>
      </li>
      <li style="position: static;" class="dropdown" @click="xuatPhieuShow = !xuatPhieuShow"> <!-- class="dropdown" @click="xuatPhieuShow = !xuatPhieuShow"  -->
        <a href="javascript:;" ref="xuatphieu"> 
          <span class="icon one-file-arrow-right1"></span>Xuất phiếu
          <svg width="16" height="16" class="h-8 w-8 text-blue-500" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6 9 12 15 18 9" />
          </svg>
        </a>
        <ul v-show="xuatPhieuShow" class="ui-xuat-phieu">
          <li class="xuat-phieu" style="padding: 10px 10px 10px 10px;"><a href="javascript:;" @click.prevent="btnPhieuTC_Click"
              style="color: #007bff; text-decoration: none"> <span class="icon one-file-arrow-right1"></span>Phiếu thi công</a>
          </li>
          <li class="xuat-phieu" style="padding: 10px 10px 10px 10px;"><a href="javascript:;" @click.prevent="btnBienBanNT_Click"
              style="color: #007bff;text-decoration: none"><span class="icon one-file-arrow-right1"></span>In phiếu</a>
          </li>
        </ul>
      </li>
      <li  v-if="controls.tsbtnHoanCong.visible">
        <a  @click="tsbtnHoanCong_Click()"
          :class="controls.tsbtnHoanCong.enabled  ? '' : 'disabled'">
          <span class="icon one-hoancong"></span>
          Hoàn công
        </a>
      </li>

      <li v-if="controls.tsbtnTraPhieu.visible"> 
        <a @click.prevent="tsbtnTraPhieu_Click" :class="controls.tsbtnTraPhieu.enabled  ? '' : 'disabled'">
          <span class="icon one-file-back"></span>
          Trả phiếu
        </a>
      </li>
      <li  v-if="controls.tsbtnVatTu.visible"> 
        <a @click="tsbtnVatTu_Click" :class="controls.tsbtnVatTu.enabled  ? '' : 'disabled'">
          <span class="icon one-vt"></span> Vật tư
        </a>
      </li>
       
      <li  v-if="controls.tsbtnHen.visible">
        <a @click="btnHenKHOnClick()" :class="controls.tsbtnHen.enabled  ? '' : 'disabled'">
          <span class="icon one-henld"></span>
          Hẹn LĐ
        </a>
      </li>

      <li v-if="controls.tsbtnDauNoiCap.visible">
        <a @click.stop="tsbtnDauNoiCap_Click()" :class="controls.tsbtnDauNoiCap.enabled  ? '' : 'disabled'">
          <span class="icon one-connect"></span>
          Đấu nối
        </a>
      </li>
      <li v-if="controls.tsbtnHoanThanh.visible">
        <a  @click="tsbtnHoanThanh_Click()"
          :class="controls.tsbtnHoanThanh.enabled  ? '' : 'disabled'">
          <span class="dropdown-icon one-file-check"></span>
          Hoàn thành
        </a>  
      </li>
      <li v-if="controls.tsbtnHoanThienHS.visible">
        <a  @click="btnHoanThien()"
          :class="controls.tsbtnHoanThienHS.enabled  ? '' : 'disabled'">
          <span class="dropdown-icon one-file-check"></span>
          Hoàn thiện
        </a>  
      </li>
      <li  v-if="controls.tsbtnHuy_HC.visible">
        <a @click="tsbtnHuy_HC_Click()" :class="controls.tsbtnHuy_HC.enabled  ? '' : 'disabled'">
          <span class="icon one-file-arrow-right1"></span>
          Hủy hoàn công
        </a>
      </li>

      
    </ul>
    <div class="more dropdown">
      <a href="#" @click.prevent="setDisplayDropDownMenu">
        <span ref="mainWrap" class="icon -ap  icon-dots-three-vertical"></span>
      </a>
      <div v-if="isDisplayMenu" class="dropdown-menu ovauto d-block" style="max-height: 300px;"> 
        <a v-if="controls.tsbtnNVKT.visible" href="javascript:;" v-on:click="tsbtnNVKT_Click" :class="{'disabled':(!controls.tsbtnNVKT.enabled)}">
          <span class="dropdown-icon -ap icon-pin"></span> Gán KV
        </a>  
        <a v-if="controls.tsbtnVatTuMoi.visible" @click="tsbtnVatTuMoi_Click()"
          :class="controls.tsbtnVatTuMoi.enabled  ? '' : 'disabled'">
          <span class="dropdown-icon one-vt"></span>
          Vật tư
        </a>   
        <a v-if="controls.tsbtnGiaoPhieu_KBB.visible" @click="btnGiaoViecOnClick()"
          :class="controls.tsbtnGiaoPhieu_KBB.enabled  ? '' : 'disabled'">
          <span class="dropdown-icon one-file-arrow-right1"></span>
          Giao việc KKB
        </a>  
        <a v-if="controls.tsbtnDuAn.visible" @click="tsbtnDuAn_Click()"
          :class="controls.tsbtnDuAn.enabled  ? '' : 'disabled'">
          <span class="dropdown-icon one-clipart-edit"></span>
          Dự án
        </a>  
        <a v-if="controls.tsbtnThongTinKT.visible" href="#" @click.prevent="tsbtnThongTinKT_Click()" :class="controls.tsbtnThongTinKT.enabled  ? '' : 'disabled'">
          <span class="dropdown-icon one-file-arrow-right1"></span>
          Thông số KT
        </a>  
        <a v-if="controls.tsbtnKQ_DoKiem.visible" @click="btnDoKiemOnClick()" :class="controls.tsbtnKQ_DoKiem.enabled  ? '' : 'disabled'">
          <span class="dropdown-icon nc-icon-glyph design_design"></span>
          Đo kiểm
        </a>  
        <a v-if="controls.tsbtnChuyenTo.visible" @click="tsbtnChuyenTo_Click()" :class="controls.tsbtnChuyenTo.enabled  ? '' : 'disabled'">
          <span class="dropdown-icon one-change"></span>
          Chuyển tổ
        </a>  
        <a v-if="controls.tsbtnSua_KenhThu.visible" @click="btnGiaoPhieuOnClick()"
          :class="controls.tsbtnSua_KenhThu.enabled  ? '' : 'disabled'">
          <span class="dropdown-icon nc-icon-glyph ui-1_edit-74"></span>
          Sửa kênh thu
        </a>  
        <a v-if="controls.tsbtnGiaoPhieu_Ton.visible" @click="tsbtnGiaoPhieu_Ton_Click()" :class="controls.tsbtnGiaoPhieu_Ton.enabled  ? '' : 'disabled'">
          <span class="dropdown-icon one-calendar-number"></span>
          Tồn phiếu
        </a>
       
      </div> 
    </div>
  </div>
  <div class="page-content .declare-mpls">
    <ThongTinChung :formProps="form_ThongTinChung" :options="options_thongTinChung"></ThongTinChung>
    <div class="row">
      <div class="col-12 col-lg-6 ">
        <ThongTinKhachHang v-if="isDisplayThongTin" ref="ThongTinKhachHang"
          @on-enter="onEnter()" :formProps="form_ThongTinKhachHang"
          @my-account="myAccount" :visible="isVisibleThongTin" @is-visible="handVisibleThongTin"
          :options="options_ThongTinKhachHang"></ThongTinKhachHang>
      </div>
      <div class="col-12 col-lg-6 ">
        <ThongTinGiaoViec v-if="isDisplayThongTin" ref="ThongTinGiaoViec" :visible="isVisibleThongTin"
          :formProps="form_ThongTinGiaoViec" :options="options_ThongTinGiaoViec">
        </ThongTinGiaoViec>
      </div>
    </div>
    <div class="box-form">
      <div class="legend-title">
        <span class="icon fa" :class="isVisibleThongTinHoanCong ? 'fa-angle-up' : 'fa-angle-down'"
          @click="isVisibleThongTinHoanCong = !isVisibleThongTinHoanCong"></span>
        Thông tin hoàn công
      </div>
      <div class="row" v-show="isVisibleThongTinHoanCong">
        <div class="col-12 col-lg-6 ">
          <ThongTinHoanCong_DD :formProps="form_ThongTinHoanCong_DD" :controls="controls" :options="options_ThongTinHoanCong_DD"
            ref="tableDD" @display-table="setDisplayTableDD" @btnNDTHOnClick="btnNDTHOnClick" @onCapNhatPortDau="onCapNhatPortDau">
          </ThongTinHoanCong_DD>
        </div>
        <div class="col-12 col-lg-6 ">
          <ThongTinHoanCong_DC :formProps="form_ThongTinHoanCong_DC" :controls="controls" :options="options_ThongTinHoanCong_DC"
            ref="tableDC" @display-table="setDisplayTableDC" @onCapNhatPortCuoi="onCapNhatPortCuoi">
          </ThongTinHoanCong_DC>
        </div>
      </div>
    </div>

    <DanhSachThueBao :formProps="form_DanhSachThueBao" :controls="controls" @onSelectedRow="rowSelected" @onSelectedMultiRows="onSelectedMultiRows"></DanhSachThueBao>
    <div>

    <TonPhieu ref="tonPhieuGiaoModal" :phieuId="Number(form_ThongTinKhachHang.phieu_id)" :trangthaiId="h_tthd_id" /> 
    <DoKiemModal ref="doKiem" :hdtb_id="Number(form_ThongTinKhachHang.hdtb_id)" :baohong_id="0" />  
    <PopupThongTinHenKhachHang :hdkh_id="+form_ThongTinKhachHang.hdkh_id" ref="popupThongTinHenKH" />
    <VatTuThueBao ref="popupVatTuThueBao" :input-data="modelVatTu"/>
    <CapVatTuTB ref="popupCapVatTuTB" :input-data="modelVatTu"/> 
 
    <ChuyenTo ref="popupChuyenTo"></ChuyenTo>
		<ejs-dialog :enableResize='true' :visible="false" ref="thayDoiKenhThu"
		      :header='"Sửa kênh thu"'
		      :allowDragging="true"
		      showCloseIcon=true
		      animationSettings="animationSettings"
		      :position="{ X: 'center', Y: 'top' }" 
		      width='80%'
		      height="800">
		  <ThayDoiKenhThu :ma_gd="form_ThongTinKhachHang.txtMaGD" :magd="form_ThongTinKhachHang.txtMaGD"/>
		</ejs-dialog>
    <TraCuuThongSoKTModal ref="popupTraCuuThongSoKTModal" :kieu="1"  :dichvuvt_id="form_ThongTinKhachHang.dichvuvt_id*1" :hdtb_id="form_ThongTinKhachHang.hdtb_id*1" :thuebao_id="form_ThongTinKhachHang.thuebao_id*1" :ma_tb="form_ThongTinKhachHang.txtMaTB"/>
    <DuAnHDTB ref="popupDuAnHDTB" :vhdtb_id="form_ThongTinKhachHang.hdtb_id*1"/>
    <InBienBan ref="popupInBB" :params="modelIn"/>
    <ThayDoiKhuVucQuanLyThueBaoModal ref="thayDoiKhuVucQuanLyThueBaoModal" :data="dataPopupKhuVuc" :daucuoi_id="daucuoi_id" @success_update="ThayDoiKhuVucQuanLyThueBao_success_update"/>

     
    <!-- <ejs-dialog :enableResize='true' :visible="false" ref="popupFrmTraPhieuTC"
    :header='"Trả phiếu nhân viên"' showCloseIcon=true :target="target" width='85%' height="800">
      <frmTraPhieuTC ref="frmTraPhieuTC" />
    </ejs-dialog> -->
     
    <!-- <ejs-dialog :enableResize='true' :visible="false" ref="popupfrnGiaoPhieuNV" :header='"Giao phiếu nhân viên"'
      showCloseIcon=true target=".main-wrapper" width='85%' height="800">
      <frnGiaoPhieuNV ref="frnGiaoPhieuNV" @giaoviec_success="giaoviec_success" />
    </ejs-dialog> -->

    <b-modal id="popupComponentsMPLS" 
      body-class="none-padding"
      size="hosodientu-size"
      ref="hosodientu"
      :title="state.modalTitle"
      hide-footer>
      <component :is="popupComponent" ref="generalPopupMPLS" :dulieu="popupComponentData" v-bind="popupComponentAttr" :ispopup="true" isPopup="false" :isPopup="false" v-on="popupComponentEvts"></component> <!--v-dynamic-events="popupComponentEvents"-->
    </b-modal>

    <ejs-dialog :enableResize='true' :isModal="true" :allowDragging="true" :visible="false" ref="generalDialog" :header="state.modalTitle" :position="position"
         showCloseIcon=true target=".main-wrapper" :closeOnEscape="true" width="90%" height="800" v-on="dialogEvts">  <!--:overlayClick="overlayClick" -->
        <div>
          <component :is="dialogComponent" ref="generalComponent" :data="popupComponentData" v-bind="popupComponentAttr" :isPopup="true" v-on="popupComponentEvts"></component>
        </div>
    </ejs-dialog>
    <div>
      <component :is="modalComponent" ref="modalComponent" :data="popupComponentData" v-bind="popupComponentAttr" :isPopup="true" v-on="popupComponentEvts"></component>
    </div>
	</div>

  </div>
  <ejs-dialog
    :isModal="true"
    :enableResize="true"
    :resizeHandles="['All']"
    :visible="false"
    ref="GiaoPhieuView"
    :header='"Giao phiếu điều hành thi công"'
    showCloseIcon="true"
    target=".main-wrapper"
    width="90%"
    allowDragging="true"
    :animationSettings="animationSettings"
    @close="GiaoPhieuView_OnClose"
  >
    <div>
      <GiaoPhieuView v-if="giaoPhieuViewDialog.isVisiable" type="modal"  v-bind="giaoPhieuViewDialog.input" @onGiaoPhieuSuccessListener="giaophieu_success" />
    </div>
  </ejs-dialog>
</div>
  

</div>
