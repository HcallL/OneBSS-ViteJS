<div class="main-wrapper">
    <breadcrumb :header="header" />
    <div class="list-actions-top">
        <ul class="list">
            <li v-if="iKieu == 1" title="Sửa thông tin khuyến mại và đặt cọc">
                <a href="#" @click.prevent="tsbtnSuaKM_Click" title="Sửa thông tin khuyến mại và đặt cọc">
                    <span class="icon one-save"></span>Sửa KM
                </a>
            </li>
            <li v-if="iKieu == 1">
                <a href="#" @click.prevent="btnUser_Click" title="User">
                    <span class="dropdown-icon nc-icon-glyph users_single-01"></span> User
                </a>
            </li>
            <li v-if="iKieu == 1">
                <a href="#" @click.prevent="ThuebaoToaNha_OnClick" title="Gán thuê bao vào tòa nhà">
                    <span class="dropdown-icon one-building"></span> Tòa nhà
                </a>
            </li>
            <li v-if="iKieu == 1" title="Đăng ký trả trước">
                <a href="#" @click.prevent="btnTraTruoc_click">
                    <span class="dropdown-icon one-card"></span> Trả trước
                </a>
            </li>
            <li v-if="iKieu == 1" title="Đăng ký trả trước">
                <a href="#" @click.prevent="btnTraTruocV2_click">
                    <span class="dropdown-icon one-card"></span> Trả trước_v2
                </a>
            </li>
            <li v-if="iKieu == 1" title="Xem trước CA">
                <a href="#" @click.prevent="XemTruocThongTinCAToken_Click">
                    <span class="dropdown-icon one-building"></span> Xem trước CA
                </a>
            </li>
            <li v-if="iKieu == 1" title="Chọn thiết bị">
                <a href="#" @click.prevent="DangXayDung">
                    <span class="dropdown-icon one-building"></span> Chọn thiết bị
                </a>
            </li>
            <li v-if="iKieu != 1" title="Nhập mới hợp đồng">
                <a href="#" @click.prevent="buttonSet=1" :class="{disabled:!buttons.tsbtnNhapMoi}">
                    <span class="icon one-file-plus"></span>Nhập mới
                </a>
            </li>
            <li v-if="iKieu != 1" title="Ghi lại thông tin hợp đồng">
                <a href="#" @click.prevent="SaveClicked" :class="{disabled:!buttons.tsbtnGhiLai}">
                    <span class="icon one-save"></span>Ghi lại
                </a>
            </li>
            <li v-if="iKieu != 1" title="Hủy">
                <a href="#" @click.prevent="buttonSet=0" :class="{disabled:!buttons.tsbtnHuyBo}">
                    <span class="icon nc-icon-glyph ui-1_circle-remove"></span>Hủy
                </a>
            </li>
            <li v-if="iKieu != 1" title="Xóa hợp đồng">
                <a href="#" :class="{disabled:!buttons.tsbtnXoa}" @click.prevent="tsbtnXoa_Click">
                    <span class="icon one-trash"></span>Xóa HĐ
                </a>
            </li>
            <li v-if="iKieu != 1" title="In hồ sơ">
                <a href="#" @click.prevent="btnHoSo_Click">
                    <span class="icon nc-icon-glyph files_single-content-02"></span>Hồ sơ
                </a>
            </li>
            <li v-if="iKieu != 1" title="Thanh toán hợp đồng">
                <a href="#" :class="{'disabled':!buttons.tsbtnThanhToan && !khachhang.magd}" @click.prevent="tsbtnThanhToan_Click">
                    <span class="icon nc-icon-glyph shopping_credit-card"></span>Thanh toán
                </a>
            </li>
            <li v-if="iKieu != 1" title="Thêm thanh toán (Hóa đơn)">
                <a href="#" :class="{disabled:!buttons.tsbtnThemTT}" @click.prevent="ThemHDThanhToan">
                    <span class="icon one-mobile-plus"></span>Thêm TT
                </a>
            </li>
            <li v-if="iKieu != 1" title="Xóa thanh toán">
                <a href="#" :class="{disabled:!buttons.tsbtnXoaTT}" @click.prevent="tsbtnXoaTT_Click">
                    <span class="icon one-phone-remove"></span>Xóa TT
                </a>
            </li>
            <li v-if="iKieu != 1" title="Thêm thuê bao">
                <a href="#" :class="{disabled:(buttonSet!=3 && !buttons.tsbtnThemTB) || (listbox.dichvu_vt.value==DichVuVienThong.DI_DONG && listbox.loaihinh_tb.value==LoaiHinhTB.HoaMangChuyenTinh)}" @click.prevent="tsbtnThemTB_Click">
                    <span class="icon one-mobile-plus"></span>Thêm TB
                </a>
            </li>
            <li v-if="iKieu != 1" title="Xóa thuê bao">
                <a href="#" :class="{disabled:buttonSet!=3 && !buttons.tsbtnXoaTB}" @click.prevent="tsbtnXoaTB_Click">
                    <span class="icon one-phone-remove"></span>Xóa TB
                </a>
            </li>
            <li v-if="iKieu != 1" title="Chăm sóc khách hàng">
                <a href="#" @click.prevent="DangXayDung">
                    <span class="icon nc-icon-glyph location_position-user"></span>Chăm sóc KH
                </a>
            </li>
        </ul>
        <div class="more dropdown" v-if="iKieu != 1">
            <a href="javascript:void(0);" data-toggle="dropdown">
                <span class="icon -ap  icon-dots-three-vertical"></span>
            </a>
            <div class="dropdown-menu">
                <a href="#" @click.prevent="btnOpenfrmDangKyGoiDaDVLM" title="Đăng ký gói đa dịch vụ">
                    <span class="dropdown-icon one-file-edit"></span> Gói đa DV
                </a>
                <a href="#" @click.prevent="btnTraTruoc_click" title="Đăng ký trả trước">
                    <span class="dropdown-icon one-card"></span> Trả trước
                </a>
                <a href="#" @click.prevent="btnTraTruocV2_click" title="Đăng ký trả trước_v2">
                    <span class="dropdown-icon one-card"></span> Trả trước_v2
                </a>
                <a href="#" @click.prevent="ShowContractOwner" :class="{disabled:!khachhang.hdkh_id && !khachhang.khachhang_id}" title="Thông tin liên hệ">
                    <span class="dropdown-icon nc-icon-glyph business_contacts"></span> Liên hệ
                </a>
                <a href="#" @click.prevent="tsbtnEmail_Click" title="Email">
                    <span class="dropdown-icon one-email"></span> Email
                </a>
                <a href="#" @click.prevent="btnHenLD_Click" title="Hẹn lắp đặt">
                    <span class="dropdown-icon one-henld"></span> Hẹn LĐ
                </a>
                <a href="#" @click.prevent="btnUser_Click" title="User">
                    <span class="dropdown-icon nc-icon-glyph users_single-01"></span> User
                </a>
                <a href="#" @click.prevent="tsbtnToaNha_Click" title="Gán thuê bao vào tòa nhà">
                    <span class="dropdown-icon one-building"></span> Tòa nhà
                </a>
                <a  href="#" @click.prevent="tsbtnImportCA_Click" title="Import CA" :class="{disabled:(!khachhang.hdkh_id || !khachhang.magd)}">
                    <span class="dropdown-icon one-card"></span> Import CA
                </a>
                <a  href="#" v-if="thamsomacdinh && thamsomacdinh['GUI_YEUCAU_PHEDUYET_TTTT_KH']==1" @click.prevent="tsbtnRequestChange_Click" title="Yêu cầu thay đổi thông tin" :class="{disabled:!isEditKH}">
                    <span class="dropdown-icon nc-icon-glyph business_contacts"></span> Yêu cầu thay đổi TT
                </a>
                <!-- <a  href="#" @click.prevent="tsbtnApproveChange_Click" title="Phê duyệt thay đổi thông tin" :class="{disabled:!isEditKH}">
                    <span class="dropdown-icon one-henld"></span> Phê duyệt thay đổi TT
                </a> -->
            </div>
        </div>
    </div>
    <div class="page-content">
        <div class="box-form padt8 padb8">
            <div class="row">

                <div class="col-sm-2 col-12">

                </div>
                <div class="col-sm-2 col-12">
                    <div class="info-row marb0">
                        <div class="key w30 nowrap fw6">
                            Mã dự án
                        </div>
                        <div class="value">
                            <input type="text" class="form-control"  :value="maduan" @change="v=>maduan=v.target.value">
                            <!-- <button @click="Test">+</button>
                            <button @click="Done">-</button> -->
                        </div>
                    </div>
                </div>
                <div class="col-sm-2 col-12">
                    <div class="info-row marb0">
                        <div class="key w30 nowrap fw6">
                            Kiểu hợp đồng / PL
                        </div>
                        <div class="value">
                            <select2 v-model="listbox.kieu_hd.value" class="select-custom" :options="listbox.kieu_hd.list.map(hd=>({id:hd.kieuhd_id,text:hd.kieu_hd}))"></select2>
                        </div>
                    </div>
                </div>
                <div class="col-sm-2 col-12">
                    <div class="info-row marb0">
                        <div class="key w30 nowrap fw6">
                            <div class="check-action" title="Tích chọn để tìm kiếm cộng tác viên">
                                <input type="checkbox" class="check" v-model="filterbox.ctv.ischecked" @change="ShowPopupCTV()">
                                <span class="name">Cộng tác viên</span>
                            </div>
                        </div>
                        <div class="value" :class="{disabled:!filterbox.ctv.ischecked}">
                            <input type="text" class="form-control"  :value="filterbox.ctv.value" @change="v=>filterbox.ctv.value=v.target.value" required title="Bạn chưa chọn nhân viên phát triển!">
                        </div>
                    </div>
                </div>
                <div class="col-sm-2 col-12">
                    <div class="info-row marb0">
                        <div class="key w30 nowrap fw6">
                            <div class="check-action">
                                <input type="checkbox" class="check" v-model="filterbox.nguoigt.ischecked" @change="ShowPopupNguoiGT()">
                                <span class="name">Người giới thiệu</span>
                            </div>
                        </div>
                        <div class="value" :class="{disabled:!filterbox.nguoigt.ischecked}">
                            <input type="text" class="form-control"  :value="filterbox.nguoigt.value" @change="v=>filterbox.nguoigt.value=v.target.value">
                        </div>
                    </div>
                </div>
                <div class="col-sm-2 col-12">
                    <div class="info-row marb0">
                        <div class="key w30 nowrap fw6">
                            Tổng tiền
                        </div>
                        <div class="value disabled">
                            <vue-numeric class="form-control tright tongtien" separator="." decimal-separator="," :precision="is_nv_vnpti==1?2:0" v-model="tongtienhd" placeholder="0" output-type="Number"></vue-numeric>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="nav tabs tab-over">
            <a href="#tab1" ref="tab1" data-toggle="tab" class="active" @click="currentTab='tab1'">Khách hàng (F2)</a>
            <a href="#tab2" ref="tab2" data-toggle="tab" @click="currentTab='tab2'">Thuê bao (F3)</a>
        </div>
        <div class="tab-content nocorner bor0 pad0 bg-none" style="box-shadow: none;">
            <div id="tab1" class="tab-pane active">
                <div class="tab-content" v-if="currentTab!='tab2'">
                    <div class="box marb20">
                        <div class="legend-title">Thông tin khách hàng</div>
                        <div class="row">
                            <div class="col-sm-6 col-12">
                                <div class="row">
                                    <div class="col-sm-7 col-12">
                                        <div class="info-row">
                                            <div class="key w120">Mã giao dịch</div>
                                            <div class="value">
                                                <div class="input-more-button">
                                                    <button class="btn" @click.prevent="showPopupSearchContract" title="Tìm kiếm thông tin giao dịch">
                                                        <span class="-ap icon-more_horiz"></span>
                                                    </button>
                                                    <SearchContractModal ref="popupSearchContract" @accept="acceptSearchContract" :loai_hd_id="1" :dichvuvt_id="listbox.dichvu_vt.value*1"  :trangthai_hd="1" :nhanvienId="nhanvienId" :donviId="donViId" />
                                                    
                                                    <input type="text" class="form-control highlight"  :value="khachhang.magd" @change="v=>khachhang.magd=v.target.value" @keypress.enter="MaGDChanged">
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-sm-5 col-12">
                                        <div class="info-row">
                                            <div class="key">Ngày yêu cầu</div>
                                            <div class="value">
                                                <div class="input-icon-right disabled">
                                                    <date-picker input-class="form-control" :format="dateFormat" :value-type="datetimeFormatFull" v-model="NgayYeuCau"></date-picker>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-7 col-12">
                                        <div class="info-row">
                                            <div class="key w120">Mã hợp đồng (*)</div>
                                            <div class="value">
                                                <input type="text" class="form-control" :value="khachhang.mahd" @change="v=>{khachhang.mahd=v.target.value}">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-5 col-12">
                                        <div class="info-row">
                                            <div class="key">Ngày lập HĐ</div>
                                            <div class="value">
                                                <div class="input-icon-right">
                                                    <div class="input-icon-right disabled">
                                                        <date-picker input-class="form-control" :format="dateFormat" :value-type="datetimeFormatFull" v-model="NgayLapHD"></date-picker>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-7 col-12">
                                        <div class="info-row">
                                            <div class="key w120">Mã KH (*)</div>
                                            <div class="value">
                                                <div class="input-more-button">
                                                    <button class="btn" @click.prevent="ShowSearchAccount" title="Tìm kiếm thông tin khách hàng">
                                                        <span class="-ap icon-more_horiz"></span>
                                                    </button>
                                                    <input type="text" class="form-control highlight"  :value="khachhang.makh" @change="v=>khachhang.makh=v.target.value" @keypress.enter="MaKHChanged">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-5 col-12">
                                        <div class="info-row">
                                            <div class="key"></div>
                                            <div class="value"><!-- :class="{disabled:!buttons.btnThongTinKhac}" -->
                                                <button class="btn btn-second fullw" @click="btnThongTinKhacClick">Thông tin khác</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="info-row">
                                    <div class="key w120">Tên khách hàng (*)</div>
                                    <div class="value" :class="{disabled:isEditKH}">
                                        <input type="text" class="form-control" :value="khachhang.tenkh" @change="tenKHChanged" required title='Bạn chưa nhập tên khách hàng!'>
                                    </div>
                                </div>
                                <div class="info-row">
                                    <div class="key w120">Địa chỉ KH (*)</div>
                                    <div class="value">
                                        <div class="input-more-button">
                                            <button class="btn" v-b-modal.popupDiaChiKH title="Chọn địa chỉ khách hàng">
                                                <span class="-ap icon-more_horiz"></span>
                                            </button>

                                            <ModalChonDiaChi modalId="popupDiaChiKH" :data="diachiKH" :isStrictMode="true" @xacnhan="getDiaChiKH"/>
                                            <bss-error-marker :has-error="$v.diachiKH.DIACHI.$error">
                                                <input type="text" v-model="$v.diachiKH.DIACHI.$model" class="form-control" @change="diachiKHChanged" required title="Bạn chưa nhập địa chỉ khách hàng">
                                            </bss-error-marker>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-7 col-12">
                                        <div class="info-row">
                                            <div class="key w120">Loại GT (*)</div>
                                            <div class="value">
                                                <select2 v-model="listbox.loai_gt.value" class="select-custom" :options="listbox.loai_gt.list.map(gt=>({id:gt.loaigt_id,text:gt.loai_gt}))"></select2>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-5 col-12">
                                        <div class="info-row">
                                            <div class="key">Số GT (*)</div>
                                            <div class="value" :class="{disabled:isEditKH}">
                                                <input type="text" class="form-control"  :value="khachhang.sogt" @change="v=>{ khachhang.sogt=v.target.value; KiemTraSoGT(); }" required pattern="^[a-zA-Z0-9\-_\s]+$" title="Số giấy tờ gồm các ký tự từ 0->9a->z.">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-7 col-12">
                                        <div class="info-row">
                                            <div class="key w120">Ngày cấp (*)</div>
                                            <div class="value">
                                                <div class="input-icon-right">
                                                    <date-picker input-class="form-control" :format="dateFormat" :value-type="datetimeFormatFull" v-model="NgayCap" :input-attr="{required: 'true', title: 'Bạn chưa nhập thông tin ngày cấp!'}"></date-picker>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-5 col-12">
                                        <div class="info-row">
                                            <div class="key">Nơi cấp</div>
                                            <div class="value">
                                                <input type="text" class="form-control"  :value="khachhang.noicap" @change="v=>khachhang.noicap=v.target.value">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-7 col-12">
                                        <div class="info-row">
                                            <div class="key w120">Ngày hết hạn</div>
                                            <div class="value">
                                                <div class="input-icon-right">
                                                    <date-picker input-class="form-control" :format="dateFormat" :value-type="datetimeFormatFull" v-model="NgayHH"></date-picker>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-5 col-12">
                                        <div class="info-row">
                                            <div class="key">Ngày sinh/TL (*)</div>
                                            <div class="value">
                                                <div class="input-icon-right">
                                                    <date-picker input-class="form-control" :format="dateFormat" :value-type="datetimeFormatFull" v-model="NgaySinh" @change="ngaySinhChanged" :input-attr="{required: 'true', title: 'Bạn chưa nhập thông tin ngày sinh/TL!'}"></date-picker>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-7 col-12">
                                        <div class="info-row">
                                            <div class="key w120">Giới tính</div>
                                            <div class="value">
                                                <div class="list-checks mart7">
                                                    <div class="item">
                                                        <div class="check-action" :class="{disabled:!buttons.btnThongTinKhac}">
                                                            <input type="radio" class="check" value="-1" v-model="khachhang.gioitinh">
                                                            <span class="name">Không</span>
                                                        </div>
                                                    </div>
                                                    <div class="item">
                                                        <div class="check-action">
                                                            <input type="radio" class="check" value="0" v-model="khachhang.gioitinh">
                                                            <span class="name">Nam</span>
                                                        </div>
                                                    </div>
                                                    <div class="item">
                                                        <div class="check-action">
                                                            <input type="radio" class="check" value="1" v-model="khachhang.gioitinh">
                                                            <span class="name">Nữ</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-5 col-12">
                                        <div class="info-row">
                                            <div class="key">Quốc tịch</div>
                                            <div class="value">
                                                <!-- <select2 v-model="listbox.quoctich.value" class="select-custom" :options="listbox.quoctich.list.map(x=>({id:x.quoctich_id,text:x.tenquoctich}))"></select2> -->
                                                <ComboboxGrid2  class="select-custom"
                                                    :columns="[
                                                    {fieldName: 'tenquoctich', headerText: '', allowFiltering: true, width:'300'},
                                                    ]"
                                                    :dataSource="listbox.quoctich.list" textField="tenquoctich" valueField="quoctich_id"
                                                    :enabledSelectFirstRow="false" :value="listbox.quoctich.value"
                                                    @selectedChanged="(item)=>{if(item) { listbox.quoctich.value=item.quoctich_id; }}">
                                                </ComboboxGrid2>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-7 col-12">
                                        <div class="info-row">
                                            <div class="key w120">Ngành nghề</div>
                                            <div class="value">
                                                <div class="input-more-button">
                                                    <button class="btn" @click.prevent="popupTieuNganh" title="Chọn chi tiết ngành nghề">
                                                        <span class="-ap icon-more_horiz"></span>
                                                    </button>
                                                    <ComboboxGrid2  class="select-custom"
                                                        :columns="[
                                                        {fieldName: 'tennganhnghe', headerText: '', allowFiltering: true, width:'300'},
                                                        {fieldName: 'manganh', headerText: '', allowFiltering: true, width:'70'},
                                                        {fieldName: 'nganhnghe_id', headerText: '', allowFiltering: true, width:'0'}
                                                        ]"
                                                        :dataSource="listbox.nganhngheloc.list" textField="tennganhnghe" valueField="nganhnghe_id"
                                                        :enabledSelectFirstRow="false" :value="listbox.nganhngheloc.value"
                                                        @selectedChanged="(item)=>{if(item) { listbox.nganhngheloc.value=item.nganhnghe_id;popupTieuNganh();}}">
                                                    </ComboboxGrid2>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-5 col-12">
                                        <div class="info-row">
                                            <div class="key">Dân tộc</div>
                                            <div class="value">
                                                <!-- <select2 v-model="listbox.dantoc.value" class="select-custom" :options="listbox.dantoc.list.map(dt=>({id:dt.dantoc_id,text:dt.tendantoc}))"></select2> -->
                                                <ComboboxGrid2  class="select-custom"
                                                    :columns="[
                                                    {fieldName: 'tendantoc', headerText: '', allowFiltering: true, width:'300'},
                                                    ]"
                                                    :dataSource="listbox.dantoc.list" textField="tendantoc" valueField="dantoc_id"
                                                    :enabledSelectFirstRow="false" :value="listbox.dantoc.value"
                                                    @selectedChanged="(item)=>{if(item) { listbox.dantoc.value=item.dantoc_id; }}">
                                                </ComboboxGrid2>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6 col-12">
                                <div class="row">
                                    <div class="col-sm-7 col-12">
                                        <div class="info-row">
                                            <div class="key w120">Loại KH (*)</div>
                                            <div class="value">
                                                <treeselect v-model="listbox.loai_kh.value" :multiple="false" :options="loai_kh_tree" :disable-branch-nodes="true" :required="true" @select="loaikhChanged" title="Loại KH bắt buộc chọn!" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-5 col-12">
                                        <div class="info-row">
                                            <div class="key w90">{{ ht_khl==1?'KH lớn':'PL KH'}}</div>
                                            <div class="value">
                                                <input type="text" class="form-control disabled" v-if="ht_khl!=1"  :value="khachhang.plkh" @change="v=>khachhang.plkh=v.target.value" />
                                                <select2 v-model="listbox.loai_khl.value" class="select-custom" :options="listbox.loai_khl.list.map(kh=>({id:kh.khlon_id,text:kh.ten_lkhl}))" v-if="ht_khl==1"></select2>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-7 col-12">
                                        <div class="info-row">
                                            <div class="key w120">Người đại diện</div>
                                            <div class="value">
                                                <input type="text" class="form-control"  :value="khachhang.nguoidd" @change="v=>khachhang.nguoidd=v.target.value">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-5 col-12">
                                        <div class="info-row">
                                            <div class="key w90">Chức vụ</div>
                                            <div class="value">
                                                <input type="text" class="form-control"  :value="khachhang.chucvu" @change="v=>khachhang.chucvu=v.target.value">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="info-row">
                                    <div class="key w120">Địa chỉ NĐD</div>
                                    <div class="value">
                                        <div class="input-more-button">
                                            <button class="btn" v-b-modal.popupDiaChiNDD title="Chọn địa chỉ người đại diện">
                                                <span class="-ap icon-more_horiz"></span>
                                            </button>
                                            <ModalChonDiaChi modalId="popupDiaChiNDD" :data="diachiNDD" :isStrictMode="true" @xacnhan="getDiaChiNDD"/>
                                            <bss-error-marker :has-error="$v.diachiNDD.DIACHI.$error">
                                                <input type="text"  :value="$v.diachiNDD.DIACHI.$model" @change="v=>$v.diachiNDD.DIACHI.$model=v.target.value" class="form-control" title="Địa chỉ người đại diện">
                                            </bss-error-marker>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-7 col-12">
                                        <div class="info-row">
                                            <div class="key w120">Điện thoại (*)</div>
                                            <div class="value" :class="{disabled:isEditKH}">
                                                <input type="text" class="form-control"  :value="khachhang.dienthoai" @change="v=>{ khachhang.dienthoai=v.target.value; if(!thanhtoan.sodienthoai || thanhtoan.sodienthoai=='') thanhtoan.sodienthoai = v.target.value; }" required pattern="^0\d{9,10}$" title="Điện thoại liên hệ của người đại diện; Số điện thoại không được ít hơn 10 số và phải bắt đầu bằng 0">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-5 col-12">
                                        <div class="info-row">
                                            <div class="key w90">Fax</div>
                                            <div class="value">
                                                <input type="text" class="form-control"  :value="khachhang.fax" @change="v=>khachhang.fax=v.target.value" title="Fax người đại diện">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="info-row">
                                    <div class="key w120">Hộ khẩu</div>
                                    <div class="value">
                                        <div class="input-more-button">
                                            <button class="btn" v-b-modal.popupDiaChiHK title="Chọn địa chỉ hộ khẩu">
                                                <span class="-ap icon-more_horiz"></span>
                                            </button>
                                            <ModalChonDiaChi modalId="popupDiaChiHK" :data="diachiHK" :isStrictMode="true" @xacnhan="getDiaChiHK"/>

                                            <bss-error-marker :has-error="$v.diachiHK.DIACHI.$error">
                                                <input type="text"  :value="$v.diachiHK.DIACHI.$model" @change="v=>$v.diachiHK.DIACHI.$model=v.target.value" class="form-control">
                                            </bss-error-marker>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-7 col-12">
                                        <div class="info-row">
                                            <div class="key w120">Nơi cấp HK</div>
                                            <div class="value">
                                                <input type="text" class="form-control"  :value="khachhang.noicaphk" @change="v=>khachhang.noicaphk=v.target.value">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-5 col-12">
                                        <div class="info-row">
                                            <div class="key w90">Ngày cấp HK</div>
                                            <div class="value">
                                                <div class="input-icon-right">
                                                    <date-picker input-class="form-control" :format="dateFormat" :value-type="datetimeFormatFull" v-model="NgayCapHK"></date-picker>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="info-row">
                                    <div class="key w120">Ngân hàng</div>
                                    <div class="value w20 padt7">
                                        <div class="check-action">
                                            <input type="checkbox" class="check" v-model="listbox.nganhang.ischeckedkh">
                                            <span class="name"></span>
                                        </div>
                                    </div>
                                    <div class="value" :class="{disabled:!listbox.nganhang.ischeckedkh}">
                                        <!-- <select2 v-model="listbox.nganhang.valuekh" class="select-custom" :class="{disabled:!listbox.nganhang.ischeckedkh}" :options="listbox.nganhang.list.map(nh=>({id:nh.nganhang_id,text:nh.ten_nh}))"></select2> -->

                                        <ComboboxGrid2  class="select-custom"
                                            :columns="[
                                            {fieldName: 'ten_nh', headerText: '', allowFiltering: true, width:'300'},
                                            ]"
                                            :dataSource="listbox.nganhang.list" textField="ten_nh" valueField="nganhang_id"
                                            :enabledSelectFirstRow="false" :value="listbox.nganhang.valuekh"
                                            @selectedChanged="(item)=>{if(item) { listbox.nganhang.valuekh=item.nganhang_id; }}">
                                        </ComboboxGrid2>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-7 col-12">
                                        <div class="info-row">
                                            <div class="key w120">Tài khoản</div>
                                            <div class="value">
                                                <input type="text" class="form-control"  :value="listbox.nganhang.sotaikhoankh" @change="v=>listbox.nganhang.sotaikhoankh=v.target.value">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-5 col-12">
                                        <div class="info-row">
                                            <div class="key w90">Mã số thuế</div>
                                            <div class="value">
                                                <input type="text" class="form-control"  :value="khachhang.masothue" @change="v=>{ khachhang.masothue=v.target.value; KiemTraMST(); }">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-7 col-12">
                                        <div class="info-row">
                                            <div class="key w120">Đặc trưng</div>
                                            <div class="value">
                                                <input type="text" class="form-control"  :value="khachhang.dactrung" @change="v=>khachhang.dactrung=v.target.value">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-5 col-12">
                                        <div class="info-row">
                                            <div class="key w90">HT tiếp thị</div>
                                            <div class="value">
                                                <select2 v-model="listbox.hinhthuc_tthi.value" class="select-custom" :options="listbox.hinhthuc_tthi.list.map(ht=>({id:ht.httthi_id,text:ht.hinhthuc_tthi}))"></select2>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="info-row">
                                    <div class="key w120">Ghi chú</div>
                                    <div class="value">
                                        <input type="text" class="form-control"  :value="khachhang.ghichu" @change="v=>khachhang.ghichu=v.target.value">
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                    <div class="box">
                        <div class="legend-title">Thông tin thanh toán</div>
                        <div class="row">
                            <div class="col-sm-6 col-12">
                                <div class="row">
                                    <div class="col-sm-7 col-12">
                                        <div class="info-row">
                                            <div class="key w120">Mã TT (*)</div>
                                            <div class="value">
                                                <div class="input-more-button">
                                                    <button class="btn" :class="{disabled:!(khachhang.khachhang_id&&khachhang.khachhang_id>0)}" @click.prevent="ShowPopupChonMaTT" title="Chọn mã thanh toán ghép hóa đơn">
                                                        <span class="-ap icon-more_horiz"></span>
                                                    </button>
                                                    <input type="text" class="form-control disabled"  :value="thanhtoan.matt" @change="v=>thanhtoan.matt=v.target.value" @keypress.enter="maTTChanged">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-5 col-12">
                                        <div class="info-row">
                                            <div class="key">Mã đại diện</div>
                                            <div class="value">
                                                <select2 v-model="listbox.madaidien.value" class="select-custom" :options="listbox.madaidien.list.map(dd=>({id:dd.ma_tb,text:dd.ma_tb}))"></select2>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="info-row">
                                    <div class="key w120">Tên thanh toán (*)</div>
                                    <div class="value">
                                        <input type="text" class="form-control " required :value="thanhtoan.tentt" @change="v=>thanhtoan.tentt=v.target.value">
                                    </div>
                                </div>
                                <div class="info-row">
                                    <div class="key w120">Địa chỉ TT (*)</div>
                                    <div class="value">
                                        <div class="input-more-button">
                                            <button class="btn" v-b-modal.popupDiaChiTT title="Chọn địa chỉ thanh toán">
                                                <span class="-ap icon-more_horiz"></span>
                                            </button>
                                            <ModalChonDiaChi modalId="popupDiaChiTT" :data="diachiTT" :isStrictMode="true" @xacnhan="getDiaChiTT"/>

                                            <bss-error-marker :has-error="$v.diachiTT.DIACHI.$error">
                                                <input type="text"  v-model="$v.diachiTT.DIACHI.$model" @change="LoadNVThuCuoc" class="form-control disabled" required title="Bạn chưa nhập địa chỉ thanh toán" >
                                            </bss-error-marker>
                                        </div>
                                    </div>
                                </div>
                                <div class="info-row">
                                    <div class="key w120">Địa chỉ CT (*)</div>
                                    <div class="value">
                                        <div class="input-more-button">
                                            <button class="btn" v-b-modal.popupDiaChiCT title="Chọn địa chỉ chứng từ">
                                                <span class="-ap icon-more_horiz"></span>
                                            </button>
                                            <ModalChonDiaChi modalId="popupDiaChiCT" :data="diachiCT" :isStrictMode="true" @xacnhan="getDiaChiCT"/>

                                            <bss-error-marker :has-error="$v.diachiCT.DIACHI.$error">
                                                <input type="text"  :value="$v.diachiCT.DIACHI.$model" @change="v=>$v.diachiCT.DIACHI.$model=v.target.value" class="form-control" required title="Bạn chưa nhập địa chỉ chứng từ" >
                                            </bss-error-marker>
                                        </div>
                                    </div>
                                </div>
                                <div class="info-row">
                                    <div class="key w120" title="Địa chỉ báo cước">Địa chỉ BC</div>
                                    <div class="value">
                                        <div class="input-more-button">
                                            <button class="btn" v-b-modal.popupDiaChiBC title="Chọn địa chỉ báo cước">
                                                <span class="-ap icon-more_horiz"></span>
                                            </button>
                                            <ModalChonDiaChi modalId="popupDiaChiBC" :data="diachiBC" :isStrictMode="true" @xacnhan="getDiaChiBC"/>

                                            <bss-error-marker :has-error="$v.diachiBC.DIACHI.$error">
                                                <input type="text"  :value="$v.diachiBC.DIACHI.$model" @change="v=>$v.diachiBC.DIACHI.$model=v.target.value" class="form-control">
                                            </bss-error-marker>
                                        </div>
                                    </div>
                                </div>
                                <div class="info-row">
                                    <div class="key w120">Ghi chú</div>
                                    <div class="value">
                                        <input type="text" class="form-control "  :value="thanhtoan.ghichu" @change="v=>thanhtoan.ghichu=v.target.value">
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6 col-12">
                                <div class="row">
                                    <div class="col-sm-7 col-12">
                                        <div class="info-row">
                                            <div class="key w120">Mã in ghép</div>
                                            <div class="value">
                                                <div class="input-more-button">
                                                    <button class="btn" @click.prevent="btnTaoMIG_Click" title="Chọn mã thanh toán ghép hóa đơn">
                                                        <span class="-ap icon-more_horiz"></span>
                                                    </button>
                                                    <input type="text" class="form-control"  :value="thanhtoan.mainghep" @change="v=>thanhtoan.mainghep=v.target.value">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="info-row">
                                            <div class="key w120">Hình thức TT (*)</div>
                                            <div class="value">
                                                <select2 v-model="listbox.hinhthuc_tt.value" class="select-custom" :options="listbox.hinhthuc_tt.list.map(ht=>({id:ht.httt_id,text:ht.hinhthuc_tt}))"></select2>
                                            </div>
                                        </div>
                                        <div class="info-row">
                                            <div class="key w120">Tài khoản</div>
                                            <div class="value">
                                                <input type="text" class="form-control"  :value="listbox.nganhang.sotaikhoan" @change="v=>listbox.nganhang.sotaikhoan=v.target.value">
                                            </div>
                                        </div>
                                        <div class="info-row">
                                            <div class="key w120">Ngân hàng</div>
                                            <div class="value w20 padt7">
                                                <div class="check-action">
                                                    <input type="checkbox" class="check" v-model="listbox.nganhang.ischecked">
                                                    <span class="name"></span>
                                                </div>
                                            </div>
                                            <div class="value">
                                                <div class="input-more-button">
                                                    <button class="btn" :class="{disabled:!(listbox.nganhang.ischecked && listbox.nganhang.isnganhangnn)}" @click.prevent="$bvModal.show('modal-nganhangnn');">
                                                        <span class="-ap icon-more_horiz"></span>
                                                    </button>
                                                    <b-modal id="modal-nganhangnn" modal-class="modal-nganhangnn" hide-footer hide-header no-close-on-backdrop>
                                                        <div class="modal-content popup-box">
                                                            <div class="popup-header">
                                                                <div class="title"><span class="icon one-notepad"></span> Chi tiết MLNS</div>
                                                                <div class="close -ap icon-close" data-dismiss="modal" @click="$bvModal.hide('modal-nganhangnn')">
                                                                </div>
                                                            </div>
                                                            <div class="list-actions-top">
                                                                <ul class="list">
                                                                    <li>
                                                                        <a href="#" @click.prevent="$bvModal.hide('modal-nganhangnn')">
                                                                            <span class="icon nc-icon-glyph ui-1_check-circle-08"></span> Chấp nhận
                                                                        </a>
                                                                    </li>
                                                                </ul>
                                                            </div>
                                                            <div class="popup-body">
                                                                <div class="box-form">
                                                                    <div class="info-row">
                                                                        <div class="key">Đơn vị QHNS</div>
                                                                        <div class="value">
                                                                            <input type="text"  :value="nganhang.DV_QHNS" @change="v=>nganhang.DV_QHNS=v.target.value" class="form-control" />
                                                                        </div>
                                                                    </div>
                                                                    <div class="info-row">
                                                                        <div class="key">Mã chương</div>
                                                                        <div class="value">
                                                                            <input type="text"  :value="nganhang.MACHUONG" @change="v=>nganhang.MACHUONG=v.target.value" class="form-control" />
                                                                        </div>
                                                                    </div>
                                                                    <div class="info-row">
                                                                        <div class="key">Mã ngành KT</div>
                                                                        <div class="value">
                                                                            <input type="text"  :value="nganhang.MN_KT" @change="v=>nganhang.MN_KT=v.target.value" class="form-control" />
                                                                        </div>
                                                                    </div>
                                                                    <div class="info-row">
                                                                        <div class="key">Mã nội dung KT</div>
                                                                        <div class="value">
                                                                            <input type="text"  :value="nganhang.MA_NDKT" @change="v=>nganhang.MA_NDKT=v.target.value" class="form-control" />
                                                                        </div>
                                                                    </div>
                                                                    <div class="info-row">
                                                                        <div class="key">Mã nguồn NSNN</div>
                                                                        <div class="value">
                                                                            <input type="text"  :value="nganhang.MN_NSNN" @change="v=>nganhang.MN_NSNN=v.target.value" class="form-control" />
                                                                        </div>
                                                                    </div>
                                                                    <div class="info-row">
                                                                        <div class="key">Tiền định mức</div>
                                                                        <div class="value">
                                                                            <vue-numeric class="form-control tright" separator="." decimal-separator="," :precision="is_nv_vnpti==1?2:0" v-model="nganhang.TIEN_DM" placeholder="0" output-type="Number"></vue-numeric>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </b-modal>
                                                    <!-- <select2 v-model="listbox.nganhang.value" class="select-custom" :class="{disabled:!listbox.nganhang.ischecked}" :options="listbox.nganhang.list.map(nh=>({id:nh.nganhang_id,text:nh.ten_nh}))" @change="nganhangTTChanged"></select2> -->
                                                    <span  :class="{disabled:!listbox.nganhang.ischecked}">
                                                        <ComboboxGrid2  class="select-custom"
                                                            :columns="[
                                                            {fieldName: 'ten_nh', headerText: '', allowFiltering: true, width:'300'},
                                                            ]"
                                                            :dataSource="listbox.nganhang.list" textField="ten_nh" valueField="nganhang_id"
                                                            :enabledSelectFirstRow="false" :value="listbox.nganhang.value"
                                                            @selectedChanged="(item)=>{if(item) { listbox.nganhang.value=item.nganhang_id; nganhangTTChanged(item.nganhang_id); }}">
                                                        </ComboboxGrid2>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="info-row">
                                            <div class="key w120" title="Hình thức tính cước hàng tháng">Hình thức TC(*)</div>
                                            <div class="value">
                                                <select2 v-model="listbox.hinhthuc_tc.value" class="select-custom" :options="listbox.hinhthuc_tc.list.map(ht=>({id:ht.httc_id,text:ht.hinhthuc_tc}))"></select2>
                                            </div>
                                        </div>
                                        <div class="info-row">
                                            <div class="key w120" title="Điện thoại thanh toán">Điện thoại</div>
                                            <div class="value">
                                                <input type="text" class="form-control"  :value="thanhtoan.sodienthoai" @change="v=>thanhtoan.sodienthoai=v.target.value" pattern="^0\d{9,10}$" title="Số điện thoại không được ít hơn 10 số và phải bắt đầu bằng 0">
                                            </div>
                                        </div>

                                    </div>
                                    <div class="col-sm-5 col-12">
                                        <div class="info-row">
                                            <div class="key w90">Đơn vị QL</div>
                                            <div class="value disabled">
                                                <select2 v-model="listbox.donvi_ql.valueql" class="select-custom" :options="listbox.donvi_ql.list.filter(dv=>(dv.loaidv_id==2)).map(dv=>({id:dv.donvi_id,text:dv.ten_dv}))"></select2>
                                            </div>
                                        </div>
                                        <div class="info-row">
                                            <div class="key w90">Mã NV/TC(*)</div>
                                            <div class="value">
                                                <!-- <PopupTimKiemNhanVienThuCuoc :input="diachiLD" :dvql="listbox.donvi_ql.valueql*1" @acceptChange="getNVTCProcess($event)" ref="dlgTimKiemNVTC"></PopupTimKiemNhanVienThuCuoc> -->
                                                <PopupTimKiemNhanVienThuCuoc :input="nvtcInput" @response-data="getNVTCProcess($event)" ref="dlgTimKiemNVTC" id="dlgTimKiemNVTC"></PopupTimKiemNhanVienThuCuoc>
                                                <div class="input-more-button">
                                                    <button class="btn" @click.prevent="popupTimNVThuCuoc" title="Chọn mã nhân viên thu cước, tuyến thu">
                                                        <span class="-ap icon-more_horiz"></span>
                                                    </button>
                                                    <div class="row">
                                                        <div class="col-sm-6 col-12 disabled">
                                                            <input type="text" class="form-control highlight"  :value="thanhtoan.manvtc" @change="v=>thanhtoan.manvtc=v.target.value" required title="Cần nhập thông tin mã nhân viên thu cước">
                                                        </div>
                                                        <div class="col-sm-6 col-12 disabled">
                                                            <input type="text" class="form-control highlight"  :value="thanhtoan.matuyen" @change="v=>thanhtoan.matuyen=v.target.value" required title="Cần nhập thông tin tuyến thu">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="info-row">
                                            <div class="key w90">Chủ TK</div>
                                            <div class="value">
                                                <input type="text" class="form-control"  :value="thanhtoan.chutk" @change="v=>thanhtoan.chutk=v.target.value" title="Email thanh toán">
                                            </div>
                                        </div>
                                        <div class="info-row">
                                            <div class="key w90">Mã số thuế</div>
                                            <div class="value">
                                                <input type="text" class="form-control"  :value="thanhtoan.masothue" @change="v=>thanhtoan.masothue=v.target.value">
                                            </div>
                                        </div>
                                        <div class="info-row">
                                            <div class="key w90">Mã NVQL</div>
                                            <div class="value">
                                                <input type="text" class="form-control"  :value="thanhtoan.manvql" @change="v=>thanhtoan.manvql=v.target.value">
                                            </div>
                                        </div>
                                        <div class="info-row">
                                            <div class="key w90">Email</div>
                                            <div class="value">
                                                <input type="text" class="form-control"  :value="thanhtoan.email" @change="v=>thanhtoan.email=v.target.value">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-9 col-12">
                            <div class="legend-title mart20">
                                Danh sách thanh toán
                            </div>
                            <div class="table-content" style="height: 260px;">
                                <DataGrid2
                                        v-bind:columns="[
                                        {fieldName: 'stt', headerText: 'STT', allowFiltering: true, allowSorting: false},
                                        {fieldName: 'ma_tt', headerText: 'Mã TT', allowFiltering: true, allowSorting: false},
                                        {fieldName: 'ten_tt', headerText: 'Tên thanh toán', allowFiltering: true, allowSorting: false},
                                        {fieldName: 'diachi_tt', headerText: 'Địa chỉ thanh toán', allowFiltering: true, allowSorting: false},
                                        {fieldName: 'diachi_ct', headerText: 'Địa chỉ chứng từ', allowFiltering: true, allowSorting: false,}]"
                                    v-bind:dataSource="listbox.thanhtoan.list" :showFilter="false" :showColumnCheckbox="false"
                                    dataKeyField="MA_DVKHAC" :defaultColumnCheckboxChecked="false"
                                    @rowClicked="lvwThanhToanChanged" >
                                </DataGrid2>
                            </div>
                        </div>
                        <div class="col-sm-3 col-12">
                            <div class="legend-title mart20">Dịch vụ khác</div>
                            <div class="input-more-button">
                                <button class="btn" @click.prevent="popupDVKhacTT" title="Chọn dịch vụ khác cho hóa đơn">
                                    <span class="-ap icon-more_horiz"></span>
                                </button>
                                <ul name="" class="form-control listview" style="height: 110px;resize: none;">
                                    <li :value="dv.dvkhac_id" v-for="dv in lvDvkhac_TT.list" v-if="dv.loaiid==2" @click="lvDvkhac_TT.value=dv.dvkhac_id" :class="{active:lvDvkhac_TT.value==dv.dvkhac_id}">{{dv.ten_dvkhac}}</li>
                                </ul>
                            </div>

                        </div>
                    </div>
                </div>

            </div>
            <div id="tab2" class="tab-pane">
                <div class="tab-content" v-if="currentTab!='tab1'">
                    <div class="row">
                        <div class="col-sm-6 col-12">
                            <div class="box-form">
                                <div class="row">
                                    <div class="col-sm-7 col-12">
                                        <div class="info-row">
                                            <div class="key">Dịch vụ</div>
                                            <div class="value">
                                                <select2 v-model="listbox.dichvu_vt.value" class="select-custom" :options="listbox.dichvu_vt.list.map(dv=>({id:dv.dichvuvt_id*1,text:dv.ten_dvvt}))"></select2>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-5 col-12">
                                        <div class="info-row">
                                            <div class="key w90">Loại hình</div>
                                            <div class="value">
                                                <select2 v-model="listbox.loaihinh_tb.value" class="select-custom" :options="cloaihinh_tb" @change="HT_GIAODIEN_DONVI"></select2>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-7 col-12">
                                        <div class="info-row">
                                            <div class="key">Kiểu yêu cầu</div>
                                            <div class="value">
                                                <select2 v-model="listbox.kieu_ld.value" class="select-custom" :options="ckieu_ld" @change="HT_GIAODIEN_DONVI"></select2>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-5 col-12">
                                        <div class="info-row">
                                            <div class="key w90">Công nghệ</div>
                                            <div class="value">
                                                <select2 v-model="listbox.congnghe.value" class="select-custom" :options="ccongnghe" @change="cboCongNghe_SelectedValueChanged"></select2>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-7 col-12">
                                        <div class="info-row">
                                            <div class="key">Mức cước TB</div>
                                            <div class="value" :class="{disabled:listbox.dichvu_vt.value==DichVuVienThong.MEGA_EYES}">
                                                <select2 v-model="listbox.muccuoc_tb.value" class="select-custom" :options="listbox.muccuoc_tb.list.map(mc=>({id:mc.muccuoctb_id?mc.muccuoctb_id:mc.mucuoctb_id,text:mc.tenmuccuoc}))"></select2>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-5 col-12">
                                        <div class="info-row">
                                            <div class="key w90">Tháng CK</div>
                                            <div class="value">
                                                <input type="number" class="form-control" v-model="thuebao.thangck" title="Số tháng cam kết">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-7 col-12">
                                        <div class="info-row">
                                            <div class="key">Thanh toán</div>
                                            <div class="value">
                                                <select2 v-model="listbox.thanhtoancbo.value" class="select-custom" :class="{disabled:!listbox.thanhtoancbo.list||!listbox.thanhtoancbo.list.length||listbox.thanhtoancbo.list.length<=0}" :options="listbox.thanhtoancbo.list.map(tt=>({id:tt.ID,text:tt.NAME}))"></select2>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-5 col-12">
                                        <div class="info-row">
                                            <div class="key w90">Gói kỹ thuật</div>
                                            <div class="value">
                                                <select2 v-model="listbox.goi_kt.value" class="select-custom" :options="listbox.goi_kt.list.map(kt=>({id:kt.goikt_id,text:kt.ten_goi}))"></select2>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-7 col-12">
                                        <div class="info-row">
                                            <div class="key">Tên thuê bao (*)</div>
                                            <div class="value">
                                                <input type="text" class="form-control"  :value="thuebao.tentb" @change="v=>thuebao.tentb=v.target.value" required title='Bạn chưa nhập tên thuê bao!'>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-5 col-12">
                                        <div class="info-row">
                                            <div class="key w90">Ngày sinh (*)</div>
                                            <div class="value">
                                                <div class="input-icon-right">
                                                    <date-picker input-class="form-control" :format="dateFormat" :value-type="datetimeFormatFull" v-model="NgaySinhTB" :input-attr="{required: 'true', title: 'Bạn chưa nhập thông tin ngày sinh!'}"></date-picker>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="info-row">
                                    <div class="key">Địa chỉ TB (*)</div>
                                    <div class="value">
                                        <div class="input-more-button">
                                            <button class="btn" v-b-modal.popupDiaChiTB title="Chọn địa chỉ thuê bao">
                                                <span class="-ap icon-more_horiz"></span>
                                            </button>
                                            <ModalChonDiaChi modalId="popupDiaChiTB" :data="diachiTB" :isStrictMode="true" @xacnhan="getDiaChiTB"/>

                                            <bss-error-marker :has-error="$v.diachiTB.DIACHI.$error">
                                                <input type="text"  :value="$v.diachiTB.DIACHI.$model" @change="v=>$v.diachiTB.DIACHI.$model=v.target.value" class="form-control" required title="Bạn chưa nhập địa chỉ thuê bao">
                                            </bss-error-marker>
                                        </div>
                                    </div>
                                </div>
                                <div class="info-row">
                                    <div class="key">Địa chỉ LĐ (*)</div>
                                    <div class="value">
                                        <div class="input-more-button">
                                            <button class="btn" v-b-modal.popupDiaChiLD title="Chọn địa chỉ lắp đặt">
                                                <span class="-ap icon-more_horiz"></span>
                                            </button>
                                            <ModalChonDiaChi modalId="popupDiaChiLD" :data="diachiLD" :isStrictMode="true" :showThongTinLoaiNha="true" @xacnhan="getDiaChiLD"/>

                                            <bss-error-marker :has-error="$v.diachiLD.DIACHI.$error">
                                                <input type="text"  :value="$v.diachiLD.DIACHI.$model" @change="v=>$v.diachiLD.DIACHI.$model=v.target.value" class="form-control" required title="Bạn chưa nhập địa chỉ lắp đặt">
                                            </bss-error-marker>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-7 col-12">
                                        <div class="info-row">
                                            <div class="key">Đối tượng TB</div>
                                            <div class="value">
                                                <ComboboxGrid2  class="select-custom"
                                                    :columns="[
                                                    {fieldName: 'doituong_id', headerText: 'Mã đối tượng', allowFiltering: true, width:'70'},
                                                    {fieldName: 'ten_dt', headerText: 'Đối tượng', allowFiltering: true, width:'300'},
                                                    ]"
                                                    :dataSource="listbox.doituong.list" textField="ten_dt" valueField="doituong_id"
                                                    :enabledSelectFirstRow="false" :value="listbox.doituong.value"
                                                    @selectedChanged="(item)=>{if(item) {listbox.doituong.value=item.doituong_id;}}">
                                                </ComboboxGrid2>
                                                <!-- <select2 v-model="listbox.doituong.value" class="select-custom" :options="listbox.doituong.list.map(dt=>({id:dt.doituong_id,text:dt.ten_dt}))"></select2> -->
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-2 col-12">
                                        <div class="info-row">
                                            <div class="key w30" title="Mã số thuế TB">MST</div>
                                            <div class="value" :class="{disabled:listbox.doituong.value!=387}">
                                                <input type="text" class="form-control" :value="thuebao.txtMSTThueBao" @change="v=>{ thuebao.txtMSTThueBao=v.target.value; KiemTraMSTTB() }" title="Mã số thuế TB">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-3 col-12">
                                        <div class="info-row">
                                            <div class="key w90" title="Thời gian dùng thử (ngày)">TG dùng thử</div>
                                            <div class="value">
                                                <input type="number" class="form-control" v-model="thuebao.tgdungthu" title="Thời gian dùng thử (ngày)">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-7 col-12">
                                        <div class="info-row">
                                            <div class="key">Đơn vị lắp đặt</div>
                                            <div class="value disabled">
                                                <select2 v-model="listbox.donvi_ql.value" class="select-custom" :options="listbox.donvi_ql.list.filter(dv=>(dv.loaidv_id==3)).map(dv=>({id:dv.donvi_id,text:dv.ten_dv}))"></select2>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-5 col-12">
                                        <div class="info-row">
                                            <div class="key w90">Khu vực</div>
                                            <div class="value">
                                                <div class="input-more-button">
                                                    <button class="btn" @click.prevent="popupChonKhuVuc">
                                                        <span class="-ap icon-more_horiz"></span>
                                                    </button>
                                                    <input type="text" class="form-control disabled" readonly :value="thuebao.khuvuc" @change="v=>thuebao.khuvuc=v.target.value" required title='Thông tin khu vực là bắt buộc!'>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="info-row">
                                    <div class="key">
                                        <div class="check-action">
                                            <input type="checkbox" class="check" :class="{disabled: !filterbox.khuyenmai.list || filterbox.khuyenmai.list.length<=0 || (listbox.doituong && listbox.doituong.value == 190)}" v-model="filterbox.khuyenmai.ischecked">
                                            <span class="name">K.Mại</span>
                                        </div>
                                    </div>
                                    <div class="value">
                                        <div class="input-more-button">
                                            <button class="btn" :class="{disabled: !filterbox.khuyenmai.ischecked}" @click.prevent="ShowPopupChonKhuyenMai(0)">
                                                <span class="-ap icon-more_horiz"></span>
                                            </button>
                                            <select2 v-model="filterbox.khuyenmai.value" class="select-custom" :class="{disabled:!filterbox.khuyenmai.ischecked}" :options="filterbox.khuyenmai.list.map(km=>({id:km.khuyenmai_id,text:km.ten_km}))" @change="cboKhuyenMai_SelectedValueChanged"></select2>
                                        </div>
                                    </div>
                                    <div class="value nowrap" style="width: 160px;">
                                        <button class="btn btn-second fullw" :class="{disabled: !filterbox.khuyenmai.ischecked}" title="Chọn chi tiết khuyến mại" @click="btnChiTietKM_Click">
                                            <span class="one-eye f20 inline vcenter"></span> Chi tiết
                                        </button>
                                    </div>
                                </div>
                                <div class="info-row">
                                    <div class="key">
                                        <div class="check-action">
                                            <input type="checkbox" class="check" :class="{disabled: !filterbox.tratruoc.list || filterbox.tratruoc.list.length<=0}" v-model="filterbox.tratruoc.ischecked">
                                            <span class="name">Trả trước</span>
                                        </div>
                                    </div>
                                    <div class="value">
                                        <div class="input-more-button">
                                            <button class="btn" :class="{disabled: !filterbox.tratruoc.ischecked}" @click.prevent="ShowPopupChonKhuyenMai(1)">
                                                <span class="-ap icon-more_horiz"></span>
                                            </button>
                                            <select2 v-model="filterbox.tratruoc.value" class="select-custom" :class="{disabled:!filterbox.tratruoc.ischecked}" :options="filterbox.tratruoc.list.map(km=>({id:km.khuyenmai_id,text:km.ten_km}))" @change="cboTraTruoc_SelectedValueChanged"></select2>
                                        </div>
                                    </div>
                                    <div class="value nowrap" style="width: 160px">
                                        <button class="btn btn-second fullw" :disabled="!filterbox.tratruoc.ischecked || !filterbox.tratruoc.list || filterbox.tratruoc.list.length<=0" @click.prevent="btnChiTietTraTruoc_Click" title="Chi tiết tiền đặt cọc">
                                            <span class="one-eye f20 inline vcenter"></span> Chi tiết
                                        </button>
                                    </div>
                                </div>
                                <div class="info-row">
                                    <div class="key">
                                        Ghi chú
                                    </div>
                                    <div class="value">
                                        <input type="text" class="form-control"  :value="thuebao.ghichu" @change="v=>thuebao.ghichu=v.target.value">
                                    </div>
                                    <div class="value nowrap" style="width: 160px;" :class="{disabled:!(listbox.loaihinh_tb.value==LoaiHinhTB.CA || listbox.loaihinh_tb.value==LoaiHinhTB.SMART_CA || listbox.loaihinh_tb.value == LoaiHinhTB.IVAN || listbox.loaihinh_tb.value == 358 || listbox.loaihinh_tb.value == LoaiHinhTB.VNPT_COLOCATION)}">
                                        <button class="btn btn-second fullw" @click.prevent="btnThongTinTBSub_Click">
                                            <span class="one-file-edit f20 inline vcenter"></span> Thông tin TB
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6 col-12">
                            <div>
                                <div id="codinh" class="tab-pane" v-if="DichVuVienThong.CO_DINH==listbox.dichvu_vt.value">
                                    <div class="tab-content">
                                        <div class="row">
                                            <div class="col-sm-8 col-12">
                                                <div class="info-row">
                                                    <div class="key">Số máy</div>
                                                    <div class="value">
                                                        <div class="input-more-button">
                                                            <b-modal id="frmChonSoMay_TinhKhac" title="Thời gian thuê ngắn hạn"><!-- @ok="handleOk" -->
                                                                <div class="key">Số máy</div><div class="value"><input type="text" class="form-control"  :value="thuebao.codinh.somay" @change="v=>thuebao.codinh.somay=v.target.value" /></div>
                                                            </b-modal>
                                                            <button class="btn" :class="{disabled:!buttons.btnChonSM}" @click="ShowPopupChonSM" title="Chọn số máy">
                                                                <span class="-ap icon-more_horiz"></span>
                                                            </button>
                                                            <input type="text" class="form-control  disabled" :value="thuebao.codinh.somay" @change="v=>thuebao.codinh.somay=v.target.value">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w70">Mã TN</div>
                                                    <div class="value">
                                                        <div class="input-more-button">
                                                            <button class="btn" @click.prevent="popupMaTN" :class="{disabled:!(kieu_ld_kieu==1 || kieu_ld_kieu==2 || kieu_ld_kieu==4)}" title="Chọn mã truy nhập">
                                                                <span class="-ap icon-more_horiz"></span>
                                                            </button>
                                                            <input type="text" class="form-control disabled"  :value="thuebaocd.matn" @change="v=>thuebaocd.matn=v.target.value">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key">Loại số</div>
                                                    <div class="value">
                                                        <div class="select-custom">
                                                            <select v-model="loaisoisdn" class="form-control">
                                                                <option value="1">Số chính</option>
                                                                <option value="2">Số phụ</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w90">Số chính</div>
                                                    <div class="value">
                                                        <div class="input-more-button" :class="{'disabled':loaisoisdn==1}">
                                                            <button class="btn" @click.prevent="btnChonSoChinh_Click" title="Chọn số chính">
                                                                <span class="-ap icon-more_horiz"></span>
                                                            </button>
                                                            <input type="text" class="form-control " :value="thuebao.codinh.sochinh" @change="v=>thuebao.codinh.sochinh=v.target.value" readonly>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w70">Trang bị</div>
                                                    <div class="value">
                                                        <select2 v-model="listbox.trangbi.valuecd" class="select-custom" :options="listbox.trangbi.list.map(lc=>({id:lc.trangbi_id,text:lc.tentrangbi}))" @change="v=>{listbox.trangbi.valuecd=v;trangbi_id=v;LoadMucCuocTB();}"></select2>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key">Thời hạn</div>
                                                    <div class="value">
                                                        <select2 v-model="listbox.thoihan.valuecd" class="select-custom" :options="listbox.thoihan.list.map(th=>({id:th.thoihan_id,text:th.tenthoihan}))"></select2>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="value padl0" :class="{disabled:listbox.thoihan.valuecd!=ThoiHan.Ngan_Han}">
                                                        <button class="btn btn-second fullw" @click.prevent="$bvModal.show('modal-tgthue');">
                                                            <span class="one-file-edit f20 vcenter inline"></span> TG thuê
                                                        </button>
                                                        <b-modal id="modal-tgthue" title="Thời gian thuê ngắn hạn" ok-title="Chấp nhận" cancel-title="Thoát" @ok="kt_thuenganhan=true"><!-- @ok="handleOk" -->
                                                            <div class="key">Từ ngày</div><div class="value"><date-picker input-class="form-control" :format="datetimeFormatFull" :value-type="'format'" v-model="TGThueTuNgay"></date-picker></div>
                                                            <div class="key">Đến ngày</div><div class="value"><date-picker input-class="form-control" :format="datetimeFormatFull" :value-type="'format'" v-model="TGThueDenNgay"></date-picker></div>
                                                        </b-modal>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w70">Chủ quản</div>
                                                    <div class="value">
                                                        <!-- <select2 v-model="listbox.chu_quan.valuecd" class="select-custom" :options="listbox.chu_quan.list.map(cq=>({id:cq.chuquan_id,text:cq.ten_tat}))"></select2> -->
                                                        <ComboboxGrid2  class="select-custom"
                                                            :columns="[
                                                            {fieldName: 'ten_tat', headerText: '', allowFiltering: true, width:'300'},
                                                            ]"
                                                            :dataSource="listbox.chu_quan.list" textField="ten_tat" valueField="chuquan_id"
                                                            :enabledSelectFirstRow="false" :value="listbox.chu_quan.valuecd"
                                                            @selectedChanged="(item)=>{if(item) { listbox.chu_quan.valuecd=item.chuquan_id; }}">
                                                        </ComboboxGrid2>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key">
                                                        <div class="check-action">
                                                            <input type="checkbox" class="check" v-model="listbox.doitac.ischeckedcd">
                                                            <span class="name">Đối tác</span>
                                                        </div>
                                                    </div>
                                                    <div class="value" :class="{disabled:!listbox.doitac.ischeckedcd}" >
                                                        <!-- <select2 v-model="listbox.doitac.valuecd" class="select-custom":options="listbox.doitac.list.map(dt=>({id:dt.doitac_id,text:dt.ten_dt}))"></select2> -->
                                                        <ComboboxGrid2  class="select-custom"
                                                            :columns="[
                                                            {fieldName: 'ten_dt', headerText: '', allowFiltering: true, width:'300'},
                                                            ]"
                                                            :dataSource="listbox.doitac.list" textField="ten_dt" valueField="doitac_id"
                                                            :enabledSelectFirstRow="false" :value="listbox.doitac.valuecd"
                                                            @selectedChanged="(item)=>{if(item) { listbox.doitac.valuecd=item.doitac_id; }}">
                                                        </ComboboxGrid2>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w90">Cước đối tác</div>
                                                    <div class="value">
                                                        <input type="text" class="form-control"  :value="thuebaocd.cuocdoitac" @change="v=>thuebaocd.cuocdoitac=v.target.value" title="Cước đối tác, chưa VAT">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w70" title="Đơn vị lắp đặt dịch vụ">Đvị LĐ</div>
                                                    <div class="value">
                                                        <!-- <select2 v-model="listbox.chu_quan.valueldcd" class="select-custom" :options="listbox.chu_quan.list.map(cq=>({id:cq.chuquan_id,text:cq.ten_tat}))"></select2> -->
                                                        <ComboboxGrid2  class="select-custom"
                                                            :columns="[
                                                            {fieldName: 'ten_tat', headerText: '', allowFiltering: true, width:'300'},
                                                            ]"
                                                            :dataSource="listbox.chu_quan.list" textField="ten_tat" valueField="chuquan_id"
                                                            :enabledSelectFirstRow="false" :value="listbox.chu_quan.valueldcd"
                                                            @selectedChanged="(item)=>{if(item) { listbox.chu_quan.valueldcd=item.chuquan_id; }}">
                                                        </ComboboxGrid2>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="info-row" v-for="(ct,idx) in DT_CONTROLS.list" v-if="DT_CONTROLS.list.length>0">
                                            <div class="key">
                                                {{ct.TEN_LOAIDV}}
                                            </div>
                                            <div class="value">
                                                <select2 v-model="DT_CONTROLS.value[idx]" :key="DT_CONTROLS.key+'-'+idx" class="select-custom" :options="DT_DV(idx)" required title="Không được để trống thông tin!"></select2>
                                            </div>
                                        </div>
                                        <div class="info-row hidden">
                                            <div class="key">
                                                Miễn cước thuê bao
                                            </div>
                                            <div class="value">
                                                <input type="checkbox" class="form-control" v-model="chkMienCuocTB">
                                            </div>
                                        </div>
                                        <div class="info-row hidden">
                                            <div class="key">
                                                VSVX
                                            </div>
                                            <div class="value">
                                                <input type="checkbox" class="form-control" v-model="chkVSVX">
                                            </div>
                                        </div>
                                        <div class="info-row hidden" :class="{hidden:thuebaocd.madoicap?true:false}">
                                            <div class="key">
                                                Mã đổi cáp
                                            </div>
                                            <div class="value">
                                                <input type="number" class="form-control" v-model="thuebaocd.madoicap">
                                            </div>
                                        </div>
                                        <div class="legend-title mart10">Tiền cam kết số đẹp</div>
                                        <div class="table-content" style="height: 140px;">
                                            <!-- <DataGrid2 :columns="thuebao.codinh.dgvTienCK.headers" :dataSource="thuebao.codinh.dgvTienCK.list" :enable-paging-server="false" :allowPaging="false" :showFilter="true"></DataGrid2> -->

                                            <DataGrid ref="dgvTienCK" :columns="thuebao.codinh.dgvTienCK.headers"
                                                :dataSource="thuebao.codinh.dgvTienCK.list"
                                                :enable-paging-server="false"
                                                :allowPaging="false"
                                                :showFilter="false"
                                                :showColumnCheckbox="false"
                                                :editSettings="tienckeditsettings"
                                                @actionComplete="dgvTienCK_actionComplete"
                                                :toolbar="tiencktoolbar">
                                            </DataGrid>
                                        </div>
                                    </div>
                                </div>
                                <!-- <div id="didong" class="tab-pane" :class="{disabled:DichVuVienThong.DI_DONG==listbox.dichvu_vt.value}" v-if="listbox.kieu_ld.value == KieuLapDat.DM_DIDONG_C_P"> -->
                                  <div id="didong" class="tab-pane" v-if="DichVuVienThong.DI_DONG==listbox.dichvu_vt.value">
                                    <div class="tab-content">
                                        <div class="row">
                                            <div class="col-sm-7 col-12">
                                                <div class="info-row">
                                                    <div class="key">Số máy</div>
                                                    <div class="value w30">
                                                        <button class="btn btn-second" @click="btnChonSoDD_Click" title="Chọn số máy">
                                                            <span class="-ap icon-more_horiz"></span>
                                                        </button>
                                                    </div>
                                                    <div class="value">
                                                        <div class="input-more-button">
                                                            <button class="btn">
                                                                84
                                                            </button>
                                                            <input type="text" class="form-control " :value="thuebao.didong.txtSoMayDD" @change="v=>{thuebao.didong.txtSoMayDD=v.target.value;txtSoMayDD_Leave();}">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-5 col-12">
                                                <div class="info-row">
                                                    <div class="key w70">Số sim</div>
                                                    <div class="value">
                                                        <input type="text" class="form-control" :value="thuebao.didong.txtSimDD" @change="v=>thuebao.didong.txtSimDD=v.target.value">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row" v-if="[166,27,28,66,67].indexOf(listbox.kieu_ld.value*1)>=0">
                                          <div class="col-sm-7 col-12">
                                              <div class="info-row">
                                                  <div class="key">Số máy nhận NTK</div>
                                                  <div class="value">
                                                    <input type="text" class="form-control" :value="thuebao.didong.txtSoMayNTK" @change="v=>thuebao.didong.txtSoMayNTK=v.target.value">
                                                  </div>
                                              </div>
                                          </div>
                                          <div class="col-sm-5 col-12">
                                              <div class="info-row">
                                                  <div class="key w70">Tiền dư NTK</div>
                                                  <div class="value">
                                                    <vue-numeric class="form-control tright fw6" separator="." decimal-separator="," :precision="is_nv_vnpti==1?2:0" :value="thuebao.didong.txtTienDuTK" @change="v=>thuebao.didong.txtTienDuTK=v.target.value" placeholder="0" output-type="Number"></vue-numeric>
                                                  </div>
                                              </div>
                                          </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-7 col-12">
                                                <div class="info-row">
                                                    <div class="key">Gói cước</div>

                                                    <div class="value" :class="{disabled:listbox.loaihinh_tb.value == LoaiHinhTB.DIDONGTRATRUOC}">
                                                        <select2 v-model="thuebao.didong.cboGoiCuocDD.value" class="select-custom" :options="thuebao.didong.cboGoiCuocDD.list.map(cq=>({id:cq.goicuoc_id,text:cq.tengoicuoc}))"></select2>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-5 col-12">
                                                <div class="info-row">
                                                    <div class="key w70">Chủ quản</div>
                                                    <div class="value">
                                                        <!-- <select2 v-model="listbox.chu_quan.valuedd" class="select-custom" :options="listbox.chu_quan.list.map(cq=>({id:cq.chuquan_id,text:cq.ten_tat}))"></select2> -->
                                                        <ComboboxGrid2  class="select-custom"
                                                            :columns="[
                                                            {fieldName: 'ten_tat', headerText: '', allowFiltering: true, width:'300'},
                                                            ]"
                                                            :dataSource="listbox.chu_quan.list" textField="ten_tat" valueField="chuquan_id"
                                                            :enabledSelectFirstRow="false" :value="listbox.chu_quan.valuedd"
                                                            @selectedChanged="(item)=>{if(item) { listbox.chu_quan.valuedd=item.chuquan_id; }}">
                                                        </ComboboxGrid2>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-7 col-12">
                                                <div class="info-row">
                                                    <div class="key">Đối tượng Vina</div>

                                                    <div class="value">
                                                        <select2 v-model="thuebao.didong.cboDTVinaPhone.value" class="select-custom" :options="thuebao.didong.cboDTVinaPhone.list.map(lc=>({id:lc.DOITUONG_ID_NEO,text:lc.TEN_DT_NEO}))"></select2>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-5 col-12">
                                                <div class="info-row">
                                                    <div class="key w70">Trang bị</div>
                                                    <div class="value">
                                                        <select2 v-model="listbox.trangbi.valuedd" class="select-custom" :options="listbox.trangbi.list.map(lc=>({id:lc.trangbi_id,text:lc.tentrangbi}))" @change="v=>{listbox.trangbi.valuedd=v;trangbi_id=v;LoadMucCuocTB();}"></select2>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <template v-if="listbox.kieu_ld.value==KieuLapDat.DM_DIDONG_CHUYEN_TINH">
                                            <div>
                                                <div class="legend-title mart10">Thông tin thuê bao cũ</div>
                                                <div class="row">
                                                    <div class="col-sm-7 col-12">
                                                        <div class="info-row">
                                                            <div class="key">Tên thuê bao cũ</div>
                                                            <div class="value">
                                                                <input type="text" class="form-control" :value="thuebao.didong.txtTenTBDD_Cu" @change="v=>thuebao.didong.txtTenTBDD_Cu=v.target.value">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-sm-5 col-12">
                                                        <div class="info-row">
                                                            <div class="key w70">Ngày sinh</div>
                                                            <div class="value">
                                                                <input type="text" class="form-control" :value="thuebao.didong.txtNgaySinhDD_Cu" @change="v=>thuebao.didong.txtNgaySinhDD_Cu=v.target.value">
                                                                <!-- <date-picker input-class="form-control" :format="dateFormat" :value-type="datetimeFormatFull" v-model="thuebao.didong.txtNgaySinhDD_Cu"></date-picker> -->
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-sm-7 col-12">
                                                        <div class="info-row">
                                                            <div class="key">Số giấy tờ</div>
                                                            <div class="value">
                                                            <input type="text" class="form-control" :value="thuebao.didong.txtSoGTDD_Cu" @change="v=>thuebao.didong.txtSoGTDD_Cu=v.target.value">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-sm-5 col-12">
                                                        <div class="info-row">
                                                            <div class="key w70">Ngày cấp</div>
                                                            <div class="value">
                                                                <input type="text" class="form-control" :value="thuebao.didong.txtNgayCapGTDD_Cu" @change="v=>thuebao.didong.txtNgayCapGTDD_Cu=v.target.value">
                                                                <!-- <date-picker input-class="form-control" :format="dateFormat" :value-type="datetimeFormatFull" v-model="thuebao.didong.txtNgayCapGTDD_Cu"></date-picker> -->
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="info-row">
                                                    <div class="key w120">Địa chỉ</div>
                                                    <div class="value">
                                                        <input type="text" class="form-control" :value="thuebao.didong.txtDiaChiDD_Cu" @change="v=>thuebao.didong.txtDiaChiDD_Cu=v.target.value">
                                                        <!-- <div class="input-more-button">
                                                            <button class="btn" v-b-modal.popupDiaChiTBCu>
                                                                <span class="-ap icon-more_horiz"></span>
                                                            </button>
                                                            <ModalChonDiaChi modalId="popupDiaChiTBCu" :data="diachiTBCu" :isStrictMode="true" @xacnhan="getDiaChiTBCu"/>

                                                            <bss-error-marker :has-error="$v.diachiTBCu.DIACHI.$error">
                                                                <input type="text"  v-model="$v.diachiTBCu.DIACHI.$model" class="form-control disabled">
                                                            </bss-error-marker>
                                                        </div> -->
                                                    </div>
                                                </div>
                                                <div class="info-row">
                                                    <div class="key w120">Hộ khẩu</div>
                                                    <div class="value">
                                                        <input type="text" class="form-control" :value="thuebao.didong.txtHoKhauDD_Cu" @change="v=>thuebao.didong.txtHoKhauDD_Cu=v.target.value">
                                                        <!-- <div class="input-more-button">
                                                            <button class="btn" v-b-modal.popupDiaChiHKTBCu>
                                                                <span class="-ap icon-more_horiz"></span>
                                                            </button>
                                                            <ModalChonDiaChi modalId="popupDiaChiHKTBCu" :data="diachiHKTBCu" :isStrictMode="true" @xacnhan="getDiaChiHKTBCu"/>

                                                            <bss-error-marker :has-error="$v.diachiHKTBCu.DIACHI.$error">
                                                                <input type="text"  v-model="$v.diachiHKTBCu.DIACHI.$model" class="form-control disabled">
                                                            </bss-error-marker>
                                                        </div> -->
                                                    </div>
                                                </div>
                                            </div>
                                        </template>
                                        <template v-if="1==2">
                                            <div>
                                                <div class="legend-title mart10">Chọn khuyến mại trên hệ thống Vinaphone</div>
                                                <div class="table-content" style="height: 140px;">
                                                    <DataGrid2 :columns="thuebao.didong.dgrKhuyenMai.headers" :dataSource="thuebao.didong.dgrKhuyenMai.list" :enable-paging-server="false" :allowPaging="false" :showFilter="true"></DataGrid2>
                                                </div>
                                            </div>
                                        </template>
                                    </div>
                                </div>
                                <div id="gphone" class="tab-pane" v-if="DichVuVienThong.GPHONE==listbox.dichvu_vt.value">
                                    <div class="tab-content">
                                        <div class="row">
                                            <div class="col-sm-7 col-12">
                                                <div class="info-row">
                                                    <div class="key">
                                                        Số máy
                                                    </div>
                                                    <div class="value">
                                                        <div class="input-more-button">
                                                            <button class="btn" @click="btnGphone_Click" title="Chọn số máy">
                                                                <span class="-ap icon-more_horiz"></span>
                                                            </button>
                                                            <input type="text" class="form-control" :value="thuebao.gphone.txtSoMayGP" @change="v=>thuebao.gphone.txtSoMayGP=v.target.value">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="col-sm-5 col-12">
                                                <div class="info-row">
                                                    <div class="key w60">
                                                        Số sim
                                                    </div>

                                                    <div class="value">
                                                        <input type="text" class="form-control" :value="thuebao.gphone.txtSoSimGphone" @change="v=>thuebao.gphone.txtSoSimGphone=v.target.value">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-7 col-12">
                                                <div class="info-row">
                                                    <div class="key">
                                                        Chủ quản
                                                    </div>
                                                    <div class="value">
                                                        <!-- <select2 v-model="listbox.chu_quan.valuegp" class="select-custom" :options="listbox.chu_quan.list.map(cq=>({id:cq.chuquan_id,text:cq.ten_tat}))"></select2> -->
                                                        <ComboboxGrid2  class="select-custom"
                                                            :columns="[
                                                            {fieldName: 'ten_tat', headerText: '', allowFiltering: true, width:'300'},
                                                            ]"
                                                            :dataSource="listbox.chu_quan.list" textField="ten_tat" valueField="chuquan_id"
                                                            :enabledSelectFirstRow="false" :value="listbox.chu_quan.valuegp"
                                                            @selectedChanged="(item)=>{if(item) { listbox.chu_quan.valuegp=item.chuquan_id; }}">
                                                        </ComboboxGrid2>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="col-sm-5 col-12">
                                                <div class="info-row">
                                                    <div class="key w60">
                                                        Trang bị
                                                    </div>
                                                    <div class="value">
                                                        <select2 v-model="listbox.trangbi.valuegp" class="select-custom" :options="listbox.trangbi.list.map(lc=>({id:lc.trangbi_id,text:lc.tentrangbi}))" @change="v=>{listbox.trangbi.valuegp=v;trangbi_id=v;LoadMucCuocTB();}"></select2>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="info-row" v-for="(ct,idx) in DT_CONTROLS.list" v-if="DT_CONTROLS.list.length>0">
                                            <div class="key">
                                                {{ct.TEN_LOAIDV}}
                                            </div>
                                            <div class="value">
                                                <select2 v-model="DT_CONTROLS.value[idx]" :key="DT_CONTROLS.key+'-'+idx" class="select-custom" :options="DT_DV(idx)" required></select2>
                                            </div>
                                        </div>
                                        <div class="legend-title mart10">Tiền cam kết số đẹp</div>
                                        <div class="table-content" style="height: 140px;">
                                            <!-- <DataGrid2 :columns="thuebao.gphone.dgvTienCKGP.headers" :dataSource="thuebao.gphone.dgvTienCKGP.list" :enable-paging-server="false" :allowPaging="false" :showFilter="true"></DataGrid2> -->

                                            <DataGrid :columns="thuebao.gphone.dgvTienCKGP.headers"
                                                :dataSource="thuebao.gphone.dgvTienCKGP.list"
                                                :enable-paging-server="false"
                                                :allowPaging="false"
                                                :showFilter="false"
                                                :showColumnCheckbox="false"
                                                :editSettings="tienckeditsettings"
                                                @actionComplete="dgvTienCKGP_actionComplete"
                                                :toolbar="tiencktoolbar">
                                            </DataGrid>
                                        </div>
                                    </div>
                                </div>
                                <div id="bangrong" class="tab-pane" v-if="[DichVuVienThong.ADSL, DichVuVienThong.MEGA_EYES, DichVuVienThong.HATANG_VIENTHONG, DichVuVienThong.BRCD_DOITAC].indexOf(parseInt(listbox.dichvu_vt.value))>=0">
                                    <div class="tab-content">
                                        <div class="row">
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key">Account</div>
                                                    <div class="value">
                                                        <div class="input-more-button">
                                                            <button class="btn" @click.prevent="btnKiemTraAccount_Click" v-if="thuebao.adsl.btnKiemTraAccount_visible" title="Kiểm tra  Account trên công ty dọc">
                                                                <span class="one-check f20" :class="{invalid:!thuebao.adsl.validadslacc}"></span>
                                                            </button>
                                                            <input type="text" class="form-control" maxlength="32" :value="thuebao.adsl.txtAccountADSL" @change="txtAccountADSL_TextChanged" :readonly="thuebao.adsl.txtAccountADSL_ReadOnly" title="Account không được dài quá 32 ký tự!">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w90">Số ảo</div>
                                                    <div class="value">
                                                        <div class="input-more-button" :class="{disabled:TUDONG_SINH_SOAO}">
                                                            <button class="btn" @click.prevent="btnChonSoAoAdsl_Click">
                                                                <span class="-ap icon-more_horiz"></span>
                                                            </button>
                                                            <input type="text" class="form-control disabled" :value="thuebao.adsl.txtSoAoAdsl" :required="!TUDONG_SINH_SOAO" title="Vui lòng nhập số ảo" @change="v=>thuebao.adsl.txtSoAoAdsl=v.target.value">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w80">Hạn đặt chỗ</div>
                                                    <div class="value">
                                                        <div class="input-icon-right" :class="{disabled:!thuebao.adsl.dtpHanDatCho_Visible}">
                                                            <date-picker input-class="form-control" :format="datetimeFormat" :value-type="'format'" v-model="thuebao.adsl.dtpHanDatCho"></date-picker>
                                                            <span class="icon one-calendar"></span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key">Mã TN</div>
                                                    <div class="value">
                                                        <div class="input-more-button">
                                                            <button class="btn" @click.prevent="popupMaTNADSL" :class="{disabled:kieu_ld_kieu==0}" title="Chọn mã truy nhập">
                                                                <span class="-ap icon-more_horiz"></span>
                                                            </button>
                                                            <input type="text" class="form-control disabled" :value="thuebao.adsl.txtMaTN_ADSL" @change="v=>thuebao.adsl.txtMaTN_ADSL=v.target.value">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w90">
                                                        <div class="check-action">
                                                            <input type="checkbox" class="check" v-model="listbox.doitac.ischeckedadsl">
                                                            <span class="name">Đối tác</span>
                                                        </div>
                                                    </div>
                                                    <div class="value" :class="{disabled: !listbox.doitac.ischeckedadsl}">
                                                        <!-- <select2 v-model="listbox.doitac.valueinternet" class="select-custom" :options="listbox.doitac.list.map(dt=>({id:dt.doitac_id,text:dt.ten_dt}))"></select2> -->
                                                        <ComboboxGrid2  class="select-custom"
                                                            :columns="[
                                                            {fieldName: 'ten_dt', headerText: '', allowFiltering: true, width:'300'},
                                                            ]"
                                                            :dataSource="listbox.doitac.list" textField="ten_dt" valueField="doitac_id"
                                                            :enabledSelectFirstRow="false" :value="listbox.doitac.valueinternet"
                                                            @selectedChanged="(item)=>{if(item) { listbox.doitac.valueinternet=item.doitac_id; }}">
                                                        </ComboboxGrid2>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w80">Trang bị</div>
                                                    <div class="value">
                                                        <select2 v-model="listbox.trangbi.valueadsl" class="select-custom" :options="listbox.trangbi.list.map(lc=>({id:lc.trangbi_id,text:lc.tentrangbi}))" @change="v=>{listbox.trangbi.valueadsl=v;trangbi_id=v;LoadMucCuocTB();HT_DS_KhuyenMai_Combobox();}"></select2>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key">Tốc độ</div>
                                                    <div class="value">
                                                        <div class="select-custom">
                                                            <!-- <select2 v-model="listbox.cboGoiCuocAdsl.value" class="select-custom" :options="listbox.cboGoiCuocAdsl.list.map(mc=>({id:mc.tocdo_id,text:mc.ma_td}))" @change="cboGoiCuocAdsl_SelectedValueChanged"></select2> -->
                                                            <ComboboxGrid2  class="select-custom headers tocdo"
                                                                :columns="[
                                                                {fieldName: 'ma_td', headerText: 'Mã TĐ', allowFiltering: true, width:'100'},
                                                                {fieldName: 'thuonghieu', headerText: 'Thương hiệu', allowFiltering: true, width:'200'},
                                                                {fieldName: 'iptinh', headerText: 'IP tĩnh', allowFiltering: true, width:'50'},
                                                                {fieldName: 'congnghe', headerText: 'Công nghệ', allowFiltering: true, width:'50'},
                                                                {fieldName: 'tocdothuc', headerText: 'Tốc độ thực', allowFiltering: true, width:'50'},
                                                                {fieldName: 'tocdo_down', headerText: 'Tốc độ down', allowFiltering: true, width:'50'},
                                                                {fieldName: 'tocdo_up', headerText: 'Tốc độ up', allowFiltering: true, width:'50'},
                                                                ]"
                                                                :dataSource="listbox.cboGoiCuocAdsl.list" textField="thuonghieu" valueField="tocdo_id" :showColumnCheckbox="false"
                                                                :value="listbox.cboGoiCuocAdsl.value" :enabledSelectFirstRow="false"
                                                                @selectedChanged="(item)=>{listbox.cboGoiCuocAdsl.value=item.tocdo_id;cboGoiCuocAdsl_SelectedValueChanged(item.tocdo_id);}">
                                                            </ComboboxGrid2>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w90">
                                                        Cước đối tác
                                                    </div>
                                                    <div class="value">
                                                        <vue-numeric class="form-control tright fw6" separator="." decimal-separator="," :precision="is_nv_vnpti==1?2:0" :value="thuebao.adsl.txtCuocDT_Internet" @change="v=>thuebao.adsl.txtCuocDT_Internet=v.target.value" placeholder="0" output-type="Number" title="Cước đối tác, chưa VAT"></vue-numeric>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w80">Mức cước</div>
                                                    <div class="value" :class="{disabled: !listbox.muccuoc.isenabled }">
                                                        <select2 v-model="listbox.muccuoc.value" class="select-custom" :options="listbox.muccuoc.list.map(mc=>({id:mc.muccuoc_id,text:mc.tenmuc}))"></select2>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key">
                                                        <div class="check-action" title="Check nếu chọn tốc độ thực">
                                                            <input type="checkbox" class="check" value="1" v-model="nhap_tocdo_thuc_adsl">
                                                            <span class="name">Tốc độ thực</span>
                                                        </div>
                                                    </div>
                                                    <div class="value">
                                                        <div class="select-custom" :class="{disabled:nhap_tocdo_thuc_adsl!=1}">
                                                            <!-- <select2 v-model="listbox.cboTocDoThucADSL.value" class="select-custom" :options="listbox.cboTocDoThucADSL.list.map(cq=>({id:cq.tocdo_id,text:cq.thuonghieu}))"></select2> -->
                                                            <ComboboxGrid2  class="select-custom headers tocdo"
                                                                :columns="[
                                                                {fieldName: 'ma_td', headerText: 'Mã TĐ', allowFiltering: true, width:'100'},
                                                                {fieldName: 'thuonghieu', headerText: 'Thương hiệu', allowFiltering: true, width:'200'},
                                                                {fieldName: 'iptinh', headerText: 'IP tĩnh', allowFiltering: true, width:'50'},
                                                                {fieldName: 'congnghe', headerText: 'Công nghệ', allowFiltering: true, width:'50'},
                                                                {fieldName: 'tocdothuc', headerText: 'Tốc độ thực', allowFiltering: true, width:'50'},
                                                                {fieldName: 'tocdo_down', headerText: 'Tốc độ down', allowFiltering: true, width:'50'},
                                                                {fieldName: 'tocdo_up', headerText: 'Tốc độ up', allowFiltering: true, width:'50'},
                                                                ]"
                                                                :dataSource="listbox.cboTocDoThucADSL.list" textField="thuonghieu" valueField="tocdo_id" :showColumnCheckbox="false"
                                                                :value="listbox.cboTocDoThucADSL.value" :enabledSelectFirstRow="false"
                                                                @selectedChanged="(item)=>{listbox.cboTocDoThucADSL.value=item.tocdo_id;}">
                                                            </ComboboxGrid2>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w90">
                                                        Chủ quản
                                                    </div>
                                                    <div class="value">
                                                        <!-- <select2 v-model="listbox.chu_quan.valueadsl" class="select-custom" :options="listbox.chu_quan.list.map(cq=>({id:cq.chuquan_id,text:cq.ten_tat}))"></select2> -->
                                                        <ComboboxGrid2  class="select-custom"
                                                            :columns="[
                                                            {fieldName: 'ten_tat', headerText: '', allowFiltering: true, width:'300'},
                                                            ]"
                                                            :dataSource="listbox.chu_quan.list" textField="ten_tat" valueField="chuquan_id"
                                                            :enabledSelectFirstRow="false" :value="listbox.chu_quan.valueadsl"
                                                            @selectedChanged="(item)=>{if(item) { listbox.chu_quan.valueadsl=item.chuquan_id; }}">
                                                        </ComboboxGrid2>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w80">Đvi LĐ</div>
                                                    <div class="value">
                                                        <ComboboxGrid2  class="select-custom"
                                                            :columns="[
                                                            {fieldName: 'ten_tat', headerText: '', allowFiltering: true, width:'300'},
                                                            ]"
                                                            :dataSource="listbox.chu_quan.list" textField="ten_tat" valueField="chuquan_id"
                                                            :enabledSelectFirstRow="false" :value="listbox.chu_quan.valueldadsl"
                                                            @selectedChanged="(item)=>{if(item) { listbox.chu_quan.valueldadsl=item.chuquan_id; }}">
                                                        </ComboboxGrid2>
                                                        <!-- <select2 v-model="listbox.chu_quan.valueldadsl" class="select-custom" :options="listbox.chu_quan.list.map(cq=>({id:cq.chuquan_id,text:cq.ten_tat}))"></select2> -->
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key">
                                                        Thời hạn
                                                    </div>
                                                    <div class="value">
                                                        <select2 v-model="listbox.thoihan.valueadsl" class="select-custom" :options="listbox.thoihan.list.map(th=>({id:th.thoihan_id,text:th.tenthoihan}))"></select2>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12" :class="{disabled:listbox.thoihan.valueadsl!=ThoiHan.Ngan_Han}">
                                                <button class="btn btn-second fullw" @click.prevent="$bvModal.show('modal-tgthue');">
                                                    <span class="one-file-edit f20 vcenter inline"></span> TG thuê
                                                </button>
                                                <b-modal id="modal-tgthue" title="Thời gian thuê ngắn hạn" ok-title="Chấp nhận" cancel-title="Thoát" @ok="kt_thuenganhan=true"><!-- @ok="handleOk" -->
                                                    <div class="key">Từ ngày</div><div class="value"><date-picker input-class="form-control" :format="datetimeFormatFull" :value-type="'format'" v-model="TGThueTuNgay"></date-picker></div>
                                                    <div class="key">Đến ngày</div><div class="value"><date-picker input-class="form-control" :format="datetimeFormatFull" :value-type="'format'" v-model="TGThueDenNgay"></date-picker></div>
                                                </b-modal>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w80">Loại thiết bị</div>
                                                    <div class="value">
                                                        <div class="select-custom">
                                                            <select2 v-model="listbox.cboLoaiTB.value" class="select-custom" :options="listbox.cboLoaiTB.list.map(th=>({id:th.thietbidc_id,text:th.ten_tbi}))"></select2>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="info-row" v-if="!(listbox.loaihinh_tb.value == LoaiHinhTB.INTERNET_MYTV || listbox.loaihinh_tb.value == LoaiHinhTB.INTERNET_MYTV_B2B || listbox.loaihinh_tb.value == LoaiHinhTB.HTVC_FIBERVNN_ANALOG || listbox.loaihinh_tb.value == LoaiHinhTB.HTVC_FIBERVNN_DIGITAL
                                        || listbox.loaihinh_tb.value == LoaiHinhTB.MEGACAMERA || listbox.loaihinh_tb.value == LoaiHinhTB.FSECURE || listbox.loaihinh_tb.value == LoaiHinhTB.INTERNET_ADSL_TINH_KHAC || listbox.loaihinh_tb.value == LoaiHinhTB.INTERNET_FIBER_TINH_KHAC)">
                                            <div class="key">Email ADSL</div>
                                            <div class="value">
                                                <input type="text" class="form-control " :value="thuebao.adsl.txtEmailAdsl" @change="v=>thuebao.adsl.txtEmailAdsl=v.target.value" maxlength="32" title="Email không được dài quá 32 ký tự!">
                                            </div>
                                        </div>
                                        <div class="info-row" v-if="(listbox.loaihinh_tb.value == LoaiHinhTB.INTERNET_FTTH || listbox.loaihinh_tb.value == LoaiHinhTB.WIFI_FIBER || listbox.loaihinh_tb.value == LoaiHinhTB.INTERNET_ADSL)&&listbox.loaihinh_tb.value!=LoaiHinhTB.MEGA_IOT">
                                            <div class="key">Loại IP</div>
                                            <div class="value">
                                                <!-- <select2 v-model="listbox.cboLoaiIP.value" class="select-custom" :options="listbox.cboLoaiIP.list.map(lo=>({id:lo.loaiip_id,text:lo.loai_ip}))"></select2> -->
                                                <multiselect v-model="listbox.cboLoaiIP.valueitems" :options="listbox.cboLoaiIP.list.map(lo=>({id:lo.loaiip_id,text:lo.loai_ip}))" label="text" track-by="id" :multiple="true" @input="()=>{listbox.cboLoaiIP.values = listbox.cboLoaiIP.valueitems.map(x=>x.id);}"></multiselect>
                                                <!-- <ComboboxGrid2  class="select-custom"
                                                    :columns="[
                                                    {fieldName: 'loaiip_id', headerText: '', allowFiltering: true, width:'50'},
                                                    {fieldName: 'loai_ip', headerText: '', allowFiltering: true, width:'200'}
                                                    ]"
                                                    :dataSource="listbox.cboLoaiIP.list" textField="loai_ip" valueField="loaiip_id" :showColumnCheckbox="true"
                                                    @selectedItemChanged="(items)=>{listbox.cboLoaiIP.values=items;}">
                                                </ComboboxGrid2> -->
                                            </div>
                                        </div>
                                        <div class="row" v-if="listbox.loaihinh_tb.value==LoaiHinhTB.MEGA_IOT">
                                            <div class="col-sm-8 col-12">
                                                <div class="info-row">
                                                    <div class="key">Loại IP</div>
                                                    <div class="value">
                                                        <!-- <select2 v-model="listbox.cboLoaiIP.value" class="select-custom" :options="listbox.cboLoaiIP.list.map(lo=>({id:lo.loaiip_id,text:lo.loai_ip}))"></select2> -->
                                                        <multiselect v-model="listbox.cboLoaiIP.valueitems" :options="listbox.cboLoaiIP.list.map(lo=>({id:lo.loaiip_id,text:lo.loai_ip}))" label="text" track-by="id" :multiple="true" @input="()=>{listbox.cboLoaiIP.values = listbox.cboLoaiIP.valueitems.map(x=>x.id);}"></multiselect>
                                                        <!-- <ComboboxGrid2  class="select-custom"
                                                            :columns="[
                                                            {fieldName: 'loaiip_id', headerText: '', allowFiltering: true, width:'50'},
                                                            {fieldName: 'loai_ip', headerText: '', allowFiltering: true, width:'200'}
                                                            ]"
                                                            :dataSource="listbox.cboLoaiIP.list" textField="loai_ip" valueField="loaiip_id" :showColumnCheckbox="true"
                                                            @selectedItemChanged="(items)=>{listbox.cboLoaiIP.values=items;}">
                                                        </ComboboxGrid2> -->
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="value nowrap">
                                                        <button class="btn btn-second" @click="clickOpenKenhIOT">
                                                            Kênh IOT
                                                        </button>
                                                    </div>
                                                    <div class="value">
                                                        <input type="text" readonly class="form-control highlight"  :value="thuebao.adsl.txtMaTB_KN" @change="v=>thuebao.adsl.txtMaTB_KN=v.target.value">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="info-row" v-if="(listbox.loaihinh_tb.value == LoaiHinhTB.INTERNET_FTTH || listbox.loaihinh_tb.value == LoaiHinhTB.WIFI_FIBER || listbox.loaihinh_tb.value == LoaiHinhTB.INTERNET_ADSL) && 1==2">
                                            <div class="key">Thông tin TC</div>
                                            <div class="value">
                                                <div class="input-more-button">
                                                    <button class="btn" @click.prevent="btnThongTinTC_Click" title="Chọn thông tin tính cước">
                                                        <span class="-ap icon-more_horiz"></span>
                                                    </button>
                                                    <textarea class="form-control" :class="{disabled:(listbox.loaihinh_tb.value == LoaiHinhTB.INTERNET_FTTH || listbox.loaihinh_tb.value == LoaiHinhTB.WIFI_FIBER || listbox.loaihinh_tb.value == LoaiHinhTB.INTERNET_ADSL || 1==1)}" rows="3" width="100" v-model="thuebao.adsl.txtTTCuoc" title="Thông tin tính cước FTTH"></textarea>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="info-row" v-if="(listbox.loaihinh_tb.value == LoaiHinhTB.COSO_HATANG)">
                                            <div class="key">Loại CSHT</div>
                                            <div class="value">
                                                <select2 v-model="listbox.cboLoai_CSHT.value" class="select-custom" :options="listbox.cboLoai_CSHT.list.map(lo=>({id:lo.loai_csht_id,text:lo.ten_loai_csht}))"></select2>
                                            </div>
                                        </div>
                                        <div class="info-row" v-if="(listbox.loaihinh_tb.value == LoaiHinhTB.COSO_HATANG)">
                                            <div class="key">Đối tác CSHT</div>
                                            <div class="value">
                                                <select2 v-model="listbox.cboDoiTac_CSHT.value" class="select-custom" :options="listbox.cboDoiTac_CSHT.list.map(dt=>({id:dt.doitac_id,text:dt.ten_dt}))"></select2>
                                            </div>
                                        </div>
                                        <div class="info-row" v-if="(listbox.loaihinh_tb.value == LoaiHinhTB.FSECURE)">
                                            <div class="key">Điện thoại</div>
                                            <div class="value">
                                                <input type="text" class="form-control " :value="thuebao.adsl.txtDienThoai_Fsecure" @change="v=>thuebao.adsl.txtDienThoai_Fsecure=v.target.value">
                                            </div>
                                        </div>
                                        <div class="info-row" v-if="(listbox.loaihinh_tb.value == LoaiHinhTB.HTVC_FIBERVNN_ANALOG || listbox.loaihinh_tb.value == LoaiHinhTB.HTVC_FIBERVNN_DIGITAL
                                        || listbox.loaihinh_tb.value == LoaiHinhTB.MEGACAMERA)">
                                            <div class="key">Số lượng TV</div>
                                            <div class="value">
                                                <vue-numeric class="form-control tright fw6" separator="." :value="thuebao.adsl.txtSL_Tivi" @change="v=>thuebao.adsl.txtSL_Tivi=v.target.value" placeholder="0" output-type="Number"></vue-numeric>
                                            </div>
                                        </div>
                                        <div class="row" v-if="(listbox.loaihinh_tb.value == LoaiHinhTB.INTERNET_MYTV || listbox.loaihinh_tb.value == LoaiHinhTB.INTERNET_MYTV_B2B)">
                                            <div class="col-sm-8 col-12">
                                                <div class="info-row">
                                                    <div class="key">
                                                        <div class="check-action" title="VMP(Hệ thống truyền hình trên nền tảng đa màn hình)">
                                                            <input type="checkbox" class="check" value="1" v-model="cbvmp" @change="chkVMP_CheckedChanged">
                                                            <span class="name">VMP(Hệ thống truyền hình trên nền tảng đa màn hình)</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w80">
                                                        <input type="radio" id="one" value="0" v-model="thuebao.adsl.isHopDong" /> Danh bạ
                                                    </div>
                                                    <div class="value">
                                                        <div class="select-custom">
                                                            <select2 v-model="listbox.cboDbChinh.value" class="select-custom" :options="listbox.cboDbChinh.list.map(th=>({id:th.thuebao_id,text:th.ma_tb}))"></select2>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="row" v-if="(listbox.loaihinh_tb.value == LoaiHinhTB.INTERNET_ADSL_TINH_KHAC || listbox.loaihinh_tb.value == LoaiHinhTB.INTERNET_FIBER_TINH_KHAC)">
                                            <div class="col-sm-8 col-12">
                                                <div class="info-row">
                                                    <div class="key">
                                                        Cước sử dụng
                                                    </div>
                                                    <div class="value">
                                                        <vue-numeric class="form-control tright fw6" separator="." decimal-separator="," :precision="is_nv_vnpti==1?2:0" :value="thuebao.adsl.txtCSD_FIBER_TK" @change="v=>thuebao.adsl.txtCSD_FIBER_TK=v.target.value" placeholder="0" output-type="Number"></vue-numeric>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w80">
                                                        Cước T.bị
                                                    </div>
                                                    <div class="value">
                                                        <vue-numeric class="form-control tright fw6" separator="." decimal-separator="," :precision="is_nv_vnpti==1?2:0" :value="thuebao.adsl.txtCTB_FIBER_TK" @change="v=>thuebao.adsl.txtCTB_FIBER_TK=v.target.value" placeholder="0" output-type="Number"></vue-numeric>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="row" v-if="(listbox.loaihinh_tb.value == LoaiHinhTB.INTERNET_MYTV || listbox.loaihinh_tb.value == LoaiHinhTB.INTERNET_MYTV_B2B)">
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key">
                                                        Kiểu trả
                                                    </div>
                                                    <div class="value">
                                                        <select2 v-model="listbox.cboKieuTra.value" class="select-custom" :options="listbox.cboKieuTra.list.map(th=>({id:th.kieutra_id,text:th.tenkieu}))"></select2>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key">
                                                        Serial UMP
                                                    </div>
                                                    <div class="value">
                                                        <input type="text" class="form-control " :value="thuebao.adsl.txtSerialSTB" @change="v=>thuebao.adsl.txtSerialSTB=v.target.value">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w80">
                                                        <input type="radio" id="one" value="1" v-model="thuebao.adsl.isHopDong" /> Hợp đồng
                                                    </div>
                                                    <div class="value">
                                                        <div class="select-custom">
                                                            <select2 v-model="listbox.cboHDChinh.value" class="select-custom" :options="listbox.cboHDChinh.list.map(th=>({id:th.hdtb_id,text:th.ma_tb}))"></select2>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row" v-if="listbox.cboKieuTra.value==1 && (listbox.loaihinh_tb.value == LoaiHinhTB.INTERNET_MYTV || listbox.loaihinh_tb.value == LoaiHinhTB.INTERNET_MYTV_B2B)">
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key">
                                                        Tiền trả trước
                                                    </div>
                                                    <div class="value">
                                                        <vue-numeric class="form-control tright" separator="." decimal-separator="," :precision="is_nv_vnpti==1?2:0" :value="thuebao.adsl.tientra" @change="v=>thuebao.adsl.tientra=v.target.value" placeholder="0" output-type="Number"></vue-numeric>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key">
                                                        Ngày bắt đầu
                                                    </div>
                                                    <div class="value">
                                                        <date-picker input-class="form-control" :format="datetimeFormat" :value-type="'format'" v-model="thuebao.adsl.dtpNgayTra"></date-picker>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w80">
                                                        Thời gian
                                                    </div>
                                                    <div class="value">
                                                        <div class="select-custom">
                                                            <select2 v-model="listbox.cboThangTra.value" class="select-custom" :options="listbox.cboThangTra.list.map(th=>({id:th.thang_id,text:th.tenthang}))"></select2>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="info-row" v-for="(ct,idx) in DT_CONTROLS.list" v-if="DT_CONTROLS.list.length>0">
                                            <div class="key">
                                                {{ct.TEN_LOAIDV}}
                                            </div>
                                            <div class="value">
                                                <select2 v-model="DT_CONTROLS.value[idx]" :key="DT_CONTROLS.key+'-'+idx" class="select-custom" :options="DT_DV(idx)" required></select2>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="ims" class="tab-pane" v-if="[DichVuVienThong.IMS, DichVuVienThong.IMS_DOITAC].indexOf(parseInt(listbox.dichvu_vt.value))>=0">
                                    <div class="tab-content">
                                        <div class="row">
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key">Số máy</div>
                                                    <div class="value">
                                                        <div class="input-more-button">
                                                            <button class="btn" :class="{disabled:!buttons.btnChonSoIMS}" @click.prevent="btnChonSoIMS_Click" title="Chọn số máy">
                                                                <span class="-ap icon-more_horiz"></span>
                                                            </button>
                                                            <input type="text" class="form-control disabled" :value="thuebao.ims.txtMaTBIMS" @change="v=>thuebao.ims.txtMaTBIMS=v.target.value">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-2 col-12">
                                                <div class="info-row">
                                                    <div class="key w30 nowrap">Chủ quản</div>
                                                    <div class="value">
                                                        <!-- <select2 v-model="listbox.chu_quan.valueims" class="select-custom" :options="listbox.chu_quan.list.map(cq=>({id:cq.chuquan_id,text:cq.ten_tat}))"></select2> -->

                                                        <ComboboxGrid2  class="select-custom"
                                                            :columns="[
                                                            {fieldName: 'ten_tat', headerText: '', allowFiltering: true, width:'300'},
                                                            ]"
                                                            :dataSource="listbox.chu_quan.list" textField="ten_tat" valueField="chuquan_id"
                                                            :enabledSelectFirstRow="false" :value="listbox.chu_quan.valueims"
                                                            @selectedChanged="(item)=>{if(item) { listbox.chu_quan.valueims=item.chuquan_id; }}">
                                                        </ComboboxGrid2>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key">Thời hạn</div>
                                                    <div class="value w30 nowrap" :class="{disabled:listbox.thoihan.valueims!=ThoiHan.Ngan_Han}">
                                                        <button class="btn btn-second fullw" @click.prevent="$bvModal.show('modal-tgthue');">
                                                            <span class="one-file-edit f20 vcenter inline"></span> TG thuê
                                                        </button>
                                                        <b-modal id="modal-tgthue" title="Thời gian thuê ngắn hạn" ok-title="Chấp nhận" cancel-title="Thoát" @ok="kt_thuenganhan=true"><!-- @ok="handleOk" -->
                                                            <div class="key">Từ ngày</div><div class="value"><date-picker input-class="form-control" :format="datetimeFormatFull" :value-type="'format'" v-model="TGThueTuNgay"></date-picker></div>
                                                            <div class="key">Đến ngày</div><div class="value"><date-picker input-class="form-control" :format="datetimeFormatFull" :value-type="'format'" v-model="TGThueDenNgay"></date-picker></div>
                                                        </b-modal>
                                                    </div>
                                                    <div class="value">
                                                        <select2 v-model="listbox.thoihan.valueims" class="select-custom" :options="listbox.thoihan.list.map(th=>({id:th.thoihan_id,text:th.tenthoihan}))"></select2>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-2 col-12">
                                                <div class="info-row">
                                                    <div class="key w60">Đvi LĐ</div>

                                                    <div class="value">
                                                        <!-- <select2 v-model="listbox.chu_quan.valueldims" class="select-custom" :options="listbox.chu_quan.list.map(cq=>({id:cq.chuquan_id,text:cq.ten_tat}))"></select2> -->

                                                        <ComboboxGrid2  class="select-custom"
                                                            :columns="[
                                                            {fieldName: 'ten_tat', headerText: '', allowFiltering: true, width:'300'},
                                                            ]"
                                                            :dataSource="listbox.chu_quan.list" textField="ten_tat" valueField="chuquan_id"
                                                            :enabledSelectFirstRow="false" :value="listbox.chu_quan.valueldims"
                                                            @selectedChanged="(item)=>{if(item) { listbox.chu_quan.valueldims=item.chuquan_id; }}">
                                                        </ComboboxGrid2>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-6 col-12">
                                                <div class="info-row">
                                                    <div class="key">Mã TN</div>
                                                    <div class="value">
                                                        <div class="input-more-button">
                                                            <button class="btn" @click.prevent="btnMaTN_IMS_Click" :class="{disabled:!(kieu_ld_kieu==1 || kieu_ld_kieu==2 || kieu_ld_kieu==4)}" title="Chọn mã truy nhập">
                                                                <span class="-ap icon-more_horiz"></span>
                                                            </button>
                                                            <input type="text" class="form-control " :value="thuebao.ims.txtMaTN_IMS" @change="v=>thuebao.ims.txtMaTN_IMS=v.target.value">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key">Cuộc gọi Đ.Thời</div>

                                                    <div class="value">
                                                        <vue-numeric class="form-control highlight tright" separator="." v-model="thuebao.ims.txtCuocGoiDT" placeholder="0" output-type="Number" title="Số lượng cuộc gọi đồng thời"></vue-numeric>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-2 col-12">
                                                <div class="info-row">
                                                    <div class="key w60">Trang bị</div>

                                                    <div class="value">
                                                        <select2 v-model="listbox.trangbi.valueims" class="select-custom" :options="listbox.trangbi.list.map(lc=>({id:lc.trangbi_id,text:lc.tentrangbi}))" @change="v=>{listbox.trangbi.valueims=v;trangbi_id=v;LoadMucCuocTB();}"></select2>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-6 col-12">
                                                <div class="info-row">
                                                    <div class="key">Chi tiết DV</div>
                                                    <div class="value">
                                                        <select2 v-model="listbox.ht_chitietdv_ims.value" class="select-custom" :options="listbox.ht_chitietdv_ims.list.map(ct=>({id:ct.ctdv_id,text:ct.chitiet_dv}))"></select2>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key">Cước đối tác</div>

                                                    <div class="value">
                                                        <vue-numeric class="form-control tright" separator="." decimal-separator="," :precision="is_nv_vnpti==1?2:0" v-model="thuebao.ims.txtCuocDT_IMS" placeholder="0" output-type="Number" title="Cước đối tác, chưa VAT"></vue-numeric>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-2 col-12">
                                                <div class="info-row">
                                                    <div class="key w60">IP</div>

                                                    <div class="value">
                                                        <input type="text" class="form-control highlight" :value="thuebao.ims.txtIp_IMS" @change="v=>thuebao.ims.txtIp_IMS=v.target.value" title="Địa chỉ IP của khách hàng">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-6 col-12">
                                                <div class="info-row">
                                                    <div class="key">
                                                        <div class="check-action">
                                                            <input type="checkbox" class="check" v-model="thuebao.ims.chkDoiTac_IMS">
                                                            <span class="name">Đối tác</span>
                                                        </div>
                                                    </div>
                                                    <div class="value" :class="{disabled:!thuebao.ims.chkDoiTac_IMS}">
                                                        <!-- <select2 v-model="listbox.doitac.valueims" class="select-custom" :options="listbox.doitac.list.map(dt=>({id:dt.doitac_id,text:dt.ten_dt}))"></select2> -->
                                                        <ComboboxGrid2  class="select-custom"
                                                            :columns="[
                                                            {fieldName: 'ten_dt', headerText: '', allowFiltering: true, width:'300'},
                                                            ]"
                                                            :dataSource="listbox.doitac.list" textField="ten_dt" valueField="doitac_id"
                                                            :enabledSelectFirstRow="false" :value="listbox.doitac.valueims"
                                                            @selectedChanged="(item)=>{if(item) { listbox.doitac.valueims=item.doitac_id; }}">
                                                        </ComboboxGrid2>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key">
                                                        <div class="check-action">
                                                            <input type="checkbox" class="check" v-model="thuebao.ims.cbkTrunk">
                                                            <span class="name">Đường trunk</span>
                                                        </div>
                                                    </div>

                                                    <div class="value" :class="{disabled:!thuebao.ims.cbkTrunk}">
                                                        <!-- <div class="select-custom"> -->
                                                            <ComboboxGrid2  class="select-custom"
                                                                :columns="[
                                                                {fieldName: 'trunkid', headerText: 'Mã đường trunk', allowFiltering: true, width:'70'},
                                                                {fieldName: 'ma_tb', headerText: 'Thuê bao đại diện', allowFiltering: true, width:'300'}
                                                                ]"
                                                                :dataSource="thuebao.ims.cboTrunk.list" textField="ma_tb" valueField="trunkid"
                                                                :enabledSelectFirstRow="false" :value="thuebao.ims.cboTrunk.value"
                                                                @selectedChanged="(item)=>{if(item) { thuebao.ims.cboTrunk.value=item.trunkid; }}">
                                                            </ComboboxGrid2>
                                                            <!-- <select2 v-model="thuebao.ims.cboTrunk.value" class="select-custom" :options="thuebao.ims.cboTrunk.list.filter(ht=>(ht.httc_id==2 || ht.httc_id==3)).map(ht=>({id:ht.httc_id,text:ht.hinhthuc_tc}))"></select2> -->
                                                        <!-- </div> -->
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-2 col-12">
                                                <div class="info-row">
                                                    <div class="key w60" title="Hình thức tính cước hàng tháng">HTTC</div>

                                                    <div class="value">
                                                        <select2 v-model="listbox.hinhthuc_tc.valueims" class="select-custom" :options="listbox.hinhthuc_tc.list.filter(ht=>(ht.httc_id==2 || ht.httc_id==3)).map(ht=>({id:ht.httc_id,text:ht.hinhthuc_tc}))"></select2>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="info-row" v-for="(ct,idx) in DT_CONTROLS.list" v-if="DT_CONTROLS.list.length>0">
                                            <div class="key">
                                                {{ct.TEN_LOAIDV}}
                                            </div>
                                            <div class="value">
                                                <select2 v-model="DT_CONTROLS.value[idx]" :key="DT_CONTROLS.key+'-'+idx" class="select-custom" :options="DT_DV(idx)" required></select2>
                                            </div>
                                        </div>
                                        <div class="legend-title mart10">Tiền cam kết số đẹp</div>
                                        <!-- <DataGrid2 :columns="thuebao.ims.dgvTienCKIMS.headers" :dataSource="thuebao.ims.dgvTienCKIMS.list" :enable-paging-server="false" :allowPaging="false" :showFilter="true"></DataGrid2> -->

                                        <DataGrid :columns="thuebao.ims.dgvTienCKIMS.headers"
                                        :dataSource="thuebao.ims.dgvTienCKIMS.list"
                                        :enable-paging-server="false"
                                        :allowPaging="false"
                                        :showFilter="false"
                                        :showColumnCheckbox="false"
                                        :editSettings="tienckeditsettings"
                                        @actionComplete="dgvTienCKIMS_actionComplete"
                                        :toolbar="tiencktoolbar">
                                    </DataGrid>
                                    </div>
                                </div>
                                <div id="mgwan" class="tab-pane" v-if="[DichVuVienThong.MEGAWAN, DichVuVienThong.METRONET, DichVuVienThong.NOIBO_DADIEM, DichVuVienThong.MGW_DOITAC].indexOf(parseInt(listbox.dichvu_vt.value))>=0">
                                    <div class="tab-content">
                                        <div class="row">
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key">
                                                        Số máy
                                                    </div>
                                                    <div class="value">
                                                        <input type="text" class="form-control highlight" :value="thuebao.mgwan.somay" @change="v=>thuebao.mgwan.somay=v.target.value">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w90">
                                                        Số ảo
                                                    </div>
                                                    <div class="value">
                                                        <div class="input-more-button" :class="{disabled:TUDONG_SINH_SOAO}">
                                                            <button class="btn" @click.prevent="btnSoAoWan_Click">
                                                                <span class="-ap icon-more_horiz"></span>
                                                            </button>
                                                            <input type="text" class="form-control disabled" :value="thuebao.mgwan.soao" :required="!TUDONG_SINH_SOAO" title="Vui lòng nhập số ảo" @change="v=>thuebao.mgwan.soao=v.target.value">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w90">
                                                        Mã TN
                                                    </div>
                                                    <div class="value">
                                                        <div class="input-more-button">
                                                            <button class="btn" @click.prevent="popupMaTNMGWAN" :class="{disabled:!(kieu_ld_kieu==1 || kieu_ld_kieu==2 || kieu_ld_kieu==4)}" title="Chọn mã truy nhập">
                                                                <span class="-ap icon-more_horiz"></span>
                                                            </button>
                                                            <input type="text" class="form-control"  :value="thuebao.mgwan.matn" @change="v=>thuebao.mgwan.matn=v.target.value">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key">
                                                        Loại node
                                                    </div>
                                                    <div class="value">
                                                        <div class="select-custom">
                                                            <select2 v-model="loaisowan" :options="[{id:1,text:'Node chính'},{id:2,text:'Node phụ'},{id:3,text:'Node dự phòng cổng + tốc độ'},{id:4,text:'Node dự phòng tốc độ'},]" @change="cboLoaiSoWan_SelectedValueChanged">
                                                            </select2>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w90">
                                                        Site ID
                                                    </div>
                                                    <div class="value">
                                                        <div class="input-more-button">
                                                            <button class="btn" @click.prevent="btnSite_ID_Click">
                                                                <span class="-ap icon-more_horiz"></span>
                                                            </button>
                                                            <input type="text" class="form-control"  :value="thuebao.mgwan.siteid" @change="v=>thuebao.mgwan.siteid=v.target.value">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w90">
                                                        Mã HĐ-TTKD
                                                    </div>
                                                    <div class="value">
                                                        <input type="text" class="form-control" :value="thuebao.mgwan.mahdttkd" @change="v=>thuebao.mgwan.mahdttkd=v.target.value">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key">
                                                        {{ (loaisowan*1==LOAINODE_MGWAN.NODE_DUPHONG_CONG_TOCDO || loaisowan*1==LOAINODE_MGWAN.NODE_DUPHONG_TOCDO)?"Node chính":"Hướng KN" }}
                                                    </div>
                                                    <div class="value" :class="{disabled:buttons.btnHuongKNWan}">
                                                        <div class="input-more-button">
                                                            <button class="btn" @click.prevent="popupDSHuongKN"><!-- Link qua popup cua TIENNV src\modules\contract\setup\DeclareMegawan -->
                                                                <span class="-ap icon-more_horiz"></span>
                                                            </button>
                                                            <input type="text" class="form-control disabled" :value="thuebao.mgwan.huongkn" @change="v=>thuebao.mgwan.huongkn=v.target.value">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w90">
                                                        Tính KN
                                                    </div>

                                                    <div class="value">
                                                        <select2 v-model="listbox.tinh_kn.value" class="select-custom" :options="listbox.tinh_kn.list.map(t=>({id:t.tinh_id*1,text:t.tentinh}))"></select2>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w90">
                                                        VRF/VFI
                                                    </div>

                                                    <div class="value">
                                                        <input type="text" class="form-control disabled" :value="thuebao.mgwan.vrfvfi" @change="v=>thuebao.mgwan.vrfvfi=v.target.value" :required="[DichVuVienThong.MEGAWAN, DichVuVienThong.METRONET, DichVuVienThong.NOIBO_DADIEM, DichVuVienThong.MGW_DOITAC].indexOf(listbox.dichvu_vt.value*1)>=0 && PHAINHAP_VRF" title="Bắt buộc phải nhập vrfvfi">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key">
                                                        Địa chỉ KN
                                                    </div>
                                                    <div class="value" :class="{disabled:(loaisowan*1!=LOAINODE_MGWAN.NODE_PHU)}">
                                                        <div class="input-more-button">
                                                            <button class="btn" v-b-modal.popupDiaChiKN title="Chọn địa chỉ thuê bao">
                                                                <span class="-ap icon-more_horiz"></span>
                                                            </button>
                                                            <ModalChonDiaChi modalId="popupDiaChiKN" :data="diachiKN" :isStrictMode="true" @xacnhan="getDiaChiKN"/>
                                                            <bss-error-marker :has-error="$v.diachiKN.DIACHI.$error">
                                                                <input type="text"  :value="$v.diachiKN.DIACHI.$model" @change="v=>$v.diachiKN.DIACHI.$model=v.target.value" class="form-control">
                                                            </bss-error-marker>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w90">
                                                        Chủ quản
                                                    </div>
                                                    <div class="value">
                                                        <!-- <select2 v-model="listbox.chu_quan.valuewan" class="select-custom" :options="listbox.chu_quan.list.map(cq=>({id:cq.chuquan_id*1,text:cq.ten_tat}))"></select2> -->

                                                        <ComboboxGrid2  class="select-custom"
                                                            :columns="[
                                                            {fieldName: 'ten_tat', headerText: '', allowFiltering: true, width:'300'},
                                                            ]"
                                                            :dataSource="listbox.chu_quan.list" textField="ten_tat" valueField="chuquan_id"
                                                            :enabledSelectFirstRow="false" :value="listbox.chu_quan.valuewan"
                                                            @selectedChanged="(item)=>{if(item) { listbox.chu_quan.valuewan=item.chuquan_id; }}">
                                                        </ComboboxGrid2>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w90" title="Đơn vị lắp đặt dịch vụ">
                                                        Đvị LĐ
                                                    </div>
                                                    <div class="value">
                                                        <!-- <select2 v-model="listbox.chu_quan.valueldmgwan" class="select-custom" :options="listbox.chu_quan.list.map(cq=>({id:cq.chuquan_id,text:cq.ten_tat}))"></select2> -->
                                                        <ComboboxGrid2  class="select-custom"
                                                            :columns="[
                                                            {fieldName: 'ten_tat', headerText: '', allowFiltering: true, width:'300'},
                                                            ]"
                                                            :dataSource="listbox.chu_quan.list" textField="ten_tat" valueField="chuquan_id"
                                                            :enabledSelectFirstRow="false" :value="listbox.chu_quan.valueldmgwan"
                                                            @selectedChanged="(item)=>{if(item) { listbox.chu_quan.valueldmgwan=item.chuquan_id; }}">
                                                        </ComboboxGrid2>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key">
                                                        Loại kênh
                                                    </div>
                                                    <div class="value">
                                                        <select2 v-model="listbox.loaikenh.value" class="select-custom" :options="listbox.loaikenh.list.map(lk=>({id:lk.loaikenh_id,text:lk.loai_kenh}))" @change="cboLoaiKenh_SelectedValueChanged"></select2>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w90">
                                                        Thời hạn
                                                    </div>
                                                    <div class="value">
                                                        <select2 v-model="listbox.thoihan.valuewan" class="select-custom" :options="listbox.thoihan.list.map(th=>({id:th.thoihan_id,text:th.tenthoihan}))"></select2>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w90 nowrap padt0"  :class="{disabled:listbox.thoihan.valuewan!=ThoiHan.Ngan_Han}">
                                                        <button class="btn btn-second fullw" @click.prevent="$bvModal.show('modal-tgthue');" title="Thời gian thuê">
                                                            <span class="one-file-edit f20 vcenter inline"></span> TG thuê
                                                        </button>
                                                        <b-modal id="modal-tgthue" title="Thời gian thuê ngắn hạn" ok-title="Chấp nhận" cancel-title="Thoát" @ok="kt_thuenganhan=true"><!-- @ok="handleOk" -->
                                                            <div class="key">Từ ngày</div><div class="value"><date-picker input-class="form-control" :format="datetimeFormatFull" :value-type="'format'" v-model="TGThueTuNgay"></date-picker></div>
                                                            <div class="key">Đến ngày</div><div class="value"><date-picker input-class="form-control" :format="datetimeFormatFull" :value-type="'format'" v-model="TGThueDenNgay"></date-picker></div>
                                                        </b-modal>
                                                    </div>
                                                    <div class="value padt7">
                                                        <div class="check-action" :class="{disabled:!thuebao.mgwan.chkLuongGiuKenh}">
                                                            <input type="checkbox" class="check" v-model="thuebao.mgwan.luonggiukenh">
                                                            <span class="name">Luồng giữ kênh</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key">
                                                        Phân loại
                                                    </div>
                                                    <div class="value">
                                                        <select2 v-model="listbox.phanloai_dv.value" class="select-custom" :options="listbox.phanloai_dv.list.filter(pl=>(pl.loaitb_id==134)).map(pl=>({id:pl.phanloai_id,text:pl.phanloai}))"></select2>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w90">
                                                        Phân tách TĐ
                                                    </div>
                                                    <div class="value">
                                                        <select2 v-model="listbox.ht_phantach_tocdo.value" class="select-custom" :options="listbox.ht_phantach_tocdo.list.map(pt=>({id:pt.phantach_id,text:pt.phantach}))"></select2>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>
                                        <div class="row">
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key" title="Tốc độ kênh">
                                                        Tốc độ CIR
                                                    </div>
                                                    <div class="value">
                                                        <!-- <select2 v-model="listbox.tocdokenh.valuecir" class="select-custom" :options="listbox.tocdokenh.list.map(td=>({id:td.tocdo_id,text:td.toc_do}))" @change="cboTocDo_EditValueChanged"></select2> -->

                                                        <ComboboxGrid2  class="select-custom"
                                                            :columns="[
                                                            {fieldName: 'tocdo_id', headerText: '', allowFiltering: true, width:'70'},
                                                            {fieldName: 'toc_do', headerText: '', allowFiltering: true, width:'300'}
                                                            ]"
                                                            :dataSource="listbox.tocdokenh.list" textField="toc_do" valueField="tocdo_id"
                                                            :enabledSelectFirstRow="false" :value="listbox.tocdokenh.valuecir"
                                                            @selectedChanged="(item)=>{if(item) { listbox.tocdokenh.valuecir=item.tocdo_id;cboTocDo_EditValueChanged();}}">
                                                        </ComboboxGrid2>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w90">
                                                        Trang bị
                                                    </div>

                                                    <div class="value">
                                                        <select2 v-model="listbox.trangbi.valuewan" class="select-custom" :options="listbox.trangbi.list.map(lc=>({id:lc.trangbi_id,text:lc.tentrangbi}))" @change="v=>{listbox.trangbi.valuewan=v;trangbi_id=v;LoadMucCuocTB();}"></select2>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w90">
                                                        Modem
                                                    </div>

                                                    <div class="value">
                                                        <select2 v-model="listbox.loaimodem.value" class="select-custom" :options="listbox.loaimodem.list.map(l=>({id:l.loaimd_id,text:l.loai_md}))"></select2>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>
                                        <div class="row">
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key">
                                                        <div class="check-action">
                                                            <input type="checkbox" class="check" v-model="listbox.tocdokenh.ischeckedpir">
                                                            <span class="name">Tốc độ PIR</span>
                                                        </div>
                                                    </div>
                                                    <div class="value" :class="{disabled:!listbox.tocdokenh.ischeckedpir}">
                                                        <!-- <select2 v-model="listbox.tocdokenh.valuepir" class="select-custom" :options="listbox.tocdokenh.list.map(td=>({id:td.tocdo_id,text:td.toc_do}))"></select2> -->

                                                        <ComboboxGrid2  class="select-custom"
                                                            :columns="[
                                                            {fieldName: 'tocdo_id', headerText: '', allowFiltering: true, width:'70'},
                                                            {fieldName: 'toc_do', headerText: '', allowFiltering: true, width:'300'}
                                                            ]"
                                                            :dataSource="listbox.tocdokenh.list" textField="toc_do" valueField="tocdo_id"
                                                            :enabledSelectFirstRow="false" :value="listbox.tocdokenh.valuepir"
                                                            @selectedChanged="(item)=>{if(item) { listbox.tocdokenh.valuepir=item.tocdo_id;}}">
                                                        </ComboboxGrid2>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w90">
                                                        Loại cáp
                                                    </div>

                                                    <div class="value">
                                                        <select2 v-model="listbox.loaicap.value" class="select-custom" :options="listbox.loaicap.list.map(lc=>({id:lc.loaicap_id,text:lc.loaicap}))"></select2>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w90">
                                                        Loại Tbị
                                                    </div>

                                                    <div class="value">
                                                        <select2 v-model="listbox.loai_tb.valuemgwan" class="select-custom" :options="listbox.loai_tb.list.filter(tb=>tb.dichvuvt_id==listbox.dichvu_vt.value).map(tb=>({id:tb.thietbidc_id,text:tb.ten_tbi}))"></select2>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>
                                        <div class="row" :class="{disabled:listbox.loaihinh_tb.value!=LoaiHinhTB.MGW_INTERNET_TRUCTIEP && listbox.loaihinh_tb.value!=LoaiHinhTB.NB_INTERNETTT}">
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key">
                                                        <div class="check-action">
                                                            <input type="checkbox" class="check" v-model="listbox.tocdokenh.ischeckednix">
                                                            <span class="name">Tốc độ NIX</span>
                                                        </div>
                                                    </div>
                                                    <div class="value" :class="{disabled:!listbox.tocdokenh.ischeckednix}">
                                                        <!-- <select2 v-model="listbox.tocdokenh.valuenix" class="select-custom" :options="listbox.tocdokenh.list.map(td=>({id:td.tocdo_id,text:td.toc_do}))" @change="HienThi_CTK_NIX_ISP(2)"></select2> -->
                                                        <ComboboxGrid2  class="select-custom"
                                                            :columns="[
                                                            {fieldName: 'tocdo_id', headerText: '', allowFiltering: true, width:'70'},
                                                            {fieldName: 'toc_do', headerText: '', allowFiltering: true, width:'300'}
                                                            ]"
                                                            :dataSource="listbox.tocdokenh.list" textField="toc_do" valueField="tocdo_id"
                                                            :enabledSelectFirstRow="false" :value="listbox.tocdokenh.valuenix"
                                                            @selectedChanged="(item)=>{if(item) { listbox.tocdokenh.valuenix=item.tocdo_id;HienThi_CTK_NIX_ISP(2);}}">
                                                        </ComboboxGrid2>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w90">
                                                        Cước NIX
                                                    </div>

                                                    <div class="value">
                                                        <vue-numeric class="form-control tright red fw6" separator="." decimal-separator="," :precision="is_nv_vnpti==1?2:0" :value="thuebao.mgwan.cuocnix" @change="v=>thuebao.mgwan.cuocnix=v.target.value" placeholder="0" output-type="Number" title="Cước trong nước"></vue-numeric>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w90">
                                                        Số lượng IP
                                                    </div>
                                                    <div class="value">
                                                        <vue-numeric class="form-control tright red fw6" separator="." :value="thuebao.mgwan.soluongip" @change="v=>thuebao.mgwan.soluongip=v.target.value" placeholder="0" output-type="Number" title="Số lượng IP (Kênh : Internet trực tiếp)"></vue-numeric>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row" :class="{disabled:listbox.loaihinh_tb.value!=LoaiHinhTB.MGW_INTERNET_TRUCTIEP && listbox.loaihinh_tb.value!=LoaiHinhTB.NB_INTERNETTT}">
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key">
                                                        <div class="check-action">
                                                            <input type="checkbox" class="check" v-model="listbox.tocdokenh.ischeckedisp">
                                                            <span class="name">Tốc độ ISP</span>
                                                        </div>
                                                    </div>
                                                    <div class="value" :class="{disabled:!listbox.tocdokenh.ischeckedisp}">
                                                        <!-- <select2 v-model="listbox.tocdokenh.valueisp" class="select-custom" :options="listbox.tocdokenh.list.map(td=>({id:td.tocdo_id,text:td.toc_do}))" @change="HienThi_CTK_NIX_ISP(3)"></select2> -->
                                                        <ComboboxGrid2  class="select-custom"
                                                            :columns="[
                                                            {fieldName: 'tocdo_id', headerText: '', allowFiltering: true, width:'70'},
                                                            {fieldName: 'toc_do', headerText: '', allowFiltering: true, width:'300'}
                                                            ]"
                                                            :dataSource="listbox.tocdokenh.list" textField="toc_do" valueField="tocdo_id"
                                                            :enabledSelectFirstRow="false" :value="listbox.tocdokenh.valueisp"
                                                            @selectedChanged="(item)=>{if(item) { listbox.tocdokenh.valueisp=item.tocdo_id;HienThi_CTK_NIX_ISP(3);}}">
                                                        </ComboboxGrid2>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w90">
                                                        Cước ISP
                                                    </div>
                                                    <div class="value">
                                                        <vue-numeric class="form-control tright red fw6" separator="." decimal-separator="," :precision="is_nv_vnpti==1?2:0" :value="thuebao.mgwan.cuocisp" @change="v=>thuebao.mgwan.cuocisp=v.target.value" placeholder="0" output-type="Number" title="Cước quốc tế"></vue-numeric>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w90">
                                                        Cước IP
                                                    </div>
                                                    <div class="value">
                                                        <vue-numeric class="form-control tright red fw6" separator="." decimal-separator="," :precision="is_nv_vnpti==1?2:0" :value="thuebao.mgwan.cuocip" @change="v=>thuebao.mgwan.cuocip=v.target.value" placeholder="0" output-type="Number" title="Cước IP (Kênh : Internet trực tiếp)"></vue-numeric>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="title-bg-main mart20">
                                            <span class="title">Đối tác</span>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key">
                                                        <div class="check-action">
                                                            <input type="checkbox" class="check" v-model="listbox.doitacwan.isenabled">
                                                            <span class="name">Đối tác</span>
                                                        </div>
                                                    </div>
                                                    <div class="value" :class="{disabled:!listbox.doitacwan.isenabled}">
                                                        <div class="select-custom">
                                                            <!-- <select2 v-model="listbox.doitacwan.value" class="select-custom" :options="listbox.doitacwan.list.map(dt=>({id:dt.doitac_id,text:dt.ten_dt}))"></select2> -->
                                                            <ComboboxGrid2  class="select-custom"
                                                                :columns="[
                                                                {fieldName: 'ten_dt', headerText: '', allowFiltering: true, width:'300'},
                                                                ]"
                                                                :dataSource="listbox.doitacwan.list" textField="ten_dt" valueField="doitac_id"
                                                                :enabledSelectFirstRow="false" :value="listbox.doitacwan.value"
                                                                @selectedChanged="(item)=>{if(item) { listbox.doitacwan.value=item.doitac_id; }}">
                                                            </ComboboxGrid2>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w90">
                                                        Cước TC
                                                    </div>
                                                    <div class="value" :class="{disabled:!listbox.doitacwan.isenabled}">
                                                        <vue-numeric class="form-control tright red fw6" separator="." decimal-separator="," :precision="is_nv_vnpti==1?2:0" :value="thuebao.mgwan.cuoctc_dt" @change="v=>thuebao.mgwan.cuoctc_dt=v.target.value" placeholder="0" output-type="Number" title="Cước thuê cổng"></vue-numeric>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key nowrap">
                                                        Cước TC (No Vat)
                                                    </div>
                                                    <div class="value">
                                                        <vue-numeric class="form-control tright red fw6" separator="." decimal-separator="," :precision="is_nv_vnpti==1?2:0" :value="thuebao.mgwan.cuoctc" @change="v=>thuebao.mgwan.cuoctc=v.target.value" placeholder="0" output-type="Number" title="Cước thuê cổng ( Chưa VAT)"></vue-numeric>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key">
                                                        <span class="name">Hợp đồng ĐT</span>
                                                    </div>
                                                    <div class="value" :class="{disabled:!listbox.doitacwan.isenabled}">
                                                        <input type="text" class="form-control tright red fw6" :value="thuebao.mgwan.hopdong_dt" @change="v=>thuebao.mgwan.hopdong_dt=v.target.value">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w90">
                                                        Cước TK
                                                    </div>
                                                    <div class="value" :class="{disabled:!listbox.doitacwan.isenabled}">
                                                        <vue-numeric class="form-control tright red fw6" separator="." decimal-separator="," :precision="is_nv_vnpti==1?2:0" :value="thuebao.mgwan.cuoctk_dt" @change="v=>thuebao.mgwan.cuoctk_dt=v.target.value" placeholder="0" output-type="Number"></vue-numeric>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key nowrap">
                                                        Cước TK (No Vat)
                                                    </div>
                                                    <div class="value">
                                                        <vue-numeric class="form-control tright red fw6" separator="." decimal-separator="," :precision="is_nv_vnpti==1?2:0" :value="thuebao.mgwan.cuoctk" @change="v=>thuebao.mgwan.cuoctk=v.target.value" placeholder="0" output-type="Number" title="Cước thuê kênh ( Chưa VAT)"></vue-numeric>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-8 col-12">
                                                <div class="info-row" v-for="(ct,idx) in DT_CONTROLS.list" v-if="DT_CONTROLS.list.length>0">
                                                    <div class="key">
                                                        {{ct.TEN_LOAIDV}}
                                                    </div>
                                                    <div class="value">
                                                        <select2 v-model="DT_CONTROLS.value[idx]" :key="DT_CONTROLS.key+'-'+idx" class="select-custom" :options="DT_DV(idx)" required></select2>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key nowrap">
                                                        Cước TBị (No Vat)
                                                    </div>
                                                    <div class="value">
                                                        <vue-numeric class="form-control tright red fw6" separator="." decimal-separator="," :precision="is_nv_vnpti==1?2:0" :value="thuebao.mgwan.cuoctbi" @change="v=>thuebao.mgwan.cuoctbi=v.target.value" placeholder="0" output-type="Number" title="Cước thiết bị"></vue-numeric>
                                                    </div>
                                                </div>
                                                <div class="info-row">
                                                    <div class="key nowrap">
                                                        Cước HT (No Vat)
                                                    </div>
                                                    <div class="value">
                                                        <vue-numeric class="form-control tright red fw6" separator="." decimal-separator="," :precision="is_nv_vnpti==1?2:0" :value="thuebao.mgwan.cuocht" @change="v=>thuebao.mgwan.cuocht=v.target.value" placeholder="0" output-type="Number" title="Cước hạ tầng"></vue-numeric>
                                                    </div>
                                                </div>
                                                <div class="info-row">
                                                    <div class="key nowrap">
                                                        LAN IP
                                                    </div>
                                                    <div class="value">
                                                        <input type="text" class="form-control tright red fw6" :value="thuebao.mgwan.lanip" @change="v=>thuebao.mgwan.lanip=v.target.value">
                                                    </div>
                                                </div>
                                                <div class="info-row">
                                                    <div class="key nowrap">
                                                        WAN IP
                                                    </div>
                                                    <div class="value">
                                                        <input type="text" class="form-control tright red fw6" :value="thuebao.mgwan.wanip" @change="v=>thuebao.mgwan.wanip=v.target.value">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="tsl" class="tab-pane" v-if="[DichVuVienThong.TSL,DichVuVienThong.TSL_DOITAC, DichVuVienThong.NOIBO_2DIEM].indexOf(parseInt(listbox.dichvu_vt.value))>=0">
                                    <div class="tab-content">
                                        <div class="row">
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key">
                                                        Account
                                                    </div>
                                                    <div class="value">
                                                        <input type="text" class="form-control highlight" :readonly="thuebao.tsl.txtMaTSL.ReadOnly" :value="thuebao.tsl.txtMaTSL.Text" @change="v=>thuebao.tsl.txtMaTSL.Text=v.target.value">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w90">
                                                        Mã HĐ - TTKD
                                                    </div>
                                                    <div class="value">
                                                        <input type="text" class="form-control" :value="thuebao.tsl.txtMaHD_TTKD_TSL" @change="v=>thuebao.tsl.txtMaHD_TTKD_TSL=v.target.value">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w120">
                                                        Loại kênh
                                                    </div>
                                                    <div class="value">
                                                        <select2 v-model="listbox.loaikenh.valuetsl" class="select-custom" :options="listbox.loaikenh.list.map(lk=>({id:lk.loaikenh_id,text:lk.loai_kenh}))" @change="cboLoaiKenh_SelectedValueChanged"></select2>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key">
                                                        Tốc độ kênh
                                                    </div>
                                                    <div class="value">
                                                        <!-- <select2 v-model="listbox.tocdokenh.valuetsl" class="select-custom" :options="listbox.tocdokenh.list.map(td=>({id:td.tocdo_id,text:td.toc_do}))" @change="cboTocDoKenhTSL_EditValueChanged"></select2> -->
                                                        <ComboboxGrid2  class="select-custom"
                                                            :columns="[
                                                            {fieldName: 'tocdo_id', headerText: '', allowFiltering: true, width:'70'},
                                                            {fieldName: 'toc_do', headerText: '', allowFiltering: true, width:'300'}
                                                            ]"
                                                            :dataSource="listbox.tocdokenh.list" textField="toc_do" valueField="tocdo_id"
                                                            :enabledSelectFirstRow="false" :value="listbox.tocdokenh.valuetsl"
                                                            @selectedChanged="(item)=>{if(item) { listbox.tocdokenh.valuetsl=item.tocdo_id;cboTocDoKenhTSL_EditValueChanged();}}">
                                                        </ComboboxGrid2>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w90">
                                                        Chủ quản
                                                    </div>

                                                    <div class="value">
                                                    <!-- <select2 v-model="listbox.chu_quan.valuetsl" class="select-custom" :options="listbox.chu_quan.list.map(cq=>({id:cq.chuquan_id,text:cq.ten_tat}))"></select2> -->
                                                    <ComboboxGrid2  class="select-custom"
                                                        :columns="[
                                                        {fieldName: 'ten_tat', headerText: '', allowFiltering: true, width:'300'},
                                                        ]"
                                                        :dataSource="listbox.chu_quan.list" textField="ten_tat" valueField="chuquan_id"
                                                        :enabledSelectFirstRow="false" :value="listbox.chu_quan.valuetsl"
                                                        @selectedChanged="(item)=>{if(item) { listbox.chu_quan.valuetsl=item.chuquan_id; }}">
                                                    </ComboboxGrid2>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w120">
                                                        Cước TC (No Vat)
                                                    </div>

                                                    <div class="value">
                                                        <vue-numeric class="form-control tright fw6" separator="." decimal-separator="," :precision="is_nv_vnpti==1?2:0" :value="thuebao.tsl.txtCuocTC_TSL" @change="v=>thuebao.tsl.txtCuocTC_TSL=v.target.value" placeholder="0" output-type="Number" title="Cước thuê cổng"></vue-numeric>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key">
                                                        Thời hạn
                                                    </div>
                                                    <div class="value">
                                                        <select2 v-model="listbox.thoihan.valuetsl" class="select-custom" :options="listbox.thoihan.list.map(th=>({id:th.thoihan_id,text:th.tenthoihan}))"></select2>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12" :class="{disabled:listbox.thoihan.valuetsl!=ThoiHan.Ngan_Han}">
                                                <button class="btn btn-second fullw" @click.prevent="$bvModal.show('modal-tgthue');">
                                                    <span class="one-file-edit f20 vcenter inline"></span> TG thuê
                                                </button>
                                                <b-modal id="modal-tgthue" title="Thời gian thuê ngắn hạn" ok-title="Chấp nhận" cancel-title="Thoát" @ok="kt_thuenganhan=true"><!-- @ok="handleOk" -->
                                                    <div class="key">Từ ngày</div><div class="value"><date-picker input-class="form-control" :format="datetimeFormatFull" :value-type="'format'" v-model="TGThueTuNgay"></date-picker></div>
                                                    <div class="key">Đến ngày</div><div class="value"><date-picker input-class="form-control" :format="datetimeFormatFull" :value-type="'format'" v-model="TGThueDenNgay"></date-picker></div>
                                                </b-modal>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w120">
                                                        Cước TK (No Vat)
                                                    </div>

                                                    <div class="value">
                                                        <vue-numeric class="form-control tright fw6" separator="." decimal-separator="," :precision="is_nv_vnpti==1?2:0" :value="thuebao.tsl.txtCuocTK_TSL" @change="v=>thuebao.tsl.txtCuocTK_TSL=v.target.value" placeholder="0" output-type="Number"></vue-numeric>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key">
                                                        <div class="check-action">
                                                            <input type="checkbox" class="check" v-model="listbox.doitactsl.chkDoiTacTSL">
                                                            <span class="name">Đối tác</span>
                                                        </div>
                                                    </div>
                                                    <div class="value" :class="{disabled:!listbox.doitactsl.chkDoiTacTSL}">
                                                        <!-- <select2 v-model="listbox.doitactsl.value" class="select-custom" :options="listbox.doitactsl.list.map(dt=>({id:dt.doitac_id,text:dt.ten_dt}))"></select2> -->
                                                        <ComboboxGrid2  class="select-custom"
                                                            :columns="[
                                                            {fieldName: 'ten_dt', headerText: '', allowFiltering: true, width:'300'},
                                                            ]"
                                                            :dataSource="listbox.doitactsl.list" textField="ten_dt" valueField="doitac_id"
                                                            :enabledSelectFirstRow="false" :value="listbox.doitactsl.value"
                                                            @selectedChanged="(item)=>{if(item) { listbox.doitactsl.value=item.doitac_id; }}">
                                                        </ComboboxGrid2>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w90">Cước TKĐT</div>
                                                    <div class="value">
                                                        <vue-numeric class="form-control tright fw6" separator="." decimal-separator="," :precision="is_nv_vnpti==1?2:0" :value="thuebao.tsl.txtCuocTKDT_TSL" @change="v=>thuebao.tsl.txtCuocTKDT_TSL=v.target.value" placeholder="0" output-type="Number"></vue-numeric>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w120">
                                                        Cước T.Bị (No Vat)
                                                    </div>
                                                    <div class="value">
                                                        <vue-numeric class="form-control tright red fw6" separator="." decimal-separator="," :precision="is_nv_vnpti==1?2:0" :value="thuebao.tsl.txtCuocTBI_TSL" @change="v=>thuebao.tsl.txtCuocTBI_TSL=v.target.value" placeholder="0" output-type="Number" title="Cước thiết bị"></vue-numeric>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key">
                                                        Mã hợp đồng ĐT
                                                    </div>
                                                    <div class="value">
                                                        <input type="text" class="form-control" :value="thuebao.tsl.txtMaHD_DT_TSL" @change="v=>thuebao.tsl.txtMaHD_DT_TSL=v.target.value">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w90">Cước TCĐT</div>
                                                    <div class="value">
                                                        <vue-numeric class="form-control tright fw6" separator="." decimal-separator="," :precision="is_nv_vnpti==1?2:0" :value="thuebao.tsl.txtCuocTCDT_TSL" @change="v=>thuebao.tsl.txtCuocTCDT_TSL=v.target.value" placeholder="0" output-type="Number" title="Cước thuê cổng"></vue-numeric>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w120">
                                                        Cước HT (No Vat)
                                                    </div>

                                                    <div class="value">
                                                        <vue-numeric class="form-control tright red fw6" separator="." decimal-separator="," :precision="is_nv_vnpti==1?2:0" :value="thuebao.tsl.txtCuocHT_TSL" @change="v=>thuebao.tsl.txtCuocHT_TSL=v.target.value" placeholder="0" output-type="Number" title="Cước hạ tầng"></vue-numeric>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-8 col-12">
                                                <div class="info-row">
                                                    <div class="key">
                                                        Địa chỉ đầu
                                                    </div>
                                                    <div class="value">
                                                        <div class="input-more-button">
                                                            <button class="btn" v-b-modal.popupDiaChiDau>
                                                                <span class="-ap icon-more_horiz"></span>
                                                            </button>
                                                            <ModalChonDiaChi modalId="popupDiaChiDau" :data="diachiDau" :isStrictMode="true" @xacnhan="getDiaChiDau"/>

                                                            <bss-error-marker :has-error="$v.diachiDau.DIACHI.$error">
                                                                <input type="text"  :value="$v.diachiDau.DIACHI.$model" @change="v=>$v.diachiDau.DIACHI.$model=v.target.value" class="form-control">
                                                            </bss-error-marker>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w120">
                                                        Số ảo đầu
                                                    </div>

                                                    <div class="value">
                                                        <div class="input-more-button" :class="{disabled:TUDONG_SINH_SOAO}">
                                                            <button class="btn" @click.prevent="btnSoAoTSL_Click">
                                                                <span class="-ap icon-more_horiz"></span>
                                                            </button>
                                                            <input type="text" class="form-control disabled" :value="thuebao.tsl.txtSoAoTSL_Dau" @change="v=>thuebao.tsl.txtSoAoTSL_Dau=v.target.value">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-8 col-12">
                                                <div class="info-row">
                                                    <div class="key">
                                                        Đơn vị đầu
                                                    </div>
                                                    <div class="value">
                                                        <select2 v-model="listbox.donvi_dau.value" class="select-custom" :options="listbox.donvi_dau.list.map(dv=>({id:dv.donvi_id,text:dv.ten_dv}))"></select2>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w120">
                                                        Loại TB đầu
                                                    </div>

                                                    <div class="value">
                                                        <select2 v-model="listbox.loai_tb.valuedau" class="select-custom" :options="listbox.loai_tb.list.filter(tb=>(tb.dichvuvt_id==(listbox.dichvu_vt.value==DichVuVienThong.NOIBO_2DIEM?DichVuVienThong.NOIBO_2DIEM:DichVuVienThong.TSL))).map(tb=>({id:tb.thietbidc_id,text:tb.ten_tbi}))"></select2>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-8 col-12">
                                                <div class="info-row">
                                                    <div class="key">
                                                        Địa chỉ cuối
                                                    </div>
                                                    <div class="value">
                                                        <div class="input-more-button">
                                                            <button class="btn" v-b-modal.popupDiaChiCuoi>
                                                                <span class="-ap icon-more_horiz"></span>
                                                            </button>
                                                            <ModalChonDiaChi modalId="popupDiaChiCuoi" :data="diachiCuoi" :isStrictMode="true" @xacnhan="getDiaChiCuoi"/>

                                                            <bss-error-marker :has-error="$v.diachiCuoi.DIACHI.$error">
                                                                <input type="text"  :value="$v.diachiCuoi.DIACHI.$model" @change="v=>$v.diachiCuoi.DIACHI.$model=v.target.value" class="form-control">
                                                            </bss-error-marker>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w120">
                                                        Số ảo cuối
                                                    </div>
                                                    <div class="value">
                                                        <div class="input-more-button" :class="{disabled:TUDONG_SINH_SOAO}">
                                                            <button class="btn" @click.prevent="btnSoAoTSL_Cuoi_Click">
                                                                <span class="-ap icon-more_horiz"></span>
                                                            </button>
                                                            <input type="text" class="form-control disabled" :value="thuebao.tsl.txtSoAoTSL_Cuoi" @change="v=>thuebao.tsl.txtSoAoTSL_Cuoi=v.target.value">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-8 col-12">
                                                <div class="info-row">
                                                    <div class="key">
                                                        Đơn vị cuối
                                                    </div>
                                                    <div class="value">
                                                        <select2 v-model="listbox.donvi_cuoi.value" class="select-custom" :options="listbox.donvi_cuoi.list.map(dv=>({id:dv.donvi_id,text:dv.ten_dv}))"></select2>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w120">
                                                        Loại TB cuối
                                                    </div>
                                                    <div class="value">
                                                        <select2 v-model="listbox.loai_tb.valuecuoi" class="select-custom" :options="listbox.loai_tb.list.filter(tb=>(tb.dichvuvt_id==(listbox.dichvu_vt.value==DichVuVienThong.NOIBO_2DIEM?DichVuVienThong.NOIBO_2DIEM:DichVuVienThong.TSL))).map(tb=>({id:tb.thietbidc_id,text:tb.ten_tbi}))"></select2>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-8 col-12">
                                                <div class="info-row">
                                                    <div class="key">
                                                        Site ID đầu
                                                    </div>
                                                    <div class="value">
                                                        <input type="text" class="form-control" :value="thuebao.tsl.txtSiteIDTSL_Dau" @change="v=>thuebao.tsl.txtSiteIDTSL_Dau=v.target.value">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w90">
                                                        Site ID cuối
                                                    </div>
                                                    <div class="value">
                                                        <input type="text" class="form-control" :value="thuebao.tsl.txtSiteIDTSL_Cuoi" @change="v=>thuebao.tsl.txtSiteIDTSL_Cuoi=v.target.value">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-8 col-12">
                                                <div class="info-row">
                                                    <div class="key w120">
                                                        Loại cáp đầu
                                                    </div>
                                                    <div class="value">
                                                        <select2 v-model="listbox.loaicap.valuedau" class="select-custom" :options="listbox.loaicap.list.map(lc=>({id:lc.loaicap_id,text:lc.loaicap}))"></select2>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w120">
                                                        Loại cáp cuối
                                                    </div>
                                                    <div class="value">
                                                        <select2 v-model="listbox.loaicap.valuecuoi" class="select-custom" :options="listbox.loaicap.list.map(lc=>({id:lc.loaicap_id,text:lc.loaicap}))"></select2>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-8 col-12">
                                                <div class="info-row">
                                                    <div class="key">
                                                        VRF/VFI đầu
                                                    </div>
                                                    <div class="value disabled">
                                                        <input type="text" class="form-control" :value="thuebao.tsl.txtVrf_Dau" @change="v=>thuebao.tsl.txtVrf_Dau=v.target.value" />
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w120">
                                                        VRF/VFI cuối
                                                    </div>
                                                    <div class="value disabled">
                                                        <input type="text" class="form-control" :value="thuebao.tsl.txtVrf_Cuoi" @change="v=>thuebao.tsl.txtVrf_Cuoi=v.target.value" />
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-12 col-12">
                                                <!-- <div class="info-row">
                                                    <div class="key">
                                                        Hoàn thiện hồ sơ
                                                    </div>
                                                    <div class="value">
                                                        <div class="select-custom">
                                                            <select name="" id="" class="form-control">
                                                                <option value=""></option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div> -->

                                                <div class="info-row" v-for="(ct,idx) in DT_CONTROLS.list" v-if="DT_CONTROLS.list.length>0">
                                                    <div class="key">
                                                        {{ct.TEN_LOAIDV}}
                                                    </div>
                                                    <div class="value">
                                                        <select2 v-model="DT_CONTROLS.value[idx]" :key="DT_CONTROLS.key+'-'+idx" class="select-custom" :options="DT_DV(idx)" required></select2>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-8 col-12">
                                                <div class="info-row">
                                                    <div class="key">
                                                        Trang bị
                                                    </div>
                                                    <div class="value">
                                                        <select2 v-model="listbox.trangbi.valuetsl" class="select-custom" :options="listbox.trangbi.list.map(lc=>({id:lc.trangbi_id,text:lc.tentrangbi}))" @change="listbox.trangbi.valuetsl=v;trangbi_id=v;cboTrangBiGphone_SelectedValueChanged()"></select2>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-4 col-12">
                                                <div class="info-row">
                                                    <div class="key w120">
                                                        Số sợi quang
                                                    </div>
                                                    <div class="value">
                                                        <input type="number" class="form-control" :value="thuebao.tsl.txtSoSoiQuang" @change="v=>thuebao.tsl.txtSoSoiQuang=v.target.value" />
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="cntt" class="tab-pane" v-if="DichVuVienThong.listDichVuCNTT().indexOf(listbox.dichvu_vt.value*1)>=0">
                                    <div class="tab-content">
                                        <div class="info-row">
                                            <div class="table-content">
                                                <table class="table-result table-gachle">
                                                    <tbody>
                                                        <!-- <tr class="highlight">
                                                            <td class="w20 center">
                                                                <span class="fa fa-play text-main"></span>
                                                            </td>
                                                            <td class="selected highlight1 fw6">Số máy/Acc</td>
                                                            <td>
                                                                <input type="text" class="form-control h24 bor0 nocorner bg-none">
                                                            </td>
                                                        </tr> -->
                                                        <tr v-for="(hdx,idx) in gridEditors" :key="idx">
                                                            <td class="w20 center" v-if="hdx.show != false">

                                                            </td>
                                                            <td v-if="hdx.show != false " class="fw6" :class="{ strikethrough: hdx.isDisabled }">{{ hdx.Name }}</td>
                                                            <td v-if="hdx.show != false" :class="{ disabled: hdx.isDisabled }">
                                                                <template v-if="hdx.Type=='ButtonEdit'">
                                                                    <div class="input-more-button -right">
                                                                        <button class="btn h-auto pad4 lh14 w24" @click.prevent="hdx.ButtonClick(hdx)">
                                                                            <span class="-ap icon-more_horiz"></span>
                                                                        </button>
                                                                        <input type="text" :class="{disabled:hdx.ReadOnly?true:false}" class="form-control padr30  h24 bor0 nocorner bg-none" :value="hdx.Value" @change="v=>hdx.Value=v.target.value">
                                                                    </div>
                                                                </template>
                                                                <template v-if="hdx.Type=='TextEdit' && hdx.DataType!=1">
                                                                    <input type="text" class="form-control padr30  h24 bor0 nocorner bg-none" :required="hdx.Name.indexOf('*')>=0 && hdx.ID!='MA_TB'"  :value="hdx.Value" @change="v=>{ hdx.Value=v.target.value; hdx.EditValueChanged(hdx); }" :title="'Bắt buộc nhập thông tin ' + hdx.Name">
                                                                </template>
                                                                <template v-if="hdx.Type=='CalcEdit' || (hdx.Type=='TextEdit' && hdx.DataType==1)">
                                                                    <input type="number"  :class="{disabled:hdx.ReadOnly?true:false}" class="form-control padr30  h24 bor0 nocorner bg-none" :required="hdx.Name.indexOf('*')>=0 && hdx.ID!='MA_TB'" :value="hdx.Value" @change="v=>{ hdx.Value=v.target.value; hdx.EditValueChanged(hdx); }" :title="'Bắt buộc nhập thông tin ' + hdx.Name" min="0">
                                                                </template>
                                                                <template v-if="hdx.Type=='DateEdit'">
                                                                    <div class="input-icon-right">
                                                                        <date-picker input-class="form-control h24 bor0 nocorner bg-none" :format="hdx.EditMask" :value-type="hdx.EditMask" v-model="hdx.Value" @change="hdx.EditValueChanged(hdx)"></date-picker>
                                                                        <span class="icon one-calendar"></span>
                                                                    </div>
                                                                </template>
                                                                <template v-if="hdx.Type=='LookUpEdit'">
                                                                    <!-- LookUpEdit {{hdx.DataSource}} {{hdx.DisplayMember}} {{hdx.ValueMember}} {{hdx.Value}} -->
                                                                    <template v-if="hdx.DataSource && hdx.DataSource.length>0">
                                                                        <SelectExt class="bor0 nocorner bg-none" v-model="hdx.Value" :options="hdx.DataSource" dataTextField="text" dataValueField="id" @change="hdx.EditValueChanged(hdx)" :class="{disabled:hdx.ReadOnly?true:false}"></SelectExt>
                                                                    </template>
                                                                    <template v-else>
                                                                        <span style="color:red; font-weight:bold;">Không có dữ liệu! Vui lòng liên hệ admin</span>
                                                                    </template>
                                                                </template>
                                                                <template v-if="hdx.Type=='CheckedComboBoxEdit1'">
                                                                    <!-- Tree {{hdx.DataSource}} {{hdx.DisplayMember}} {{hdx.ValueMember}} -->
                                                                    <template v-if="hdx.DataSource && hdx.DataSource.length>0">
                                                                        <treeselect :multiple="true" :options="hdx.DataSource.map(x=>({'label':x[hdx.DisplayMember],'id':x[hdx.ValueMember]}))" placeholder="..." v-model="hdx.Value" />
                                                                    </template>
                                                                    <template v-else>
                                                                        <span style="color:red; font-weight:bold;">Không có dữ liệu! Vui lòng liên hệ admin</span>
                                                                    </template>
                                                                </template>
                                                                <template v-if="hdx.Type=='CheckEdit'">
                                                                    <input type="checkbox" class="check" :value="hdx.ValueChecked" v-model="hdx.Value" />
                                                                </template>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                        <div class="info-row" v-for="(ct,idx) in DT_CONTROLS.list" v-if="DT_CONTROLS.list.length>0">
                                            <div class="key">
                                                {{ct.TEN_LOAIDV}}
                                            </div>
                                            <div class="value">
                                                <select2 v-model="DT_CONTROLS.value[idx]" :key="DT_CONTROLS.key+'-'+idx" class="select-custom" :options="DT_DV(idx)" required></select2>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-3 col-12">
                                    <div class="info-row">
                                        <div class="key w30 nowrap">
                                            <div class="check-action">
                                                <input type="checkbox" class="check" v-model="thuebao.cvlct">
                                                <span class="name">CV/LCT</span>
                                            </div>
                                        </div>
                                        <div class="value">
                                            <input type="text" class="form-control"  :value="thuebao.congvan" @change="v=>thuebao.congvan=v.target.value">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-3 col-12">
                                    <div class="info-row">
                                        <div class="key w30 nowrap">
                                            <div class="check-action">
                                                <input type="checkbox" class="check" v-model="thuebao.NgayCVChecked">
                                                <span class="name">Ngày CV</span>
                                            </div>
                                        </div>
                                        <div class="value">
                                            <div class="input-icon-right" :class="{disabled:!thuebao.NgayCVChecked}">
                                                <date-picker input-class="form-control" :format="dateFormat" :value-type="datetimeFormatFull" v-model="thuebao.NgayCV"></date-picker>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-2 col-12">
                                    <div class="info-row">
                                        <div class="key w30 nowrap">
                                            CRM
                                        </div>
                                        <div class="value">
                                            <input type="text" class="form-control"  :value="thuebao.crm" @change="v=>thuebao.crm=v.target.value">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-2 col-12">
                                    <div class="info-row">
                                        <div class="key w30 nowrap">
                                            ERP
                                        </div>
                                        <div class="value">
                                            <input type="text" class="form-control"  :value="thuebao.erp" @change="v=>thuebao.erp=v.target.value">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-2 col-12">
                                    <div class="info-row">
                                        <div class="key w30 nowrap">
                                            VTN
                                        </div>
                                        <div class="value">
                                            <input type="text" class="form-control"  :value="thuebao.vtn" @change="v=>thuebao.vtn=v.target.value">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-3 col-12">
                            <div class="legend-title mart10">Dịch vụ cộng thêm</div>
                            <div class="input-more-button">
                                <button class="btn" @click.prevent="popupDVCongThem" title="Chọn dịch vụ cộng thêm">
                                    <span class="-ap icon-more_horiz"></span>
                                </button>
                                <ul class="form-control listview" style="height: 110px;resize: none;">
                                    <li :value="dv" v-for="dv in lvDvgt.list" @click="lvDvgt.value=dv" :class="{active:lvDvgt.value==dv}">{{dv}}</li>
                                </ul>
                            </div>

                        </div>
                        <div class="col-sm-3 col-12">
                            <div class="legend-title mart10">Dịch vụ khác</div>
                            <div class="input-more-button">
                                <button class="btn" @click.prevent="popupDVKhac" title="Chọn dịch vụ khác">
                                    <span class="-ap icon-more_horiz"></span>
                                </button>
                                <ul class="form-control listview" style="height: 110px;resize: none;">
                                    <li :value="dv.dvkhac_id" v-for="dv in lvDvkhac.list" v-if="dv.loaiid==1" @click="lvDvkhac.value=dv.dvkhac_id" :class="{active:lvDvkhac.value==dv.dvkhac_id}">{{dv.ten_dvkhac}}</li>
                                </ul>
                            </div>

                        </div>
                        <div class="col-sm-3 col-12">
                            <div class="legend-title mart10">Mua thiết bị/ Phí thu 1 lần</div>
                            <div class="input-more-button">
                                <button class="btn" @click.prevent="popupMuaTB" title="Chọn chi tiết Mua thiết bị / Phí thu 1 lần (khởi tạo/khai báo/duy trì )">
                                    <span class="-ap icon-more_horiz"></span>
                                </button>
                                <ul class="form-control listview" style="height: 110px;resize: none;">
                                    <li :value="dv" v-for="dv in lvMuaThietbi.list" @click="lvMuaThietbi.value=dv" :class="{active:lvMuaThietbi.value==dv}">{{dv}}</li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-sm-3 col-12">
                            <div class="legend-title mart10">Chi tiết tiền theo khoản mục</div>
                            <div class="info-row">
                                <div class="key w70">Tổng tiền</div>
                                <div class="value">
                                    <div class="input-more-button" @click.prevent="popupTienKM">
                                        <button class="btn" title="Tổng tiền">
                                            <span class="-ap icon-more_horiz"></span>
                                        </button>
                                        <vue-numeric class="form-control tright red fw6 disabled" separator="." decimal-separator="," :precision="is_nv_vnpti==1?2:0" v-model="tongtienkm" placeholder="0" output-type="Number"></vue-numeric>
                                    </div>
                                </div>
                            </div>
                            <div class="info-row">
                                <div class="key w70">Tổng VAT</div>
                                <div class="value disabled">
                                    <vue-numeric class="form-control tright red fw6" separator="." decimal-separator="," :precision="is_nv_vnpti==1?2:0" v-model="tongvatkm" placeholder="0" output-type="Number" title="Tổng thuế"></vue-numeric>
                                </div>
                            </div>
                            <div class="info-row">
                                <div class="key w70">Tổng tiền</div>
                                <div class="value disabled">
                                    <!-- <input type="text" class="form-control tright red fw6" value="0"> -->
                                    <vue-numeric class="form-control tright red fw6" separator="." decimal-separator="," :precision="is_nv_vnpti==1?2:0" :value="tongtienkm+tongvatkm" placeholder="0" output-type="Number" title="Tổng tiền"></vue-numeric>
                                </div>
                            </div>

                        </div>
                    </div>
                    <div class="legend-title padb0 mart10">
                        <div class="pull-left mart10">
                            Thông tin thuê bao
                        </div>
                        <div class="pull-right">
                            <div class="list-checks red">
                                <div class="item vcenter">
                                    <div class="info-row">
                                        <div class="check-action key w30 nowrap" title="Check vào đây nếu thuê bao chuyển từ nhà cung cấp khác sang (Viettel, FPT...)">
                                            <input type="checkbox" class="check" v-model="listbox.nhacc_cu.ischecked">
                                            <span class="name">Từ NCC khác chuyển sang</span>
                                        </div>
                                        <div class="value" :class="{disabled:!listbox.nhacc_cu.ischecked}">
                                            <select2 v-model="listbox.nhacc_cu.value" class="select-custom w100" :options="listbox.nhacc_cu.list.map(nc=>({id:nc.chuquan_id,text:nc.tenchuquan}))"></select2>
                                        </div>
                                    </div>
                                </div>
                                <div class="item vcenter">
                                    <div class="info-row">
                                        <div class="key w30 nowrap" title="Hình thức chuyển mạng">Hình thức CM</div>
                                        <div class="value" :class="{disabled:!listbox.nhacc_cu.ischecked}">
                                            <select2 v-model="listbox.hinhthuc_cm.value" class="select-custom w100" :options="listbox.hinhthuc_cm.list.map(ht=>({id:ht.htcm_id,text:ht.hinhthuc_cm}))"></select2>
                                        </div>
                                    </div>
                                </div>
                                <div class="item vcenter">
                                    <div class="info-row">
                                        <div class="key w30 nowrap">Trạng thái YC</div>
                                        <div class="value">
                                            <select2 v-model="listbox.trangthai_yc.value" class="select-custom w100" :options="listbox.trangthai_yc.list.map(tt=>({id:tt.trangthaiyc_id,text:tt.trangthai_yc}))"></select2>
                                        </div>
                                    </div>
                                </div>
                                <div class="item vcenter hidden">
                                    <div class="info-row">
                                        <div class="key w30 nowrap">Tiền thuê bao (có VAT):</div>
                                        <div class="value">
                                            {{tongtienkm+tongvatkm | currency}}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="clearfix"></div>
                    </div>
                    <div class="table-content">
                        <DataGrid
                            v-bind:columns="[
                            {fieldName: 'stt', headerText: 'STT', allowFiltering: true, allowSorting: true},
                            {fieldName: 'ma_tt', headerText: 'Mã TT', allowFiltering: true, allowSorting: true},
                            {fieldName: 'ma_tb', headerText: 'Số máy/Acc', allowFiltering: true, allowSorting: true},
                            {fieldName: 'ten_tb', headerText: 'Tên thuê bao', allowFiltering: true, allowSorting: true},
                            {fieldName: 'diachi_ld', headerText: 'Địa chỉ lắp đặt', allowFiltering: true, allowSorting: true,},
                            {fieldName: 'tongtien', headerText: 'Tiền', type: 'number', format: 'N', allowFiltering: true, allowSorting: true,},
                            {fieldName: 'ten_dvvt', headerText: 'Dịch vụ', allowFiltering: true, allowSorting: true,},
                            {fieldName: 'loaihinh_tb', headerText: 'Loại hình', allowFiltering: true, allowSorting: true,},
                            {fieldName: 'manv_tc', headerText: 'Mã NVTC', allowFiltering: true, allowSorting: true,},
                            {fieldName: 'trangthai_dongbo', headerText: 'Trạng thái đồng bộ', allowFiltering: true, allowSorting: true,},
                            ]"
                            v-bind:dataSource="lvwThueBao" :showFilter="true" :showColumnCheckbox="false"
                            dataKeyField="stt" :defaultColumnCheckboxChecked="false" @rowClicked="lvwThueBaoChanged"
                            >
                        </DataGrid>
                    </div>
                </div>
            </div>
        </div>
      </div>
    <b-modal id="popupComponents" ref="popupComponents" size="huge"
    hide-footer
    hide-header
    hide-header-close
    body-class="modal-body p-0">
        <component :is="popupComponent" ref="generalPopup" :dulieu="popupComponentData" v-bind="popupComponentAttr" isPopup="true" v-on="popupComponentEvts"></component> <!--v-dynamic-events="popupComponentEvents"-->
    </b-modal>
    <InHopDong v-if="popup.popupInBienBan" ref="popupInBienBan" :params="popupInBienBan_Param"/>
    <ThongTinHenKhachHangModal v-if="popup.thongTinHenKhachHangModal" ref="thongTinHenKhachHangModal" :hdkh_id="Number(khachhang.hdkh_id)" :quyenduoc_hen="1"  :kieu_hen="2"/>
    <frmDangKyGoiDaDVLM v-if="popup.frmDangKyGoiDaDVLM" ref="frmDangKyGoiDaDVLM" />
    <popupToaNha v-if="popup.popupToaNha" ref="popupToaNha" />
    <b-modal v-if="popup.frmHDTB_SUB_V4" id="frmHDTB_SUB_V4" modal-class="frmHDTB_SUB_V4" hide-footer hide-header no-close-on-backdrop>
        <div class="modal-content popup-box">
            <div class="popup-header">
                <div class="title"><span class="icon one-notepad"></span> Thông tin thuê bao bổ sung</div>
                <div class="close -ap icon-close" data-dismiss="modal" @click="$bvModal.hide('frmHDTB_SUB_V4')">
                </div>
            </div>
            <div class="list-actions-top">
                <ul class="list">
                    <li>
                        <a href="#" @click.prevent="frmHDTB_SUB_V4_tsbtnGhiLai_Click">
                            <span class="icon nc-icon-glyph ui-1_check-circle-08"></span> Chấp nhận
                        </a>
                    </li>
                    <li>
                        <a href="#" @click.prevent="$bvModal.hide('frmHDTB_SUB_V4')">
                            <span class="icon ui-1_circle-remove nc-icon-glyph"></span> Thoát
                        </a>
                    </li>
                </ul>
            </div>
            <div class="popup-body">
                <div class="box-form">
                    <div class="info-row">
                        <div class="key">Người đại diện</div>
                        <div class="value">
                            <input type="text"  :value="khachhang.txtNguoiKyHoSo" @change="v=>khachhang.txtNguoiKyHoSo=v.target.value" class="form-control" />
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key">Ngày sinh</div>
                        <div class="value">
                            <date-picker input-class="form-control" :format="dateFormat" :value-type="dateFormat" v-model="khachhang.dtpNgaySinh"></date-picker>
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key">Giới tính</div>
                        <div class="value">
                            <div class="list-checks mart7">
                                <div class="item">
                                    <div class="check-action">
                                        <input type="radio" class="check" value="1" v-model="khachhang.cboGioiTinh">
                                        <span class="name">Nam</span>
                                    </div>
                                </div>
                                <div class="item">
                                    <div class="check-action">
                                        <input type="radio" class="check" value="2" v-model="khachhang.cboGioiTinh">
                                        <span class="name">Nữ</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key">Số giấy tờ</div>
                        <div class="value">
                            <input type="text"  :value="khachhang.txtSoGT" @change="v=>khachhang.txtSoGT=v.target.value" class="form-control" />
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key">Ngày cấp</div>
                        <div class="value">
                            <date-picker input-class="form-control" :format="dateFormat" :value-type="dateFormat" v-model="khachhang.dtpNgayCap"></date-picker>
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key">Nơi cấp</div>
                        <div class="value">
                            <input type="text"  :value="khachhang.txtNoiCap" @change="v=>khachhang.txtNoiCap=v.target.value" class="form-control" />
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key">Email</div>
                        <div class="value">
                            <input type="text"  :value="khachhang.txtEmail" @change="v=>khachhang.txtEmail=v.target.value" class="form-control" />
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key">Số điện thoại</div>
                        <div class="value">
                            <input type="text" :value="khachhang.txtSoDT" @change="v=>khachhang.txtSoDT=v.target.value" class="form-control" />
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </b-modal>
    <b-modal v-if="popup.frmHDTB_SUB_V3" id="frmHDTB_SUB_V3" modal-class="frmHDTB_SUB_V3" hide-footer hide-header no-close-on-backdrop>
        <div class="modal-content popup-box">
            <div class="popup-header">
                <div class="title"><span class="icon one-notepad"></span> Thông tin thuê bao bổ sung</div>
                <div class="close -ap icon-close" data-dismiss="modal" @click="$bvModal.hide('frmHDTB_SUB_V3')">
                </div>
            </div>
            <div class="list-actions-top">
                <ul class="list">
                    <li>
                        <a href="#" @click.prevent="frmHDTB_SUB_V3_tsbtnGhiLai_Click">
                            <span class="icon nc-icon-glyph ui-1_check-circle-08"></span> Ghi lại
                        </a>
                    </li>
                    <li>
                        <a href="#" @click.prevent="$bvModal.hide('frmHDTB_SUB_V3')">
                            <span class="icon ui-1_circle-remove nc-icon-glyph"></span> Thoát
                        </a>
                    </li>
                </ul>
            </div>
            <div class="popup-body">
                <div class="box-form">
                    <div class="info-row">
                        <div class="key">Người ký tờ khai</div>
                        <div class="value">
                            <input type="text"  :value="khachhang.txtNguoiKyHoSo" @change="v=>khachhang.txtNguoiKyHoSo=v.target.value" class="form-control" />
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key">Chức danh</div>
                        <div class="value">
                            <input type="text"  :value="khachhang.txtChucDanh" @change="v=>khachhang.txtChucDanh=v.target.value" class="form-control" />
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </b-modal>
    <HDTB_SUB_V2 ref="dialogHDTB_SUB_V2"/>
    <!-- <HDTB_SUB_V3 ref="dialogHDTB_SUB_V3"/> -->
    <ModalImportCA v-if="popup.modalImportCA" ref="modalImportCA" :hdkh_id="khachhang.hdkh_id" :ma_gd= "khachhang.magd"/>
    <PopupThongTinUser v-if="popup.ThongTinUser" ref="ThongTinUser" id="ThongTinUser" :vkhachhang_id="khachhang.khachhang_id" :vhdkh_id="khachhang.hdkh_id"></PopupThongTinUser>

    <ejs-dialog
      :isModal="true"
      :enableResize="true"
      :resizeHandles="['All']"
      :visible="false"
      ref="Thuebao_ToaNha"
      :header='"Tra cứu thông tin tòa nhà"'
      showCloseIcon="true"
      target=".main-wrapper"
      width="60%"
      allowDragging="true"
      @close="ThuebaoToaNha_OnClose"
      v-if="popup.Thuebao_ToaNha"
    >
    <!-- :animationSettings="animationSettings" -->
      <Thuebao_ToaNha v-if="isShowThueBaoToaNha" :ma_gd="khachhang.magd" :hdtb_id="hdtb_id" />
    </ejs-dialog>
    <ChonMegaWanIOTModal ref="chonMegaWanIOTModal" @accept="acceptChonMegaWanIOT" v-if="popup.chonMegaWanIOTModal"/>
    <frmNhapDSThanhVien ref="frmNhapDSThanhVien" v-if="popup.frmNhapDSThanhVien" />
    <keep-alive>
        <component :is="frmTuVanMyTVCom" ref="dialogfrmTuVanMyTV" v-on="frmTuVanMyTVEvents"/>
    </keep-alive>

    <b-modal ref="ThongTinEmail" id="ThongTinEmail" size="xl" title="Thông tin Email" hide-footer
        body-class="p-0 thanhtoan-modal">
        <ThongTinEmail :hdkh_id="khachhang.hdkh_id" :khachhang_id="khachhang.khachhang_id" />
    </b-modal>
</div>
