<div class="main-wrapper">
	<breadcrumb :header="header" />
	<div class="list-actions-top">
		<ul class="list">
			<li>
				<a href="javascript:;" :class="{ disabled: !button.tsbtnNhapMoi }" @click="tsbtnNhapMoi_Click">
					<span class="icon one-file-plus"></span>Nhập mới
				</a>
			</li>
			<li>
				<a href="javascript:;" :class="{ disabled: !button.tsbtnGhiLai }" @click="tsbtnGhiLai_Click">
					<span class="icon one-save"></span>Ghi lại
				</a>
			</li>
			<li>
				<a href="javascript:;" :class="{ disabled: !button.tsbtnXoa }" @click="tsbtnXoa_Click">
					<span class="icon one-trash"></span>Xóa
				</a>
			</li>
			<li>
				<a href="javascript:;" :class="{ disabled: !button.tsbtnHuyBo }" @click="tsbtnHuyBo_Click">
					<span class="icon nc-icon-glyph ui-1_circle-remove"></span>Hủy
				</a>
			</li>
			<li>
				<a href="javascript:;" :class="{ disabled: !button.tsbtnThanhToan }" @click="tsbtnThanhToan_Click">
					<span class="icon nc-icon-glyph shopping_credit-card"></span>Thanh toán
				</a>
			</li>
			<li>
				<a href="javascript:;" :class="{ disabled: !button.tsbtnThemTB }" @click="tsbtnThemTB_Click">
					<span class="icon one-mobile-plus"></span>Thêm TB
				</a>
			</li>
			<li>
				<a href="javascript:;" :class="{ disabled: !button.tsbtnXoaTB }" @click="tsbtnXoaTB_Click">
					<span class="icon one-phone-remove"></span>Xóa TB
				</a>
			</li>
			<li>
				<a href="javascript:;" :class="{ disabled: !button.tsbtnCapNhatDB }" @click="tsbtnCapNhatDB_Click">
					<span class="icon one-file-check"></span>Hoàn thiện
				</a>
			</li>
			<li>
				<a href="javascript:;" @click="tsbtnThongTinLH_Click">
					<span class="icon nc-icon-glyph business_contacts"></span>Liên hệ
				</a>
			</li>
			<li>
				<a href="javascript:;" @click="tsbtnEmail_Click">
					<span class="icon one-email"></span>Email
				</a>
			</li>
		</ul>
	</div>
	<div class="page-content">
		<div class="box-form">
			<div class="row">
				<div class="col-sm-8 col-12">

				</div>
				<div class="col-sm-2 col-12">
					<div class="info-row">
						<div class="key w20 nowrap fw6">
							<div class="check-action">
								<input type="checkbox" class="check" v-model="filterbox.ctv.chkCTV" @change="ShowPopupCTV">
								<span class="name">Cộng tác viên</span>
							</div>
						</div>
						<div class="value">
							<input type="text" class="form-control bold" v-bind:value="filterbox.ctv.txtCTV"
								@change="e => filterbox.ctv.txtCTV = e.target.value" disabled>
						</div>
					</div>
				</div>
				<div class="col-sm-2 col-12">
					<div class="info-row">
						<div class="key w20 nowrap fw6">
							<div class="check-action">
								<input type="checkbox" class="check" v-model="filterbox.nguoigt.chkNguoiGT" @change="ShowPopupNguoiGT">
								<span class="name">Người giới thiệu</span>
							</div>
						</div>
						<div class="value">
							<input type="text" class="form-control bold" v-bind:value="filterbox.nguoigt.txtNguoiGT"
								@change="e => filterbox.nguoigt.txtNguoiGT = e.target.value" disabled>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-sm-6 col-12">
				<div class="box-form">
					<div class="legend-title">Thông tin thuê bao</div>
					<div class="row">
						<div class="col-sm-5 col-12">
							<div class="info-row">
								<div class="key w90">Mã giao dịch</div>
								<div class="value">
									<div class="input-more-button">
										<button class="btn" @click="btnLayMaGD_Click">
											<span class="-ap icon-more_horiz"></span>
										</button>
										<input type="text" class="form-control highlight bold" ref="txtMaGD" v-bind:value="leftForm.txtMaGD"
											@change="e => leftForm.txtMaGD = e.target.value" @keyup.enter="txtMaGD_KeyPress">
									</div>
								</div>
							</div>
						</div>
						<div class="col-sm-7 col-12">
							<div class="info-row">
								<div class="key w90">Ngày yêu cầu</div>
								<div class="value">
									<!-- <ejs-datepicker v-model="leftForm.dtpNgayYeuCau" :value="today" :format="'dd/MM/y'" :allowEdit="true"
									ref="dtpNgayYeuCau" placeholder="__/__/____" @change="onChangeNgayYC">
								</ejs-datepicker> -->
									<DatePicker disabled :format="dateFormat" :value-type="'format'" v-model="leftForm.dtpNgayYeuCau"
										ref="dtpNgayYeuCau" @change="onChangeNgayYC"
										:input-attr="{required: 'true',title: 'Bạn chưa nhập ngày bắt đầu!'}">
									</DatePicker>
								</div>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-sm-5 col-12">
							<div class="info-row">
								<div class="key w90">Số máy/Acc</div>
								<div class="value">
									<div class="input-more-button">
										<button class="btn" @click="btnTKMaTB_Click">
											<span class="-ap icon-more_horiz"></span>
										</button>
										<input type="text" class="form-control highlight bold" ref="txtMaTB" v-bind:value="leftForm.txtMaTB"
											@change="e => leftForm.txtMaTB = e.target.value" @keyup.enter="txtMaTB_KeyPress">
									</div>
								</div>
							</div>
						</div>
						<div class="col-sm-7 col-12">
							<div class="info-row">
								<div class="key w90">Dịch vụ</div>
								<div class="value">
									<div class="select-custom" ref="dsdichvuvt">
										<select2 :settings="{ dropdownParent: $refs['dsdichvuvt'] }" v-model="cp_dichvuvt_id"
											class="select2" :options="ds_dichvuvt"></select2>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-sm-5 col-12">
							<div class="info-row">
								<div class="key w90">Loại hình</div>
								<div class="value">
									<div class="select-custom" ref="dsloaihinhtb">
										<select2 :settings="{ dropdownParent: $refs['dsloaihinhtb'] }" v-model="leftForm.cboLoaiHinhTB"
											class="select2" :options="ds_loaihinhtb" @change="onChangeLoaiHinhTB"></select2>
									</div>
								</div>
							</div>
						</div>
						<div class="col-sm-7 col-12">
							<div class="info-row">
								<div class="key w90">Tốc độ</div>
								<div class="value">
									<div class="select-custom" ref="dstocdo">
										<select2 :settings="{ dropdownParent: $refs['dstocdo'] }" v-model="leftForm.cboGoiCuocAdsl"
											class="select2" :options="ds_tocdo"></select2>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="info-row">
						<div class="key w90">Tên thuê bao</div>
						<div class="value">
							<input type="text" class="form-control bold" v-bind:value="leftForm.txtTenTB"
								@change="e => leftForm.txtTenTB = e.target.value" disabled>
						</div>
					</div>
					<div class="info-row">
						<div class="key w90">Địa chỉ LĐ</div>
						<div class="value">
							<input type="text" class="form-control bold" v-bind:value="leftForm.txtDiaChiLD"
								@change="e => leftForm.txtDiaChiLD = e.target.value" disabled>
						</div>
					</div>
				</div>
			</div>
			<div class="col-sm-6 col-12">
				<div class="box-form">
					<div class="legend-title">Thông tin trả trước</div>
					<div class="info-row">
						<div class="key w90">Trả trước</div>
						<div class="value">
							<div class="input-more-button">
								<button class="btn" @click="btnChon_TraTruoc_Click">
									<span class="-ap icon-more_horiz"></span>
								</button>
								<div class="select-custom" ref="dstratruoc">
									<select2 :settings="{ dropdownParent: $refs['dstratruoc'] }" ref="cboTraTruoc"
										v-model="rightForm.cboTraTruoc" class="select2" @change="onChangeTraTruoc"
										:options="ds_tratruoc.map(e=> ({id: e.khuyenmai_id,text: e.ten_km}))"></select2>
								</div>
							</div>

						</div>
						<div class="value w30 nowrap">
							<button class="btn btn-second" @click="btnChiTiet_Click">
								<span class="one-eye f20 inline vcenter"></span> Chi tiết
							</button>
						</div>
					</div>
					<div class="row">
						<div class="col-sm-4 col-12">
							<div class="info-row">
								<div class="key w90">
									<div class="check-action">
										<input type="checkbox" class="check" v-model="chkThoiHan.Checked" :disabled="!chkThoiHan.Enabled">
										<span class="name">Thời hạn</span>
									</div>
								</div>
								<div class="value">
									<input type="number" class="form-control bold tright" :class="{disabled:!chkThoiHan.Checked}"
										v-bind:value="cp_txtThoiHan" @change="e => cp_txtThoiHan = e.target.value">
								</div>
								<div class="value w20 nowrap padt7">
									(tháng)
								</div>
							</div>
						</div>
						<div class="col-sm-4 col-12">
							<div class="info-row">
								<div class="key w70">
									Từ ngày
								</div>
								<div class="value" :class="{disabled:!chkThoiHan.Checked}">
									<!-- <ejs-datepicker v-model="rightForm.dtpTuNgay" :value="today" :format="'dd/MM/y'" :allowEdit="true" ref="dtpTuNgay"
									placeholder="__/__/____">
								</ejs-datepicker> -->
									<DatePicker :format="dateFormat" :value-type="'format'" v-model="rightForm.dtpTuNgay" ref="dtpTuNgay"
										@change="onChangeNgayBD" :input-attr="{required: 'true',title: 'Bạn chưa nhập ngày bắt đầu!'}">
									</DatePicker>
								</div>

							</div>
						</div>
						<div class="col-sm-4 col-12">
							<div class="info-row">
								<div class="key w70">
									Đến ngày
								</div>
								<div class="value" :class="{disabled:!chkThoiHan.Checked}">
									<!-- <ejs-datepicker v-model="rightForm.dtpDenNgay" :value="today" :format="'dd/MM/y'" :allowEdit="true"
									ref="dtpDenNgay" placeholder="__/__/____">
								</ejs-datepicker> -->
									<DatePicker :format="dateFormat" :value-type="'format'" v-model="rightForm.dtpDenNgay"
										ref="dtpDenNgay" :input-attr="{required: 'true',title: 'Bạn chưa nhập ngày kết thúc!'}">
									</DatePicker>
								</div>

							</div>
						</div>
					</div>
					<div class="info-row">
						<div class="key w90">Ghi chú</div>
						<div class="value">
							<textarea name="" class="form-control" style="height: 70px;resize: none;"
								v-bind:value="rightForm.txtGhiChu" @change="e => rightForm.txtGhiChu = e.target.value"></textarea>
						</div>

					</div>
					<div class="row">
						<div class="col-sm-4 col-12">
							<div class="info-row">
								<div class="key w90">
									Tổng tiền
								</div>
								<div class="value">
									<div class="input-more-button">
										<button class="btn" @click="btnTien_Click" :disabled="!button.btnTien">
											<span class="-ap icon-more_horiz"></span>
										</button>
										<input type="text" class="form-control bold tright red" value="0" v-bind:value="cp_SumTien"
											@change="e => cp_SumTien = e.target.value" disabled>
									</div>
								</div>

							</div>
						</div>
						<div class="col-sm-4 col-12">
							<div class="info-row">
								<div class="key w70">
									Tiền
								</div>
								<div class="value">
									<input type="text" class="form-control bold tright red" value="0" v-bind:value="cp_TongTien"
										@change="e => cp_TongTien = e.target.value" disabled>
								</div>

							</div>
						</div>
						<div class="col-sm-4 col-12">
							<div class="info-row">
								<div class="key w70">
									Vat
								</div>
								<div class="value">
									<input type="text" class="form-control bold tright red" value="0" v-bind:value="cp_TongVat"
										@change="e => cp_TongVat = e.target.value" disabled>
								</div>

							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="box-form">
			<div class="legend-title">Danh sách thuê bao đặt cọc</div>
			<DataGrid class="table-result table-gachle" :columns="gridDanhSach.header" :dataSource="gridDanhSach.list"
				:enable-paging-server="false" :allowPaging="true" :showFilter="true" :showColumnCheckbox="false"
				:enabledSelectFirstRow="true" ref="gvDanhSach" @selectedItemsChanged="gvDanhSach_FocusedRowChanged"
				panelDataHeight="300px" />
		</div>
	</div>
	<DanhSachThueBaoCungMaModal ref="danhSachThueBaoCungMaModal" @accept="acceptThueBaoCungMa" :data="dsTBCungMa" />

	<SearchContractModal ref="popupSearchContract" @accept="acceptTimKiemHDTB" :loai_hd_id="31"
		:dichvu_id="cp_dichvuvt_id" :tieuchi_id="tieuchi_id" :thongtin_tracuu="thongtin_tracuu" />

	<!-- <ejs-dialog :enableResize='true' :visible="false" ref="popupSearchAccount" target=".main-wrapper" width='80%'
		height="800" allowDragging="true" :position="position">
		<SearchAccount :isPopup="true" :vma_tb="leftForm.txtMaTB" :vdichvuvt_id="leftForm.cboDichVuVT"
			@form-close="acceptTimKiemTB" />
	</ejs-dialog> -->

	<!-- <ejs-dialog :enableResize='true' :visible="false" ref="thongtinlienhe" :header='"Thông tin liên hệ"'
		showCloseIcon=true target=".main-wrapper" width='80%' height="800" :allowDragging="true" :position="position">
		<ThongTinLienHe :hdkh_id="hdkh_id" :khachhang_id="khachhang_id" />
	</ejs-dialog> -->
	<b-modal ref="thongtinlienhe" size="xl" title="Thông tin liên hệ" no-close-on-backdrop hide-footer body-class="p-0">
		<ThongTinLienHe :hdkh_id="hdkh_id" :khachhang_id="khachhang_id" />
	</b-modal>

	<!-- <ejs-dialog :enableResize='true' :visible="false" ref="thongtinemail" :header='"Thông tin Email"' showCloseIcon=true
		target=".main-wrapper" width='80%' height="800" :allowDragging="true" :position="position">
		<ThongTinEmail :hdkh_id="hdkh_id" :khachhang_id="khachhang_id" />
	</ejs-dialog> -->
	<b-modal ref="thongtinemail" size="xl" title="Thông tin Email" no-close-on-backdrop hide-footer body-class="p-0">
		<ThongTinEmail :hdkh_id="hdkh_id" :khachhang_id="khachhang_id" />
	</b-modal>

	<DangKyChiTietKhuyenMaiModal ref="dangKyChiTietKhuyenMaiModal" :dulieu="popupComponentData"
		@form-close="formCloseChiTietKM" />

	<b-modal id="popupComponents" size="xl" :title="popupComponentHeader" :hide-header="popupComponentHeader?false:true"
		hide-footer body-class="modal-body p-0">
		<component :is="popupComponent" ref="generalPopup" :dulieu="popupComponentData" v-bind="popupComponentAttr"
			isPopup="true" v-on="popupComponentEvts"></component>
	</b-modal>

	<script type="application/javascript" src="../vendor/jquery/split.js"></script>
</div>