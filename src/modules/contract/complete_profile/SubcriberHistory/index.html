<div>
  <div class="breadcrumb-top">
    <div class="main-title">{{title}}</div>
    <ul class="breadcrumb">
      <li class="breadcrumb-item">
        <a href="#"><span class="nc-icon-outline ui-1_home-simple"></span> Trang chủ
        </a>
      </li>
      <li class="breadcrumb-item"><a href="#">Lập hợp đồng</a></li>
      <li class="breadcrumb-item active">Lắp đặt mới</li>
    </ul>
  </div>
  <div class="list-actions-top">
    <ul class="list">
      <li>
        <a @click="tsbtnInPhieu_HH_Click"> <span class="icon one-print"></span>In phiếu </a>
      </li>
      <li ref="tsbtnDieuBD" @click="tsbtnDieuBD_Click()" style="display:none">
        <a >
          <span class="icon one-reload"></span> Điều bảo dưỡng
        </a>
      </li>
      <li ref="tsbtnDieuTheoFile" style="display:none">
        <a @click="tsbtnDieuTheoFile_Click" >
          <span class="icon one-file-attach"></span> Điều theo file
        </a>
      </li>
      <input ref="fileInput" id="file" type="file" @change="onChangeFile($event)" accept=".xls, .xlsx" style="display:none" class="form-control ">
      <li ref="tsbtnFileMau" style="display:none">
        <a>
          <downloadExcel
            :fields="exportExcelFields"
            :data="mau_excel"
            worksheet="export"
            name="FileMauDieuBaoDuong.xls"
            :before-generate="toolStripButton1_Click">
          <span class="icon one-download"></span> Mẫu file
        </downloadExcel>
      </a>
      </li>
    </ul>
    <span ref="lbMauFile" class="red pull-right" style="display: flex;align-items: center;">{{label}}</span>
    <div class="more dropdown">
      <a href="#" data-toggle="dropdown">
        <span class="icon -ap icon-dots-three-vertical"></span>
      </a>
    </div>
  </div>
  <div class="page-content">
    <div class="grid-stack-box" style="">
      <div class="box-col box-form" id="boxLeft" style="width: calc(40% - 8px)">
        <div class="legend-title">
          <div class="pull-left">Thông tin thuê bao</div>
          <div class="pull-right red">
            <div class="check-action normal">
              <input style="display: none" ref="chkDieuKey" type="checkbox" class="check">
              <span class="name">Điều nhân sự key</span>
          </div>
          </div>
          <div class="clearfix"></div>
        </div>
        <div class="row">
          <div class="col-sm-6 col-12">
            <div class="info-row">
              <div class="key">Dịch vụ</div>
              <div class="value">
                <div class="select-custom">
                  <Select2Ext @change="cboDichVu_EditValueChanged" ref="cboDichVu"></Select2Ext>
                </div>
              </div>
            </div>
          </div>
          <div class="col-sm-6 col-12">
            <div class="info-row">
              <div class="key w90">Loại hình</div>
              <div class="value">
                <div class="select-custom">
                  <Select2Ext ref="cboLoaiHinh"></Select2Ext>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-6 col-12">
            <div class="info-row">
              <div class="key">Số máy/Acc</div>
              <div class="value">
                <div class="input-more-button">
                  <button @click="SearchDanhBa" class="btn">
                    <span class="-ap icon-more_horiz"></span>
                  </button>
                  <input @keyup.enter="txtMaTB_KeyDown" ref="txtMaTB" type="text" class="form-control highlight" />
                </div>
              </div>
            </div>
          </div>
          <div class="col-sm-6 col-12">
            <div class="info-row">
              <div class="key w90">Tên thuê bao</div>
              <div class="value">
                <input ref="txtTenTB" type="text" class="form-control" />
              </div>
            </div>
          </div>
        </div>
        <div class="info-row">
          <div class="key">Địa chỉ thuê bao</div>
          <div class="value">
            <input ref="txtDiaChiTB" type="text" class="form-control" />
          </div>
        </div>
        <div class="row">
          <div class="col-sm-6 col-12">
            <div class="info-row">
              <div class="key">Tổ quản lý</div>
              <div class="value">
                <input ref="txtToQL" type="text" class="form-control" />
              </div>
            </div>
          </div>
          <div class="col-sm-6 col-12">
            <div class="info-row">
              <div class="key w90">Thợ dây</div>
              <div class="value">
                <input ref="txtThoQL" type="text" class="form-control" />
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-6 col-12">
            <div class="info-row">
              <div class="key">Ngày sử dụng</div>
              <div class="value">
                <div class="input-icon-right">
                  <input ref="txtNgaySD" type="text" class="form-control" />
                  <span class="icon one-calendar"></span>
                </div>
              </div>
            </div>
          </div>
          <div class="col-sm-6 col-12">
            <div class="info-row">
              <div class="key w90">Độ dài dây</div>
              <div class="value">
                <input ref="txtDoDaiDay" type="text" class="form-control" />
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-6 col-12">
            <div class="info-row">
              <div class="key">
                <div class="check-action">
                  <input ref="chkDenTu" type="checkbox" class="check" />
                  <span class="name">Hẹn từ</span>
                </div>
              </div>
              <div class="value">
                <div class="input-icon-right">
                  <VueDateExt ref="dtpDenTu" />
                </div>
              </div>
            </div>
          </div>
          <div class="col-sm-6 col-12">
            <div class="info-row">
              <div class="key w90">Hẹn đến</div>
              <div class="value">
                <VueDateExt ref="dtpDenTu" />
              </div>
            </div>
          </div>
        </div>
        <div class="info-row">
          <div class="key">Ghi chú</div>
          <div class="value">
            <textarea ref="txtGhiChu" name="" class="form-control" style="height: 46px; resize: none" id="" cols="30"
              rows="10"></textarea>
          </div>
        </div>
      </div>
      <div class="gutter gutter-horizontal" style="width: 16px"></div>
      <div class="box-col box-form" id="boxMid" style="width: calc(30% - 16px)">
        <div class="legend-title">Thông số kỹ thuật</div>
        <div class="article">
          <p ref="wbrTSKT">
            
          </p>
        </div>
      </div>
      <div class="gutter gutter-horizontal" style="width: 16px"></div>
      <div class="box-col box-form" id="boxRight" style="width: calc(30% - 8px)">
        <div class="legend-title">Danh sách thuê bao lắp kèm</div>
        <div class="table-content">
          <DataGridCustom ref="gridThueBaoKem" @selectedRowChanged="loadDanhsachlichsu" :columns="columnsTBLK" />
        </div>
      </div>
    </div>
    <div class="box-form">
      <div class="grid-stack-box">
        <div class="box-col" id="boxLeft1" style="width: calc(70% - 8px)">
          <div class="legend-title">Thông tin lịch sử hỏng</div>
          <div class="grid-ext SubcriberHistory" style="height: 300px">
            <ejs-grid :dataSource='gridDanhsachBaohong' gridLines="Both" height="250" :detailTemplate ='detailTemplate'>
              <e-columns>
                  <e-column field='ma_tb' headerText='Số máy/Acc' textAlign='Right' width=120></e-column>
                  <e-column field='ma_lt' headerText='Số ảo' width=150></e-column>
                  <e-column field='ten_tb' headerText='Tên thuê bao' width=150></e-column>
                  <e-column field='diachi_ld' headerText='Địa chỉ lắp đặt' width=150></e-column>
                  <e-column field='nguoi_bh' headerText='Người báo hỏng' width=150></e-column>
                  <e-column field='ngay_bh' headerText='Ngày báo hỏng' width=150></e-column>
                  <e-column field='dienthoai_lh' headerText='Điện thoại liên hệ' width=150></e-column>
                  <e-column field='ten_dvvt' headerText='Dịch vụ' width=150></e-column>
                  <e-column field='loaihinh_tb' headerText='Loại hình' width=150></e-column>
                  <e-column field='trangthai_bh' headerText='Trạng thái' width=150></e-column>
                  <e-column field='luot_bh' headerText='Lần BH' width=150></e-column>
                  <e-column field='lan_pa' headerText='KH gọi' width=150></e-column>
                  <e-column field='lan_ks' headerText='Lần KS' width=150></e-column>
                  <e-column field='tinhtrang' headerText='Tình trang' width=150></e-column>
                  <e-column field='nguyennhan' headerText='Nguyên nhân' width=150></e-column>
                  <e-column field='ghichu_hong' headerText='Ghi chú hỏng' width=150></e-column>
                  <e-column field='ghichu_xl' headerText='Ghi chú XL' width=150></e-column>
              </e-columns>
          </ejs-grid>
          </div>
        </div>
        <div class="gutter gutter-horizontal" style="width: 16px"></div>
        <div class="box-col" id="boxRight1" style="width: calc(30% - 8px)">
          <div ref="pnlGianDo">
            <div class="legend-title">Giản đồ cáp</div>
            <div class="table-content" style="height: 300px">
              <DataGridCustom ref="gridGianDo" :columns="columnsGiando" />
            </div>
          </div>
          <div ref="pnlDs_ThueBao" style="display: none;">
            <div class="legend-title">Danh sách thuê bao cùng khách hàng</div>
            <div class="table-content" style="height: 300px">
              <DataGridCustom ref="grid_DanhSach" :columns="columnsDsThuebao" />
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <ejs-dialog :enableResize="true" :visible="false" :position="position" ref="searchAccountDialog" :header="'Tra cứu danh bạ'" showCloseIcon="true" target="#app" width="80%" height="800">
    <div class="SubcriberHistory-popup popupBody">
      <searchAccount :isPopup="true" @form-close="searchAccountDialogClose" />
    </div>
  </ejs-dialog>
  <XemBaoCao ref="popupXemBaoCao" ma_bc="LYLICH_TB" :dsGiaTri="dsGiaTriHD" />
</div>
