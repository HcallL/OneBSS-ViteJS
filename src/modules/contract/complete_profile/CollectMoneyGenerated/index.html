<div>
    <vue-bread-crumb :header="header" />
    <vue-nav>
        <ul class="list">
            <li>
                <a v-on:click="clickButton('layTT')" :class="{ disabled: !button.layTT }">
                    <span class="icon one-file-plus"></span> Lấy TT (F5)
                </a>
            </li>
            <li>
                <a v-on:click="clickButton('capnhat')" :class="{ disabled: !button.capnhat }">
                    <span class="icon one-reload1"></span>Cập nhật (F9)
                </a>
            </li>
            <li>
                <a v-on:click="clickButton('giaoviec')" :class="{ disabled: !button.giaoviec }">
                    <span class="icon one-file-edit2"></span>Giao việc
                </a>
            </li>
            <li>
                <a v-on:click="clickButton('hoancong')" :class="{ disabled: !button.hoancong }">
                    <span class="icon one-hoancong"></span>Hoàn công
                </a>
            </li>
            <li>
                <a v-on:click="clickButton('xuatphieu')" :class="{ disabled: !button.xuatphieu }">
                    <span class="icon one-file-download"></span>Xuất phiếu
                </a>
            </li>
            <!-- <li>
                <a v-on:click="clickButton('test')" :class="{ disabled: !button.xuatphieu }">
                    <span class="icon one-file-download"></span>tesst
                </a>
            </li> -->
        </ul>
    </vue-nav>
    <div class="page-content">
        <div class="row">
            <div class="col-sm-6 col-12">
                <div class="box-form">
                    <!-- THONG TIN KHACH HANG -->
                    <div class="legend-title">
                        <div class="pull-left">Thông tin khách hàng</div>
                        <div class="clearfix"></div>
                    </div>

                    <b-row>
                        <div class="col-sm-6 col-12">
                            <div class="info-row">
                                <div class="key w120">Dịch vụ</div>
                                <div class="value">
                                    <SelectExt v-model="form.dich_vu_id" :allowFiltering="true"
                                        data-text-field="TEN_DVVT" data-value-field="DICHVUVT_ID"
                                        :dataSource="cbDichVu" />
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6 col-12">
                            <div class="info-row">
                                <div class="key w80">Quy trình</div>
                                <div class="value">
                                    <SelectExt v-model="form.quy_trinh_id" :allowFiltering="true"
                                        data-text-field="quytrinh" data-value-field="quytrinh_id"
                                        :dataSource="cbQuyTrinh" @change="cboQuyTrinh_SelectedValueChanged" />
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6 col-12">
                            <div class="info-row">
                                <div class="key w120">Mã giao dịch</div>
                                <div class="value">
                                    <input type="text" class="form-control fw-bold" v-model="form.ma_gd"
                                        @keyup.enter="txtMaGD_KeyPress" />
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6 col-12">
                            <div class="info-row">
                                <div class="key w80 nowrap">Mã thuê bao</div>
                                <!-- <ejs-textbox v-model="form.ma_tb" /> -->
                                <div class="value">
                                    <input type="text" class="form-control" v-model="form.ma_tb" 
                                    />
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-12 col-12">
                            <div class="info-row">
                                <div class="key w120">Kiểu yêu cầu</div>
                                <div class="value">
                                    <input type="text" class="form-control fw-bold" v-model="form.kieu_yc" />
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-12 col-12">
                            <div class="info-row">
                                <div class="key w120">Tên khách hàng</div>
                                <div class="value">
                                    <input type="text" class="form-control fw-bold" v-model="form.ten_kh" />
                                </div>
                            </div>
                        </div>

                        <div class="col-sm-12 col-12">
                            <div class="info-row">
                                <div class="key w120">Địa chỉ khách hàng</div>
                                <div class="value">
                                    <input type="text" class="form-control fw-bold" v-model="form.dia_chi_kh" />
                                </div>
                            </div>
                        </div>

                        <div class="col-sm-12 col-12">
                            <div class="info-row">
                                <div class="key w120">Tên thanh toán</div>
                                <div class="value">
                                    <input type="text" class="form-control fw-bold" v-model="form.ten_thanh_toan" />
                                </div>
                            </div>
                        </div>

                        <div class="col-sm-12 col-12">
                            <div class="info-row">
                                <div class="key w120">Địa chỉ thanh toán</div>
                                <div class="value">
                                    <input type="text" class="form-control fw-bold" v-model="form.dia_chi_thanh_toan" />
                                </div>
                            </div>
                        </div>
                    </b-row>
                </div>
                <div class="box-form">
                    <div class="legend-title">Thông tin hoàn công</div>
                    <div class="row">
                        <div class="col-sm-6 col-12">
                            <div class="info-row">
                                <div class="key w120 nowrap">
                                    <div class="check-action">
                                        <input id="isChecked_KQ_XL" type="checkbox" class="check"
                                            v-model="form.isChecked_KQ_XL" />
                                        <span for="isChecked_KQ_XL" class="name">Kết quả XL</span>
                                    </div>
                                </div>
                                <div class="value">
                                    <SelectExt v-model="form.kq_xl" :allowFiltering="true" data-text-field="ketqua_xl"
                                        data-value-field="kqxl_id" :dataSource="cbKQ_XL"
                                        :disabled="!form.isChecked_KQ_XL" />
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6 col-12">
                            <div class="info-row">
                                <div class="key w80 nowrap">Đổi tốc độ</div>
                                <div class="value padt7 w20">
                                    <div class="check-action">
                                        <input type="checkbox" class="check" v-model="form.isChecked_Doi_Toc_Do" @change="chkTocDo"/>
                                        <span class="name"></span>
                                    </div>
                                </div>

                                <div class="value">
                                    <SelectExt v-model="form.doi_toc_do" :allowFiltering="true" data-text-field="tocdo"
                                        data-value-field="tocdo_id" :dataSource="cbDoiTocDo"
                                        :disabled="!form.isChecked_Doi_Toc_Do" />
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key w120">
                            <div class="check-action">
                                <input type="checkbox" class="check" v-model="form.chkKM" @change="chkTTruoc"/>
                                <span class="name">T.Trước</span>
                            </div>
                        </div>
                        <div class="value">
                            <div class="input-more-button">
                                <button class="btn">
                                    <span class="-ap icon-more_horiz"></span>
                                </button>
                                <div class="select-custom">
                                    <SelectExt v-model="form.km" :allowFiltering="true" data-text-field="ten_km"
                                        data-value-field="khuyenmai_id" :dataSource="cbKM" :disabled="!form.chkKM" />
                                </div>
                            </div>
                        </div>
                        <div class="value w30 nowrap">
                            <button class="btn btn-second" :disabled="!form.chkKM">
                                <span class="one-eye f20 inline vcenter"></span> Chi tiết
                            </button>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-6 col-12">
                            <div class="info-row">
                                <div class="key w120">
                                    Cước ĐC
                                </div>
                                <div class="value">
                                    <input type="text" class="form-control fw-bold" v-model="form.cuocDC" disabled="true" />
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6 col-12">
                            <div class="info-row">
                                <div class="key w80">Tiền/ tháng</div>

                                <div class="value">
                                    <input type="text" class="form-control fw-bold" v-model="form.tienTD" disabled="true" />
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-6 col-12">
                            <div class="info-row">
                                <div class="key w120">
                                    Số tháng
                                </div>
                                <div class="value">
                                    <input type="text" class="form-control fw-bold" v-model="form.so_thang" disabled="true" />
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6 col-12">
                            <div class="info-row">
                                <div class="key w80">Tổng tiền</div>

                                <div class="value">
                                    <div class="input-more-button">
                                        <button class="btn" @click="btnTien_Click">
                                            <span class="-ap icon-more_horiz"></span>
                                        </button>
                                        <input type="text" class="form-control red tright fw-bold" v-model="form.tong_tien" />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-sm-6 col-12">
                <div class="box-form">
                    <div class="legend-title">Thông tin giao việc</div>
                    <div class="row">
                        <div class="col-sm-6 col-12">
                            <div class="info-row">
                                <div class="key w90">
                                    <div class="check-action">
                                        <input type="checkbox" class="check" v-model="form.isChecked_ngayGV" />
                                        <span class="name nowrap">Ngày GV</span>
                                    </div>
                                </div>
                                <div class="value">
                                    <vue-date class="col-sm-12 col-12" labelWidth="0" v-model="form.ngay_gv" type="datetime"
                                        format="DD/MM/YYYY hh:mm" :checkbox="!form.isChecked_ngayGV">
                                    </vue-date>
                                </div>
                            </div>
                        </div>

                        <div class="col-sm-6 col-12">
                            <div class="info-row">
                                <div class="key w80">
                                    <div class="check-action">
                                        <input id="isChecked_ngayHT" type="checkbox" class="check"
                                            v-model="form.isChecked_ngayHT" />
                                        <span class="name">Ngày HT</span>
                                    </div>
                                </div>
                                <div class="value">
                                    <vue-date labelWidth="0" v-model="form.ngay_ht" type="datetime"
                                        format="DD/MM/YYYY hh:mm" class="col-sm-12 col-12"
                                        :checkbox="!form.isChecked_ngayHT">
                                    </vue-date>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key w100">Người GV</div>

                        <div class="value">
                            <div class="select-custom">
                                <SelectExt v-model="form.nguoi_gv" :allowFiltering="true" data-text-field="ten_nv"
                                    data-value-field="nhanvien_id" :dataSource="cbNguoiGv" />
                            </div>
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key w100">Nhân viên YC</div>
                        <div class="value">
                            <input type="text" class="form-control" v-model="form.nv_yc" />
                            
                        </div>
                    </div>

                    <div class="info-row">
                        <div class="key w100">Nội dung giao</div>

                        <div class="value">
                            <input type="text" class="form-control" v-model="form.noi_dung_giao" />
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key w100">Nội dung TH</div>

                        <div class="value">
                            <div class="input-more-button">
                                <button class="btn" @click="btnNDTH_Click">
                                    <span class="nc-icon-glyph ui-1_edit-76 f16"></span>
                                </button>
                                <input type="text" class="form-control" v-model="form.noi_dung_th" />
                            </div>
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key w100">Ghi chú</div>

                        <div class="value">
                            <textarea name="" class="form-control" style="height: 66px;resize: none;" id="" cols="30"
                                rows="10" v-model="form.txtGhiChu"></textarea>
                        </div>
                    </div>

                </div>
                <div class="box-form">

                    <!-- <div class="legend-title">
                        Danh sách nhân viên thực hiện
                    </div>
                    <DataGrid ref="danh_sach_nhan_vien" :showFilter="true" :allowPaging="true"
                        :enablePagingServer="false" :dataSource="options.nhanvien" :columns="config.nhanvien" /> -->

                        <div class="legend-title">
                            Danh sách nhân viên thực hiện
                        </div>
                        <DataGrid ref="danh_sach_nhan_vien" :showFilter="true" :allowPaging="true" :enablePagingServer="false"
                            :dataSource="options.nhanvien" :columns="config.nhanvien" />
                </div>
            </div>
        </div>
        <div class="box-form">

            <div class="legend-title">
                Danh sách hợp đồng
            </div>
            <!-- <ejs-grid 
                :selectedRowIndex='index'
                :dataSource='options.hopdong'  
                ref="grid_hopdong" 
                :searchSettings="{fields: ['ma_gd']}" 
                :allowSelection='true' 
                :rowSelected='rowSelected'
                
                :allowPaging='true' 
                :allowFiltering="true"
                :filterSettings="{showFilterBarOperator: false, mode: 'Immediate', immediateModeDelay: 500}"
                :pageSettings='{pageSize: 10, pageSizes: [10,50,100,200]}' 
                gridLines='Both'
            >
                <e-columns>
                    <template v-for="col in config.hopdong">
                        <e-column :field='col.fieldName' :headerText="col.headerText"></e-column>
                    </template>
                </e-columns>
            </ejs-grid> -->
            <DataGrid 
                ref="grid" 
                :showFilter="true" :allowPaging="true" 
                :enablePagingServer="false"
                :dataSource="options.hopdong" 
                :columns="config.hopdong" 
                @selectedRowChanged="rowSelected"
                />
            <!-- <b-model ref="dialogGiaoPhieuNV" hide-footer title="Giao phiếu nhân viên">
                <GiaoPhieuNV />
            </b-model> -->
            <ejs-dialog :visible='false' ref="dialogGiaoPhieuNV" 
                :header='"Giao phiếu nhân viên"' showCloseIcon=true width='80%'
                target='#app .main-wrapper'>
                <GiaoPhieuNV/>
            </ejs-dialog>

            <InBienBan ref="popupInHopDong" :params="params" />

            <!-- Tiền khoản mục -->
            <b-modal ref="popupTienKM" size="lg" hide-footer hide-header hide-header-close body-class="modal-body p-0">
                <Popup_TienKM :dulieu="dulieuTienKM" @form-close="formCloseTienKM" />
            </b-modal>
            
        </div>
    </div>
</div>