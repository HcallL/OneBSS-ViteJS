<div class="main-wrapper">
    <breadcrumb />
    <!--    <breadcrumb :header="header" />-->
    <!-- <div class="breadcrumb-top">
        <div class="main-title"> {{ formTitle}} </div>
        <ul class="breadcrumb">
            <li class="breadcrumb-item"><a href="#"><span class="nc-icon-outline ui-1_home-simple"></span> Trang chủ
                </a></li>
            <li class="breadcrumb-item"><a href="#">Hoàn thiện hồ sơ</a></li>
            <li class="breadcrumb-item active">{{ formTitle }}</li>
        </ul>
    </div> -->
    <div class="list-actions-top">
        <ul class="list">
            <li>
                <a href="#" @click.prevent="btnLayTTMoi_Click">
                    <span class="icon one-file-attach"></span> Lấy TT
                </a>
            </li>
            <li>
                <a href="#" @click.prevent="tsbtnChapNhan_Click">
                    <span class="icon one-edit"></span> Cập nhật
                </a>
            </li>
            <li v-show="tsbtnGiaoViec">
                <a href="#" @click.prevent="tsbtnGiaoViec_Click" :disabled="tsbtnGiaoViec_Enabled"
                    v-bind:class="{'disabled':!tsbtnGiaoViec_Enabled}">
                    <span class="icon one-reload1"></span> Giao việc
                </a>
            </li>
            <li v-show="tsbtnKichHoat">
                <a href="#" @click.prevent="btnKichhoat_Click" :disabled="tsbtnKichHoat_Enabled"
                    v-bind:class="{'disabled':!tsbtnKichHoat_Enabled}">
                    <span class="icon one-reload1"></span> Kích hoạt
                </a>
            </li>
            <li v-show="tsbtnHoanCong">
                <a href="#" @click.prevent="btnHoanCong_Click" :disabled="tsbtnHoanCong_Enabled"
                    v-bind:class="{'disabled':!tsbtnHoanCong_Enabled}">
                    <span class="icon one-reload1"></span> Hoàn công
                </a>
            </li>
            <li v-show="tsbtnGiaoPhieu">
                <a href="#" @click.prevent="tsbtnGiaoPhieu_Click" :disabled="tsbtnGiaoPhieu_Enabled">
                    <span class="icon one-arrow-right-forward"></span> Giao phiếu
                </a>
            </li>
            <li v-show="tsbtnHoanThienHS">
                <a href="#" @click.prevent="tsbtnChuyenDB_Click" :disabled="tsbtnHoanThienHS_Enabled"
                    v-bind:class="{'disabled':!tsbtnHoanThienHS_Enabled}">
                    <span class="icon one-reload1"></span> Hoàn thiện
                </a>
            </li>
            <li v-show="btnInDS">
                <a href="#" @click.prevent="btnInDS_Click">
                    <span class="icon one-print"></span> Danh sách
                </a>
            </li>
            <li class="dropdown" @click.prevent="xuatPhieuShow = !xuatPhieuShow" style="position: static;">
                <a href="#"> <span class="icon one-file-arrow-right1"></span>Xuất phiếu
                    <svg width="16" height="16" class="h-8 w-8 text-blue-500" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="6 9 12 15 18 9" />
                    </svg>
                </a>
                <ul v-show="xuatPhieuShow" class="ui-xuat-phieu">
                    <!-- <li class="xuat-phieu" style="padding: 10px 10px 10px 10px;" v-show="btnPhieuTC">
                        <a href="#" @click.prevent="tsbtnInPhieuTC_Click">
                            <span class="icon one-print"></span> Phiếu thi công
                        </a>
                    </li> -->
                    <li class="xuat-phieu" style="padding: 10px 10px 10px 10px;" v-show="btnBienBanNT">
                        <a href="#" @click.prevent="btnBienBanNT_Click">
                            <span class="icon one-print"></span> In phiếu
                        </a>
                    </li>
                    <!-- <li class="xuat-phieu" style="padding: 10px 10px 10px 10px;"><a href="#"
                            style="color: #007bff; text-decoration: none"> <span
                                class="icon one-file-arrow-right1"></span>Phiếu thi
                            công</a>
                    </li>
                    <li class="xuat-phieu" style="padding: 10px 10px 10px 10px;"><a href="#"
                            style="color: #007bff;text-decoration: none"><span
                                class="icon one-file-arrow-right1"></span>In phiếu</a>
                    </li> -->
                </ul>
            </li>

            <!-- <li v-show="btnPhieuTC">
                <a href="#" @click.prevent="tsbtnInPhieuTC_Click">
                    <span class="icon one-print"></span> Phiếu thi công
                </a>
            </li>
            <li v-show="btnBienBanNT">
                <a href="#" @click.prevent="btnBienBanNT_Click">
                    <span class="icon one-print"></span> In phiếu
                </a>
            </li> -->
            <li v-show="tsbtnDuAn">
                <a href="#" @click.prevent="tsbtnDuAn_Click">
                    <span class="icon one-reload1"></span> Dự án
                </a>
            </li>
            <li v-show="tsbtnChuyenTo">
                <a href="#" @click.prevent="tsbtnChuyenTo_Click">
                    <span class="icon one-change"></span>Chuyển tổ
                </a>
            </li>
            <li>
                <a href="#" @click.prevent="btnXuatExcel_Click">
                    <span class="icon one-xlsx-import"></span>Xuất Excel
                </a>
            </li>
        </ul>
    </div>
    <div class="page-content">
        <div class="box-form">
            <div class="legend-title">Thông tin thuê bao</div>
            <div class="row">
                <div class="col-sm-6 col-12">
                    <div class="info-row">
                        <div class="key">Dịch vụ</div>
                        <div class="value">
                            <Select2 v-model="DichVuVtId" :options="DmDVVT" />
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key">Quy trình</div>
                        <div class="value">
                            <Select2 v-model="QuyTrinhId" :options="DmQuyTrinh" ref="cboQuyTrinh" />
                            <SearchContractModal ref="popupSearchContract" @accept="acceptSearchContract"
                                :dichvu_id="iDichVuVtId" :loai_hd_id="14" :trangthai_hd="ThHdId" />
                        </div>
                    </div>
                    <div class="row" v-if="showPassword">
                        <div class="col-sm-7 col-12">
                            <div class="info-row">
                                <div class="key">Mã GD</div>
                                <div class="value">
                                    <div class="input-more-button">
                                        <button class="btn" @click.prevent="btnLayMaGD_Click">
                                            <span class="-ap icon-more_horiz"></span>
                                        </button>
                                        <input type="text" v-on:keyup.enter="txtMaGD_KeyUp" v-model="txtMaGD"
                                            class="form-control highlight">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-5 col-12">
                            <div class="info-row">
                                <div class="key">Mật khẩu</div>
                                <div class="value">
                                    <input type="text" v-model="txtPassword" class="form-control highlight"
                                        readonly="true">
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="info-row" v-else>
                        <div class="key">Mã GD</div>
                        <div class="value">
                            <div class="input-more-button">

                                <button class="btn" @click.prevent="btnLayMaGD_Click">
                                    <span class="-ap icon-more_horiz"></span>
                                </button>
                                <input type="text" v-on:keyup.enter="txtMaGD_KeyUp" v-model="txtMaGD"
                                    class="form-control highlight bold" maxlength="250">
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-7 col-12">
                            <div class="info-row">
                                <div class="key">Kiểu LĐ</div>
                                <div class="value">
                                    <input type="text" v-model="txtKieuLD" class="form-control" maxlength="250">
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-5 col-12">
                            <div class="info-row">
                                <div class="key">Loại hình</div>
                                <div class="value">
                                    <Select2 v-model="LoaiHinhTBId" :options="DmLoaiHinhTB"
                                        :disabled="!cboLoaiHinhTB_Enabled"
                                        v-bind:class="{'disabled': !cboLoaiHinhTB_Enabled}" />
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-7 col-12">
                            <div class="info-row">
                                <div class="key">Số máy/Acc mới</div>
                                <div class="value">
                                    <input type="text" v-on:keyup.enter="txtma_tb_moi_KeyUp" v-model="txtma_tb_moi" 
                                        class="form-control highlight bold">
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-5 col-12">
                            <div class="info-row">
                                <div class="key">Số máy/Acc cũ</div>
                                <div class="value">
                                    <input type="text" v-model="txtMaTBcu" ref="txtMaTBcu01" readonly="true"
                                        class="form-control highlight bold">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="legend-title mart20">Thông tin hoàn công</div>
                    <div class="row">
                        <div class="col-sm-7 col-12">
                            <div class="info-row">
                                <div class="key">Ngày GV</div>
                                <div class="value w20 padt7">
                                    <div class="check-action">
                                        <input type="checkbox" class="check" v-model="dtpNgayGV_checkbox">
                                        <span class="name"></span>
                                    </div>
                                </div>
                                <div class="value">
                                    <date-picker v-bind:class="{'disabled': !dtpNgayGV_Enabled}"
                                        :disabled="!dtpNgayGV_checkbox" :format="dateFormat" :value-type="dateFormat"
                                        ref="dtpNgayGV" :time-title-format="dateFormat" :type="typeFormat"
                                        :showTimePanel="showTimePanel" v-model="dtpNgayGV.val"
                                        :disabled-date="disabledRange" @close="handleOpenChange" id="txtngayGV">
                                        <template #icon-calendar>
                                            <span class="icon one-calendar"></span>
                                        </template>
                                        <template v-slot:footer>
                                            <button class="mx-btn mx-btn-text" @click="toggleTimePanel">
                                                {{ showTimePanel ? 'Chọn ngày' : 'Chọn giờ' }}
                                            </button>
                                        </template>
                                    </date-picker>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-5 col-12">
                            <div class="info-row">
                                <div class="key">Nhân viên GV</div>
                                <div class="value">
                                    <Select2 v-model="nhanVienGVId" :options="DsNhanVienGV" />
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-7 col-12">
                            <div class="info-row">
                                <div class="key">Ngày HT</div>
                                <div class="value w20 padt7">
                                    <div class="check-action">
                                        <input type="checkbox" class="check" v-model="dtpNgayBG_checkbox">
                                        <span class="name"></span>
                                    </div>
                                </div>
                                <div class="value">
                                    <date-picker v-bind:class="{'disabled': !dtpNgayBG_Enabled}"
                                        :disabled="!dtpNgayBG_checkbox" :format="dateFormat" :value-type="dateFormat"
                                        ref="txtngayHT" :time-title-format="dateFormat" :type="typeFormat"
                                        :showTimePanel="showTimePanel" v-model="dtpNgayBG.val"
                                        :disabled-date="disabledRange" @close="handleOpenChange" id="dtpNgayBG">
                                        <template #icon-calendar>
                                            <span class="icon one-calendar"></span>
                                        </template>
                                        <template v-slot:footer>
                                            <button class="mx-btn mx-btn-text" @click="toggleTimePanel">
                                                {{ showTimePanel ? 'Chọn ngày' : 'Chọn giờ' }}
                                            </button>
                                        </template>
                                    </date-picker>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-5 col-12">
                            <div class="info-row">
                                <div class="key">Vệ tinh</div>
                                <div class="value">
                                    <!-- txtVeTinh -->
                                    <input type="text" v-model="txtTramNE" class="form-control bold">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-7 col-12">
                            <div class="info-row">
                                <div class="key">Số Ne</div>
                                <div class="value w20 nowrap">
                                    <div class="list-checks mart7">
                                        <div class="item">
                                            <div class="check-action">
                                                <input :disabled="!btnChonNe_TuDong_Enabled" type="checkbox"
                                                    v-model="SoNE_checkboxAuto" class="check"
                                                    @click="btnChonNe_TuDong_Click">
                                                <span class="name">T. động</span>
                                            </div>
                                        </div>
                                        <div class="item">
                                            <div class="check-action">
                                                <input :disabled="!btnChonNe_Enabled" type="checkbox"
                                                    v-model="SoNE_checkboxManual" class="check"
                                                    @click="btnChonNe_Click">
                                                <span class="name">N. công</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="value">
                                    <input type="text" v-model="txtSoNE" readonly="true"
                                        class="form-control highlight bold">
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-5 col-12">
                            <div class="info-row">
                                <div class="key">Số Ne cũ</div>
                                <div class="value">
                                    <input type="text" v-model="txtSoNECu" readonly="true" class="form-control bold">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-7 col-12">
                            <div class="info-row">
                                <div class="key">Host lắp đặt</div>

                                <div class="value">
                                    <input type="text" v-model="txtHostLD" readonly="true" class="form-control bold">
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-5 col-12">
                            <div class="info-row">
                                <div class="key">Host vật lý</div>
                                <div class="value">
                                    <input type="text" v-model="txtHostVatLy" readonly="true" class="form-control bold">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key">Nội dung giao</div>

                        <div class="value">
                            <input type="text" v-model="txtNoiDungGiao" class="form-control bold" readonly="true">
                        </div>
                    </div>
                </div>
                <div class="col-sm-6 col-12">
                    <div class="info-row">
                        <div class="key">Tên thuê bao</div>

                        <div class="value">
                            <input type="text" v-model="txtTenThueBao" class="form-control bold" readonly="true">
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key">Địa chỉ thuê bao</div>

                        <div class="value">
                            <input type="text" v-model="txtDiaChiTB" class="form-control bold" readonly="true">
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key">Ghi chú</div>

                        <div class="value">
                            <input type="text" readonly="true" v-model="txtGhiChu" class="disabled form-control bold">
                        </div>
                    </div>
                    <div class="legend-title mart20">Danh sách nhân viên thực hiện</div>
                    <DataGrid v-bind:columns="DsNhanVienThucHien.headers" :enabledSelectFirstRow="true"
                        v-bind:dataSource="DsNhanVienThucHien.data" :showColumnCheckbox="false"
                        :enable-paging-server="false" :allowPaging="true" :showFilter="true"
                        ref="gridDsNhanVienThucHien">
                    </DataGrid>

                </div>
            </div>
        </div>
        <div class="box-form padt5">
            <div class="legend-title">
                <div class="pull-left mart7">Danh sách thuê bao số máy/account</div>
                <div class="pull-right">
                    <div class="list-checks normal">
                        <div class="item vcenter">
                            <div class="check-action">
                                <input type="radio" class="check" v-model="LoaiPhieuId" value="0">
                                <span class="name">Phiếu mới</span>
                            </div>
                        </div>
                        <div class="item vcenter">
                            <div class="check-action">
                                <input type="radio" class="check" v-model="LoaiPhieuId" value="1">
                                <span class="name">Phiếu trả lại</span>
                            </div>
                        </div>
                        <div class="item vcenter">
                            <div class="info-row">
                                <div class="key w90">
                                    <div class="check-action">
                                        <input type="checkbox" class="check" v-model="fCheckSearch">
                                        <span class="name">Tìm kiếm</span>
                                    </div>
                                </div>
                                <div class="value w100">
                                    <Select2 :disabled="!fCheckSearch" v-model="cboLoaiDVTK" :options="DmDvTk" />
                                </div>
                            </div>
                        </div>
                        <div class="item vcenter">
                            <div class="info-row">
                                <div class="key w60">
                                    Đơn vị
                                </div>
                                <div class="value" style="width: 200px;">
                                    <Select2 :disabled="!fCheckSearch" v-model="cboDViTimKiem" :options="DmDonVi" />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="clearfix"></div>
            </div>
            <DataGrid v-bind:columns="DsThueBao.headers" :enabledSelectFirstRow="false"
                 v-bind:dataSource="DsThueBao.data" :showColumnCheckbox="true"
                :enable-paging-server="false" :allowPaging="true" :showFilter="true" ref="gridDsThueBao"
                @rowClicked="select_selectThueBao" @selectedItemsChanged="grid_selectedItemsChanged"
                :selectionSettings="{ checkboxMode: 'ResetOnRowClick' }"
                @dataBound="gridThueBao_DataBound" @rowDataBound="gridThueBao_RowDataBound">
            </DataGrid>
        </div>
    </div>
    <ejs-dialog :enableResize='true' :allowDragging='true' :visible='false' :animationSettings='animationSettings'
        ref="dialogObjChonNe" :position="position" :header='"Chọn số Ne"' showCloseIcon=true width='80%'
        target='#app .main-wrapper' :close="closeDialogChonNe" :open="openDialogChonNe">
        <div class="popup-body">
            <ChonNe :optionsVetinh="optionsVetinh" @change="ChangeNe"></ChonNe>
        </div>
    </ejs-dialog>
    <ejs-dialog :enableResize='true' :allowDragging='true' :visible='false' :animationSettings='animationSettings'
        ref="dialogObjTraCuuHD" :position="position" :header='"Tra cứu hợp đồng"' showCloseIcon=true width='80%'
        target='#app .main-wrapper'>
        <div class="popup-body">
            Tra cứu mã hợp đồng !
        </div>
    </ejs-dialog>
    <ChuyenTo ref="popupChuyenTo"></ChuyenTo>
    <ejs-dialog :enableResize='true' :allowDragging='true' :visible='false' :animationSettings='animationSettings'
        ref="dialogObjGiaoPhieuNV" :position="position" :header='"Giao phiếu nhân viên"' showCloseIcon=true width='90%'
        target='#app .main-wrapper'>
        <div class="popup-body">
            <GiaoPhieuNhanVien :phieu_id="PhieuId" :nguoigv_id="giaoPhieuNV.nguoiGiao" :ngaygiao="giaoPhieuNV.ngayGiao">
            </GiaoPhieuNhanVien>
        </div>
    </ejs-dialog>
    <ejs-dialog :enableResize='true' :allowDragging='true' :visible='false' :animationSettings='animationSettings'
        ref="refdialogObjDuAn" :position="position" :header='"Dự án"' showCloseIcon=true width='90%'
        target='#app .main-wrapper'>
        <div class="popup-body">

        </div>
    </ejs-dialog>
    <ejs-dialog
      :isModal="true"
      :enableResize="true"
      :resizeHandles="['All']"
      :visible="false"
      ref="GiaoPhieuView"
      :header='"Giao phiếu điều hành thi công"'
      showCloseIcon="true"
      target=".main-wrapper"
      width="90%"
      allowDragging="true"
      :animationSettings="animationSettings"
      @close="GiaoPhieuView_OnClose"
    >
      <div>
        <GiaoPhieuView v-if="giaoPhieuViewDialog.isVisiable" type="modal"  v-bind="giaoPhieuViewDialog.input" />
      </div>
    </ejs-dialog>
    <InBienBan ref="popupInBB" :params="modelIn" />
    <ExportDataModal ref="exportDataModal" :data="DsThueBao.data"></ExportDataModal>

</div>
