<ejs-dialog :header="'Đăng ký gói đa dịch vụ cho các thuê bao lắp mới'" showCloseIcon="true" width="100%" height="100%"
    :target="'.main-wrapper'" header-class="popup-header" :visible="false" ref="frmDangKyGoiDaDVLM" :position="{ X: 'center', Y: 'top' }"
    id="frmDangKyGoiDaDVLM">
    <div class="popup-content">
        <div class="list-actions-top">
            <ul class="list">
                <li>
                    <a title="Lấy thông tin mới" ref="tsbtnNhapMoi" @click="tsbtnNhapMoi_Click">
                        <span class="icon one-file-attach"></span> Nhập mới
                    </a>
                </li>
                <li>
                    <a ref="tsbtnHuyBo" @click="tsbtnHuyBo_Click">
                        <span class="icon one-reload1"></span> Hủy
                    </a>
                </li>
                <li>
                    <a ref="tsbtnThemTB" @click="tsbtnThemTB_Click">
                        <span class="icon one-reload1"></span> Ghi lại
                    </a>
                </li>
                <li>
                    <a ref="tsbtnXoaTB" @click="tsbtnXoaTB_Click">
                        <span class="icon one-reload1"></span> Xóa TB
                    </a>
                </li>
                <li>
                    <a ref="btnThemTBNgoaiKH" class="disabled" @click="btnThemTBNgoaiKH_Click">
                        <span class="icon one-reload1"></span> Thêm TB
                    </a>
                </li>
                <li>
                    <a href="#" @click.prevent="btnTraTruocV2_click" title="Đặt cọc trả trước">
                        <span class="dropdown-icon one-card"></span> Đặt cọc
                    </a>
                </li>                
            </ul>
        </div>
        <div class="popup-body">
            <div class="grid-stack-box">
                <div class="box-col" id="boxLeft" style="width: calc(50% - 8px);">
                    <div class="box-form">
                        <div class="legend-title">
                            <div class="pull-left mart7">
                                Thông tin gói
                            </div>
                            <div class="clearfix"></div>
                        </div>
                        <div class="row">
                            <div class="col-sm-6 col-12">
                                <div class="info-row ">
                                    <div class="key w105 nowrap">Mã giao dịch</div>
                                    <div class="value">
                                        <div class="input-more-button">
                                            <button ref="btnLayMaGD" @click="btnLayMaGD_Click" class="btn">
                                                <span class="-ap icon-more_horiz"></span>
                                            </button>
                                            <input ref="txtMaGD" @keyup.enter="txtMaGD_KeyPress" type="text"
                                                class="form-control">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6 col-12"></div>
                            <div class="col-sm-6 col-12">
                                <div class="info-row ">
                                    <div class="key w105 nowrap">Ngày yêu cầu</div>
                                    <div class="value">
                                        <VueDateExt ref="dtpNgayYeuCau" :disable="true" />
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6 col-12">
                                <div class="info-row ">
                                    <div class="key w105 nowrap">Kiểu yêu cầu</div>
                                    <div class="value">
                                        <Select2Ext ref="cboKieuLD" />
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-12 col-12">
                                <div class="info-row ">
                                    <div class="key w105 nowrap">Tên gói</div>
                                    <div class="value">
                                        <div class="input-more-button">
                                            <button ref="btnTenGoi" @click="btnTenGoi_Click" class="btn">
                                                <span class="-ap icon-more_horiz"></span>
                                            </button>
                                            <Select2Ext @change="cboTenGoi_DV_EditValueChanged" ref="cboTenGoi_DV" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6 col-12">
                                <div class="info-row ">
                                    <div class="key w105 nowrap">Hiệu lực</div>
                                    <div class="value">
                                        <Select2Ext ref="cboHieuLuc" />
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6 col-12">
                                <div class="info-row ">
                                    <div class="key w105 nowrap">Số tháng</div>
                                    <div class="value">
                                        <input @keyup.enter="txtMaTB_KeyPress" ref="txtSoThang" type="text"
                                            class="form-control">
                                    </div>
                                </div>
                            </div>

                            <div class="col-sm-12 col-12">
                                <div class="info-row ">
                                    <div class="key w105 nowrap">Mô tả</div>
                                    <div class="value">
                                        <textarea ref="txtMoTa" type="text" class="form-control" style="height: 185px"></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="box-col padl5" id="boxRight" style="width: calc(50% - 8px);">
                    <div class="box-form">
                        <div class="legend-title">
                            <div class="pull-left mart7">
                                Thông tin khách hàng
                            </div>
                            <div class="clearfix"></div>
                        </div>
                        <div class="row">
                            <div class="col-sm-6 col-12">
                                <div class="info-row ">
                                    <div class="key w105 nowrap">Mã khách hàng</div>
                                    <div class="value">
                                        <input ref="txtMaKH" type="text" class="form-control">
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6 col-12"></div>
                            <div class="col-sm-12 col-12">
                                <div class="info-row ">
                                    <div class="key w105 nowrap">Tên khách hàng</div>
                                    <div class="value">
                                        <input ref="txtTenKH" type="text" class="form-control">
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-12 col-12">
                                <div class="info-row ">
                                    <div class="key w105 nowrap">Địa chỉ KH</div>
                                    <div class="value">
                                        <input ref="txtDiaChiKH" type="text" class="form-control">
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-12 col-12">
                                <div class="info-row ">
                                    <div class="key w105 nowrap">Ghi chú</div>
                                    <div class="value">
                                        <input ref="txtGhiChu" type="text" class="form-control">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="box-form">
                        <div class="legend-title">
                            <div class="pull-left mart7">
                                Bổ sung thuê bao thuộc khách hàng vào gói
                            </div>
                            <div class="clearfix"></div>
                        </div>
                        <div class="row">
                            <div class="col-sm-5 col-12">
                                <div class="info-row ">
                                    <div class="key w105 nowrap">Số máy</div>
                                    <div class="value">
                                        <div class="input-more-button">
                                            <button ref="btnTKMaTB" @click="btnTKMaTB_Click" class="btn">
                                                <span class="-ap icon-more_horiz"></span>
                                            </button>
                                            <input ref="txtMaTB" @keyup.enter="txtMaTB_KeyPress_1" type="text"
                                                class="form-control highlight">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-5 col-12">
                                <div class="info-row ">
                                    <div class="key w105 nowrap">Dịch vụ</div>
                                    <div class="value">
                                        <Select2Ext ref="cboDichVuVT" />
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-2 col-12">
                                <div class="info-row ">
                                    <div class="value">
                                        <input :disabled="readOnlySomay" ref="chkChuNhom" type="checkbox" class="check">
                                    </div>
                                    <div class="key w30 nowrap">Chủ nhóm</div>
                                </div>
                            </div>
                            <div class="col-sm-12 col-12">
                                <div class="info-row ">
                                    <div class="key w105 nowrap">Tên TB</div>
                                    <div class="value">
                                        <input :disabled="readOnlySomay" ref="txtTenTB" type="text" class="form-control">
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-12 col-12">
                                <div class="info-row ">
                                    <div class="key w105 nowrap">Địa chỉ TB</div>
                                    <div class="value">
                                        <input :disabled="readOnlySomay" ref="txtDiaChiTB" type="text" class="form-control">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="grid-stack-box">
            <div class="box-col" id="boxBottomLeft" style="width: calc(50% - 8px);">
                <div class="box-form">
                    <div class="legend-title">
                        <div class="pull-left mart7">
                            Danh sách các thuê bao thuộc khách hàng
                        </div>
                        <div class="clearfix"></div>
                    </div>
                    <DataGridCustom showColumnCheckbox ref="dgrListKH" :columns="[
                                {
                                    fieldName: 'CHKNHOM',
                                    headerText: 'Chủ nhóm',
                                    allowFiltering: true,
                                    allowSorting: false,
                                    width: 140,
                                    textAlign: 'center',
                                    template: getColTemplateGhiChu(self)
                                },
                                {
                                    fieldName: 'MA_TB',
                                    headerText: 'Số máy/Acc',
                                    allowFiltering: true,
                                    allowSorting: false,
                                    width: 140,
                                    textAlign: 'left'
                                },
                                {
                                    fieldName: 'THUONGHIEU',
                                    headerText: 'Tốc độ/Loại hình',
                                    allowFiltering: true,
                                    allowSorting: false,
                                    width: 140,
                                    textAlign: 'left'
                                },
                                {
                                    fieldName: 'KIEU_TB',
                                    headerText: 'Trạng thái',
                                    allowFiltering: true,
                                    allowSorting: false,
                                    width: 140,
                                    textAlign: 'left'
                                },
                            ]" />
                </div>
            </div>
            <div class="box-col padl5" id="boxBottomRight" style="width: calc(50% - 8px);">
                <div class="box-form">
                    <div class="legend-title">
                        <div class="pull-left mart7">
                            Danh sách các thuê bao thuộc gói
                        </div>
                        <div class="clearfix"></div>
                    </div>
                    <DataGridCustom checkboxMode="Default" showColumnCheckbox ref="dgrList" @rowSelected="dgrList_SelectionChanged" :columns="[
                                {
                                    fieldName: 'NHOMTB_ID',
                                    headerText: 'Nhóm',
                                    allowFiltering: true,
                                    allowSorting: false,
                                    width: 140,
                                    textAlign: 'left'
                                },
                                {
                                    fieldName: 'TEN_GOI',
                                    headerText: 'Tên gói',
                                    allowFiltering: true,
                                    allowSorting: false,
                                    width: 140,
                                    textAlign: 'left'
                                },
                                {
                                    fieldName: 'TEN_CHUNHOM',
                                    headerText: 'Chủ nhóm',
                                    allowFiltering: true,
                                    allowSorting: false,
                                    width: 140,
                                    textAlign: 'left'
                                },
                                {
                                    fieldName: 'MA_TB',
                                    headerText: 'Số máy/Acc',
                                    allowFiltering: true,
                                    allowSorting: false,
                                    width: 140,
                                    textAlign: 'left'
                                },
                                {
                                    fieldName: 'THUONGHIEU',
                                    headerText: 'Tốc độ/Loại hình',
                                    allowFiltering: true,
                                    allowSorting: false,
                                    width: 140,
                                    textAlign: 'left'
                                }
                            ]" />
                </div>
            </div>
        </div>
    </div>
    <ejs-dialog :enableResize='true' :visible="false" ref="popupFrmTraCuuHopDong" :header='"Tra cứu hợp đồng, phụ lục"'
        showCloseIcon=true width="80%" :target="'#app .main-wrapper'" height="800">
        <SearchContractModal ref="searchContractModal" :donviId="Number($root.token.getDonViID())"
            :nhanvienId="Number($root.token.getNhanVienID())" :loaihd_id="modalSearch.loaihd_id"
            :ngay_yc="modalSearch.ngay_yc" :kieu="1" :tthd_id="modalSearch.tthd_id" @accept="acceptSearchContract" />
    </ejs-dialog>
    <b-modal id="popupComponents" size="huge" hide-footer hide-header hide-header-close body-class="modal-body p-0">
        <component :is="popupComponent" ref="generalPopup" :dulieu="popupComponentData" v-bind="popupComponentAttr"
            isPopup="true" v-on="popupComponentEvts"></component>
    </b-modal>
    <QLCongVanModal ref="ql_congvan" :goi_id="goi_id" />
    </div>
</ejs-dialog>