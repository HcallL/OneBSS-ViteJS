<div :class="{'popup-box':isPopup}">
  <breadcrumb :header="header" v-if="!isPopup" />
  
  <div class="popup-header" v-if="isPopup">
    <div class="title"><span class="icon one-notepad"></span>Tra cứu danh bạ</div>
    <div class="close -ap icon-close" data-dismiss="modal" @click.prevent="terminateForm">
    </div>
  </div>
  <div class="list-actions-top">
      <ul class="list">
          <li>
              <a href="#" @click.prevent="SearchClient">
                  <span class="icon one-search"></span>Tìm kiếm
              </a>
          </li>
          <li v-if="isPopup">
              <a href="#" @click.prevent="closeForm">
                  <span class="icon nc-icon-glyph ui-1_check-circle-08"></span>Chấp nhận
              </a>
          </li>
          <li>
              <a href="#" @click.prevent="tsbtnXuatExcel_Click" :class="{disabled:!gridbox.khachhang.list || this.gridbox.khachhang.list.length<=0}">
                  <span class="icon one-download"></span>Xuất file
              </a>
          </li>
          <li>
              <a href="#" @click.prevent="tsbtnNgayTruyThu_Click" :class="{disabled: !gridbox.thuebao.value.thuebao_id || gridbox.thuebao.value.thuebao_id<=0}">
                  <span class="icon -ap  icon-event_note"></span>Ngày truy thu
              </a>
          </li>
          <li>
              <a href="#" @click.prevent="terminateForm" v-if="isPopup">
                  <span class="icon ui-1_circle-remove nc-icon-glyph"></span> Thoát
              </a>
          </li>
      </ul>
  </div>
  <div class="page-content">
      <div class="box-form">
          <div class="legend-title">
              Thông tin tra cứu
          </div>
          <div class="row">
              <div class="col-sm-6 col-12">
                  <div class="info-row">
                      <div class="key w90">Tra cứu theo</div>
                      <div class="value">
                          <div class="row">
                              <div class="col-sm-6 col-12">
                                  <SelectExt class="select-custom" v-model="listbox.dk_tracuu.dk1.value" :dataSource="listbox.dk_tracuu.list" dataTextField="NAME" dataValueField="ID" :disabled="!listbox.dk_tracuu.dk1.isEnabled"></SelectExt>
                              </div>
                              <div class="col-sm-6 col-12">
                                  <input type="text" class="form-control" v-model="listbox.dk_tracuu.dk1.value_text" keypress.enter="SearchClient">
                              </div>
                          </div>
                      </div>
                  </div>
              </div>
              <div class="col-sm-3 col-12">
                  <div class="info-row">
                      <div class="key w80">
                          <div class="check-action">
                              <input type="checkbox" class="check" v-model="listbox.dichvu_vienthong.isEnabled">
                              <span class="name">Dịch vụ</span>
                          </div>
                      </div>
                      <div class="value">
                          <SelectExt class="select-custom" v-model="listbox.dichvu_vienthong.value" :dataSource="listbox.dichvu_vienthong.list" dataTextField="NAME" dataValueField="ID" :disabled="!listbox.dichvu_vienthong.isEnabled"></SelectExt>
                      </div>
                  </div>
              </div>
              <div class="col-sm-3 col-12">
                  <div class="info-row">
                      <div class="key w80">
                          <div class="check-action">
                              <input type="checkbox" class="check" v-model="listbox.donvi_quanly.isEnabled">
                              <span class="name">Đơn vị</span>
                          </div>
                      </div>
                      <div class="value">
                          <SelectExt class="select-custom" v-model="listbox.donvi_quanly.value" :dataSource="listbox.donvi_quanly.list" dataTextField="NAME" dataValueField="ID" :disabled="!listbox.donvi_quanly.isEnabled"></SelectExt>
                      </div>
                  </div>
              </div>
          </div>
          <div class="row">
              <div class="col-sm-6 col-12">
                  <div class="info-row">
                      <div class="key w90">
                          <div class="check-action">
                              <input type="checkbox" class="check" v-model="listbox.dk_tracuu.dk2.isEnabled">
                              <span class="name">Tra theo</span>
                          </div>
                      </div>
                      <div class="value">
                          <div class="row">
                              <div class="col-sm-6 col-12">
                                  <SelectExt class="select-custom" v-model="listbox.dk_tracuu.dk2.value" :dataSource="listbox.dk_tracuu.list" dataTextField="NAME" dataValueField="ID" :disabled="!listbox.dk_tracuu.dk2.isEnabled"></SelectExt>
                              </div>
                              <div class="col-sm-6 col-12">
                                  <input type="text" class="form-control" :disabled="!listbox.dk_tracuu.dk2.isEnabled" v-model="listbox.dk_tracuu.dk2.value_text" keypress.enter="SearchClient">
                              </div>
                          </div>
                      </div>
                  </div>
              </div>
              <div class="col-sm-6 col-12">
                  <div class="info-row">
                      <div class="key w80">
                          Mã KH
                      </div>
                      <div class="value">
                          <input type="text" style="font-weight: bolder" class="form-control" v-model="maKH" keypress.enter="SearchClient">
                      </div>
                  </div>
              </div>
          </div>
          <div class="row">
              <div class="col-sm-6 col-12">
                  <div class="info-row">
                      <div class="key w90">
                          <div class="check-action">
                              <input type="checkbox" class="check" v-model="listbox.dk_tracuu.dk3.isEnabled">
                              <span class="name">Tra theo</span>
                          </div>
                      </div>
                      <div class="value">
                          <div class="row">
                              <div class="col-sm-6 col-12">
                                  <SelectExt class="select-custom" v-model="listbox.dk_tracuu.dk3.value" :dataSource="listbox.dk_tracuu.list" dataTextField="NAME" dataValueField="ID" :disabled="!listbox.dk_tracuu.dk3.isEnabled"></SelectExt>
                              </div>
                              <div class="col-sm-6 col-12">
                                  <input type="text" class="form-control" :disabled="!listbox.dk_tracuu.dk3.isEnabled" v-model="listbox.dk_tracuu.dk3.value_text" keypress.enter="SearchClient">
                              </div>
                          </div>
                      </div>
                  </div>
              </div>
              <div class="col-sm-3 col-12">
                  <div class="info-row">
                      <div class="key w80">
                          Số máy/Acc
                      </div>
                      <div class="value">
                          <input type="text" class="form-control" v-model="ma_tb">
                      </div>
                  </div>
              </div>
              <div class="col-sm-3 col-12">
                  <div class="info-row">
                      <div class="key w80">
                          Số ảo
                      </div>
                      <div class="value">
                          <input type="text" style="font-weight: bolder" class="form-control" v-model="so_ao">
                      </div>
                  </div>
              </div>
          </div>
  
      </div>
      <div class="box-form">
          <div class="legend-title">
              Lọc theo
          </div>
          <div class="row">
              <div class="col-sm-6 col-12">
                  <div class="info-row">
                      <div class="key w90">
                          <div class="check-action">
                              <input type="checkbox" class="check" v-model="filterbox.dichvu_vienthong.isEnabled" @change="filterThueBao">
                              <span class="name">Dịch vụ</span>
                          </div>
                      </div>
                      <div class="value">
                          <SelectExt class="select-custom" v-model="filterbox.dichvu_vienthong.value" :dataSource="filterbox.dichvu_vienthong.list" dataTextField="NAME" dataValueField="ID" :disabled="!filterbox.dichvu_vienthong.isEnabled" @change="filterServiceChanged"></SelectExt>
                      </div>
                  </div>
              </div>
              <div class="col-sm-6 col-12">
                  <div class="info-row">
                      <div class="key w90">
                          <div class="check-action">
                              <input type="checkbox" class="check" v-model="filterbox.loaihinh_thuebao.isEnabled" @change="filterThueBao">
                              <span class="name">Loại hình</span>
                          </div>
                      </div>
                      <div class="value">
                          <SelectExt class="select-custom" v-model="filterbox.loaihinh_thuebao.value" :dataSource="filterbox.loaihinh_thuebao.list" dataTextField="NAME" dataValueField="ID" :disabled="!filterbox.loaihinh_thuebao.isEnabled" @change="filterThueBao"></SelectExt>
                      </div>
                  </div>
              </div>
          </div>
      </div>
      <div class="box-form">
          <div class="legend-title">Danh sách khách hàng</div>
          <DataGrid ref="tblKhachHang" v-bind:columns="gridbox.khachhang.cols"
              v-bind:dataSource="gridbox.khachhang.list" :showFilter="true" @selectedRowChanged="grdKhachHangChanged" @recordDoubleClick="grdKhachHangDoubleClick" :allowPaging="true" :enablePagingServer="false" :totalRecords="gridbox.khachhang.list.length">
          </DataGrid>
          <!-- <gridview id="table1" :datalist="gridbox.khachhang.list" :headers="gridbox.khachhang.header" v-bind:flcol="false"
          @recordChange="grdKhachHangChanged" v-bind:checkheader="false" lastcoltemplate="0"></gridview> -->
      </div>
      <div class="box-form">
          <div class="legend-title">Danh sách thanh toán</div>
          <DataGrid ref="tblThanhToan" v-bind:columns="gridbox.thanhtoan.cols"
              v-bind:dataSource="gridbox.thanhtoan.list" :showFilter="true" @selectedRowChanged="grdThanhToanChanged" :allowPaging="true" :enablePagingServer="false" :totalRecords="gridbox.thanhtoan.list.length">
          </DataGrid>
          <!-- <gridview id="table2" :datalist="gridbox.thanhtoan.list" :headers="gridbox.thanhtoan.header" v-bind:flcol="false" v-bind:checkheader="false" lastcoltemplate="0" @recordChange="grdThanhToanChanged"></gridview> -->
      </div>
      <div class="box-form">
          <div class="legend-title">Danh sách thuê bao</div>
          <DataGrid ref="tblThueBao" v-bind:columns="gridbox.thuebao.cols"
              v-bind:dataSource="gridbox.thuebao.list" :showFilter="true" @selectedRowChanged="grdThueBaoChanged" :allowPaging="true" :enablePagingServer="false" :totalRecords="gridbox.thuebao.list.length">
          </DataGrid>
          <!-- <gridview id="table3" :datalist="gridbox.thuebao.list" :headers="gridbox.thuebao.header" v-bind:flcol="false" v-bind:checkheader="false" lastcoltemplate="0" @recordChange="grdThueBaoChanged"></gridview> -->
      </div>
  </div>
  <b-modal id="popupSAComponents" size="xl"
  hide-footer
  hide-header
  hide-header-close
  body-class="modal-body p-0">
      <component :is="popupComponent" ref="generalPopup" :dulieu="popupComponentData" v-bind="popupComponentAttr" isPopup="true" v-on="popupComponentEvts"></component> <!--v-dynamic-events="popupComponentEvents"-->
  </b-modal>
  <ExportDataModal ref="exportDataModal" :data="gridbox.khachhang.list"></ExportDataModal>
  </div>
  