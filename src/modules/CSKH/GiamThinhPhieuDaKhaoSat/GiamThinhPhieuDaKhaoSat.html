<div>

    <!-- <breadcrumb :header="header" /> -->
    <div class="list-actions-top">
        <ul class="list">
            <li>
                <a href="javascript: void(0)" @click="layPhieu()">
                    <span class="icon one-reload"></span>Lấy phiếu
                </a>
            </li>

            <li>
                <a href="javascript: void(0)" @click.prevent="openSuaKSPopup()">
                    <span class="icon nc-icon-glyph ui-1_edit-76"></span>Sửa khảo sát
                </a>
            </li>
            <li>
                <a href="javascript: void(0)" v-b-modal.popup-lichSuSuaPhieu>
                    <span class="icon  one-file-history1"></span> Lịch sử sửa phiếu
                </a>
                <LichSuSuaPhieuKhaoSat :vbtlId="vbtlIdSelected" />
            </li>
            <li>
                <a href="javascript: void(0)" v-b-modal.guiSMSChoKhachHang>
                    <span class="icon  one-email"></span>SMS
                </a>
            </li>
        </ul>
    </div>
    <div class="page-content">
        <div class="box-form">
            <div class="legend-title">Thông tin tìm kiếm</div>
            <div class="row">
                <div class="col-sm-2 col-12">
                    <div class="info-row">
                        <div class="key w60">Từ ngày</div>
                        <div class="value">
                            <ejs-datepicker v-model="fromDate" :value="today" :max="today" :format="'dd/MM/y'">
                            </ejs-datepicker>
                            <!-- <div class="input-icon-right">
                                <flat-pickr v-model="fromDate" class="form-control" :config="dateConfig"
                                    placeholder="Chọn từ ngày" />
                                <span class="icon one-calendar"></span>
                            </div> -->
                        </div>
                    </div>
                </div>
                <div class="col-sm-2 col-12">
                    <div class="info-row">
                        <div class="key w100">Đến ngày</div>
                        <div class="value">
                            <ejs-datepicker v-model="toDate" :value="today" :max="today" :format="'dd/MM/y'">
                            </ejs-datepicker>
                            <!-- <div class="input-icon-right">
                                <flat-pickr v-model="toDate" class="form-control" :config="dateConfig"
                                    placeholder="Chọn đến ngày" />
                                <span class="icon one-calendar"></span>
                            </div> -->
                        </div>
                    </div>
                </div>
                <div class="col-sm-2 col-12">
                    <div class="info-row">
                        <div class="key w100">Loại phiếu</div>
                        <div class="value">
                            <div class="select-custom">
                                <appSelect2 name="loaiPhieuKSOpt" :options="pDsLoaiPhieuKhaoSat" v-model="dsLoaiPhieuKhaoSatSelected" class="form-control">
                                </appSelect2>
                            </div>
                            <!-- <div class="select-custom">
                                <b-form-select v-model="dsLoaiPhieuKhaoSatSelected" class="form-control"
                                    :options="getdsLoaiPhieuKhaoSatGetter">
                                </b-form-select>
                            </div> -->
                        </div>
                    </div>
                </div>
                <div class="col-sm-6 col-12">
                    <div class="info-row">
                        <div class="key w60">Loại KH</div>
                        <div class="value">
                            <div class="select-custom">
                                <appSelect2 name="loaiKHOpt" :options="pDsLoaiKhachHang" v-model="dsPhanLoaiKhachHangSelected" class="form-control">
                                </appSelect2>
                            </div>
                            <!-- <div class="select-custom">
                                <b-form-select v-model="dsPhanLoaiKhachHangSelected" class="form-control"
                                    :options="getdsPhanLoaiKhachHangGetter">
                                </b-form-select>
                            </div> -->
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">

                <div class="col-sm-2 col-12">
                    <div class="info-row">
                        <div class="key w60">Đơn vị</div>
                        <div class="value">
                            <div class="select-custom">
                                <appSelect2 name="donViOpt" :options="pDsDonVi" v-model="dsDonViTrungTamVienThongSelected" class="form-control">
                                </appSelect2>
                            </div>
                            <!-- <div class="select-custom">
                                <b-form-select v-model="dsDonViTrungTamVienThongSelected" class="form-control"
                                    :options="getdsDonViTrungTamVienThongGetter">
                                </b-form-select>
                            </div> -->
                        </div>
                    </div>
                </div>
                <div class="col-sm-2 col-12">
                    <div class="info-row">
                        <div class="key w100">Điện thoại viên</div>
                        <div class="value">
                            <div class="select-custom">
                                <appComboboxGrid ref="dsDienThoaiVien"
                                    v-bind:columns="[
                                        {fieldName: 'MA_NV', headerText: 'Mã NV', allowFiltering: true},
                                        {fieldName: 'TEN_NV', headerText: 'Tên nhân viên', allowFiltering: true},
                                    ]"
                                    v-bind:dataSource="pDsDienThoaiVien" textField="TEN_NV" valueField="NHANVIEN_ID"
                                    @selectedChanged="onDsDTVChanged" :enabledSelectFirstRow="false" placeholder="">
                                </appComboboxGrid>
                            </div>
                            <!-- <div class="select-custom">
                                <input @click="toggleDTVPopup" class="form-control" :value="tenDTV" />
                            </div>
                            <div id="list-cart">
                                <div style="position:absolute;
                                 background-color: #FFF;
                                 width:500px;
                                 height:300px;
                                 left:0px;
                                 top:40px;
                                 border-radius: 5px;
                                 z-index:500" v-bind:class="[visible ? 'show' : 'hide', 'shadow-lg']">
                                    <TableWithSearch :fields="fieldsDienThoaiVien"
                                        :itemsAssign="getdsDienThoaiVienGetter" ref="dsDienThoaiVien"
                                        :onRowSelectedFunc="onDTVSelected" :showPagination="false"
                                        :showHeader="false" />
                                </div>
                            </div> -->
                        </div>
                    </div>
                </div>
                <div class="col-sm-8 col-12">
                    <div class="info-row">
                        <div class="key w100">Loại kết quả</div>
                        <div class="value">
                            <div class="select-custom">
                                <appSelect2 name="loaiKetQuaKSOpt" :options="pDsLoaiKetQua" v-model="dsLoaiKQGiamThinhSelected" class="form-control">
                                </appSelect2>
                            </div>
                            <!-- <div class="select-custom">
                                <b-form-select v-model="dsLoaiKQGiamThinhSelected" class="form-control"
                                    :options="getdsLoaiKQGiamThinhGetter">
                                </b-form-select>
                            </div> -->
                        </div>
                    </div>
                </div>
            </div>
            <div class="legend-title mart10">Danh sách thuê bao</div>
            <!-- <TableWithSearch :fields="fields" :getDataFunc="fetchData" ref="dsThueBao" :showHeader="false"
                :onRowSelectedFunc="onRowSelected" /> -->
            <DataGrid :columns="tableColumns.dsThueBao" :dataSource="dsThueBao" :showColumnCheckbox="false"
                :showFilter="true" dataKeyField="PHIEU_ID" ref="gridThueBao"
                @selectedRowChanged="gridThueBao_selectedRowChanged" :allowPaging="true" :enablePagingServer="false"></DataGrid>


            <div class="legend-title mart20">Nội dung khảo sát</div>
            <div class="DataGrid2ontent">
                <DataGrid :columns="tableColumns.dsNoiDungKhaoSat" :dataSource="dsNoiDungKS" :showColumnCheckbox="false"
                    :showFilter="true" dataKeyField="STT" ref="gridNoiDungKS"
                    @selectedRowChanged="gridNoiDungKS_selectedRowChanged" :allowPaging="true" :enablePagingServer="false"></DataGrid>
                <!-- <TableWithSearch :fields="fieldsNoiDungKhaoSat" :getDataFunc="fetchChiTietTraLoiKhaoSat"
                    ref="dsNoiDungKhaoSat" :showHeader="false" /> -->
            </div>
        </div>
    </div>
    <!-- <b-modal id="lichSuSuaPhieuKhaoSat" title="LỊCH SỬ SỬA PHIẾU KHẢO SÁT" size="xl" hide-footer>
        <LichSuSuaPhieuKhaoSat :vbtlId="vbtlIdSelected" />
    </b-modal> -->
    <b-modal id="guiSMSChoKhachHang" title="Gửi SMS cho Khách Hàng" size="xl" hide-footer>
        <GuiSMSChoKhachHang :vbtlId="vbtlIdSelected" :vHdkhId="vHdkhIdSelected" :vBaoHongId="vBaoHongIdSelected"
            :vSoDt="vSoDtSelected" />
    </b-modal>

    <!-- <frmKhaoSatKH_HDTB ref="frmKhaoSatKH_HDTB" :_hdtbId="vbtlIdSelected" :_hdkhId="vHdkhIdSelected" :_giaoPhieuKsId="0"
        :isSuaPhieu="true" :isDaCapNhap="true" :_tbtlId="vbtlIdSelected" /> -->
    <frmKhaoSatKH ref="frmKhaoSatKH" />
    <frmKhaoSatKH_HDTB ref="frmKhaoSatKH_HDTB"/>
</div>
