<div>
    <div class="list-actions-top">
        <ul class="list">
            <li>
                <a href="javascript: void(0)" @click="onTimKiemClicked">
                    <span class="icon one-search"></span>Tìm kiếm
                </a>
            </li>
            <li>
                <a href="javascript: void(0)" @click="onKhaoSatClicked">
                    <span class="icon nc-icon-glyph business_chart-pie-36"></span>Khảo sát
                </a>
                <frmKhaoSatKH_HDTB ref="frmKhaoSatKH_HDTB" @onHideKhaoSat="onTimKiemClicked" />
                <frmKhaoSatKH_KLL ref="frmKhaoSatKH_KLL" @onHideKhaoSat="onTimKiemClicked" />
                <frmKhaoSatKH_LM ref="frmKhaoSatKH_LM" @onHideKhaoSat="onTimKiemClicked" />
                <frmKhaoSatKH_TB ref="frmKhaoSatKH_TB" @onHideKhaoSat="onTimKiemClicked" />
                <frmKhaoSatKH_TDDV ref="frmKhaoSatKH_TDDV" @onHideKhaoSat="onTimKiemClicked" />
                <frmKhaoSatKH ref="frmKhaoSatKH" @onHideKhaoSat="onTimKiemClicked" loaiKhaoSat="frmKhaoSatKH" />
                <frmKhaoSatKH ref="frmKhaoSatKH_Chua_NT" @onHideKhaoSat="onTimKiemClicked"
                    loaiKhaoSat="frmKhaoSatKH_Chua_NT" />
                <frmKhaoSatTB_CatChuyen ref="frmKhaoSatTB_CatChuyen" @onHideKhaoSat="onTimKiemClicked"
                    loaiKhaoSat="frmKhaoSatTB_CatChuyen" />
                <frmKhaoSatKH_BaoDuong ref="frmKhaoSatKH_BaoDuong" @onHideKhaoSat="onTimKiemClicked"
                    loaiKhaoSat="frmKhaoSatKH_BaoDuong" />
            </li>
            <li>
                <a href="javascript: void(0)" @click="onStartXuatFile">
                    <span class="icon arrows-2_square-download nc-icon-glyph"></span> Xuất file
                </a>
                <appModalXuatDuLieu id="modal-xuat-dulieu" :thuocTinh="dsThuocTinh"
                    :data="dataXuatFileDSKH" />
            </li>
            <li>
                <!-- <a href="javascript: void(0)" data-toggle="tooltip" title="Xuất Excel">
                    <downloadexcel :fields="exportExcelFields" :data="this.dsKhachHangKS" worksheet="export"
                    name="export.xls" :before-generate="onStartDownload">
                    <span class="icon one-excel"></span> Xuất Excel
                </downloadexcel> -->
                <!-- <span class="icon one-xlsx-import"></span>Xuất Excel -->
                <a href="javascript: void(0)" @click="Ver2_onExcelExport" title="Xuất excel">
                    <span class="icon one-excel"></span>Xuất Excel
                </a>
                </a>
            </li>
            <!-- <li>
                <a href="#">
                    <span class="icon one-file-trash"></span>Xóa phiếu
                </a>
            </li> -->
            <!-- <li>
                <a href="#">
                    <span class="icon one-circle-question"></span>Trợ giúp
                </a>
            </li> -->
        </ul>
    </div>
    <div class="page-content">
        <div class="row">
            <div class="col-sm-3 col-12">
                <div class="box-form">
                    <div class="legend-title">Chọn đơn vị</div>
                    <div class="input-icon-right">
                        <input type="text" class="form-control" v-model="tenDonViSearch" id="txtTenDonViSearch"
                            ref="txtTenDonViSearch" @keydown="onTenDonViSearch" @change="onTenDonViChange">
                        <span class="icon nc-icon-outline ui-1_zoom"></span>
                    </div>
                    <div class="tree-plus" style="height: 340px;overflow: auto;">
                        <ejs-treeview id="treeview" ref="treeObj" :fields='treeDonViFields' :showCheckBox='false'
                            :selectedNodes="selectedNodes" @nodeSelected="onDonViSelect">
                        </ejs-treeview>
                    </div>
                </div>
            </div>
            <div class="col-sm-9 col-12">
                <div class="box-form">
                    <div class="legend-title">Thông tin thuê bao</div>
                    <div class="row">
                        <div class="col-sm-7 col-12">
                            <div class="info-row">
                                <div class="key w80">Loại nhóm</div>
                                <div class="value">
                                    <div class="select-custom">
                                        <app-select2 :options="dsLoaiNhom" v-model="loaiNhomSelected"
                                            class="form-control"></app-select2>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-5 col-12">
                            <div class="info-row">
                                <div class="key w90">Tên thuê bao</div>
                                <div class="value">
                                    <input type="text" v-model="txtTenTB" class="form-control fw6" disabled>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-4 col-12">
                            <div class="info-row">
                                <div class="key w80">Loại HĐ/PL</div>
                                <div class="value">
                                    <div class="select-custom">
                                        <app-select2 :options="dsLoaiHD" v-model="loaiHDSelected"
                                            :disabled=this.loaiHDDisable class="form-control"></app-select2>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-3 col-12">
                            <div class="info-row">
                                <div class="key w90">Dịch vụ</div>
                                <div class="value">
                                    <div class="select-custom">
                                        <app-select2 :options="dsDichVu" v-model="dichVuSelected" class="form-control">
                                        </app-select2>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-5 col-12">
                            <div class="info-row">
                                <div class="key w90">Địa chỉ LĐ</div>
                                <div class="value">
                                    <input type="text" v-model="txtDiaChiLD" class="form-control fw6" disabled>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-4 col-12">
                            <div class="info-row">
                                <div class="key w80">Mã GD</div>
                                <div class="value">
                                    <input type="text" v-model="txtMaGD" class="form-control bold">
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-3 col-12">
                            <div class="info-row">
                                <div class="key w90">Số máy/Acc</div>
                                <div class="value">
                                    <input type="text" v-model="txtMaTB" class="form-control highlight bold">
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-5 col-12">
                            <div class="info-row">
                                <div class="key w90">Số ảo</div>
                                <div class="value">
                                    <input type="text" v-model="txtSoAo" class="form-control fw6 bold">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-4 col-12">
                            <div class="info-row">
                                <div class="key w80">Kiểu LĐ</div>
                                <div class="value">
                                    <input type="text" v-model="txtKieuLD" class="form-control bold">
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-3 col-12">
                            <div class="info-row">
                                <div class="key w90">Loại KH lớn</div>
                                <div class="value">
                                    <input type="text" v-model="txtKHLon" class="form-control bold">
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-5 col-12">
                            <div class="info-row">
                                <div class="key w90">Ghi chú</div>
                                <div class="value">
                                    <input type="text" v-model="txtGhiChu" class="form-control fw6 bold">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="box-form">
                    <div class="legend-title">Thông tin phiếu yêu cầu</div>
                    <div class="row">
                        <div class="col-sm-4 col-6">
                            <div class="info-row">
                                <div class="key w90">Từ ngày</div>
                                <div class="value">
                                    <ejs-datepicker v-model="pTxtThoiGianKSTu" :value="today" :max="today"
                                        :format="'dd/MM/y'" :showClearButton=false>
                                    </ejs-datepicker>
                                </div>
                            </div>
                            <div class="info-row">
                                <div class="key w90">Đến ngày</div>
                                <div class="value">
                                    <ejs-datepicker v-model="pTxtThoiGianKSDen" :value="today" :max="today"
                                        :format="'dd/MM/y'" :showClearButton=false>
                                    </ejs-datepicker>
                                </div>
                            </div>
                            <div class="info-row">
                                <div class="key w90">Trạng thái KS</div>
                                <div class="value">
                                    <div class="select-custom">
                                        <app-select2 :options="dsTrangThai" v-model="trangThaiSelected"
                                            class="form-control">
                                        </app-select2>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-8 col-18">
                            <div class="table-content" style="height: 108px;">
                                <DataGrid v-bind:columns="[
                                    { fieldName: 'NGUOI_HOI', headerText: 'Người hỏi', allowFiltering: true, allowSorting: true },
                                    { fieldName: 'NGUOI_TL', headerText: 'Người trả lời', allowFiltering: true, allowSorting: true },
                                    { fieldName: 'DIENTHOAI_LH', headerText: 'Điện thoại', allowFiltering: true, allowSorting: true },
                                    { fieldName: 'NGAY_HOI', headerText: 'Ngày hỏi	', allowFiltering: true, allowSorting: true },
                                    { fieldName: 'TRANGTHAI', headerText: 'Trạng thái', allowFiltering: true, allowSorting: true },
                                    { fieldName: 'LYDO_KTL', headerText: 'Lý do KTL', allowFiltering: true, allowSorting: true },
                                    { fieldName: 'GHICHU', headerText: 'Ghi chú', allowFiltering: true, allowSorting: true }
                                ]" @selectedRowChanged="onDsLanGoiRowSelected" v-bind:dataSource="dsLanGoiChuaTraLoi"
                                    :showFilter="true" :allowSorting="true" :allowPaging="true"
                                    :enablePagingServer="false">
                                </DataGrid>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="box-form">
            <div class="legend-title">Danh sách phiếu yêu cầu</div>
            <div class="table-content">
                <!-- <DataGrid3 :columns="dsKhachHangKSFields" ref="gridKhachHangKS"
                :dataSource="dsKhachHangKS"
                dataKeyField="DONVI_ID"
                :showFilter="true"
                :allowPaging="true"
                :enablePagingServer="false"
                @selectedRowChanged="onRowDSKhachHangKSSelected"
                @dataGridCellCreated="grid_dataGridCellCreated"
                >
                </Datagrid3> -->
                <DataGrid3 v-bind:columns="[
                { fieldName: 'MA_TB',headerText: 'Số máy/Acc',allowFiltering: true,allowSorting: false,freeze: 'left',cellCreatedEventEnabled: true,width: 150},
                { fieldName: 'LOAIHINH_TB', headerText: 'Loại hình TB',allowFiltering: true,allowSorting: false,freeze: 'left', width: 80},
                { fieldName: 'TOCDO',headerText: 'Tốc độ',allowFiltering: true,allowSorting: false,freeze: 'left',width: 120},
                { fieldName: 'NGAY_YC',headerText: 'Ngày yêu cầu',allowFiltering: true,allowSorting: false,freeze: 'left',cellCreatedEventEnabled: true,textAlign: 'right',width: 120},
                { fieldName: 'NGAY_HT',headerText: 'Ngày hoàn thành',allowFiltering: true,allowSorting: false,textAlign: 'right',freeze: 'left',width: 120},
                { fieldName: 'TEN_TB',headerText: 'Tên thuê bao',allowFiltering: true,allowSorting: false,freeze: 'left',width: 150},
                { fieldName: 'DIACHI_LD',headerText: 'Địa chỉ lắp đặt',allowFiltering: true,allowSorting: false,freeze: 'left'},
                { fieldName: 'SO_DT',headerText: 'Điện thoại KH',allowFiltering: true,allowSorting: false,freeze: 'left',width: 110},
                { fieldName: 'CHITIEU_TG',headerText: 'Chỉ tiêu TG',allowFiltering: true,allowSorting: false,},
                { fieldName: 'NGAY_SD',headerText: 'Ngày BĐSD	',allowFiltering: true,textAlign: 'right',allowSorting: false,},
                { fieldName: 'NGAY_CAT',headerText: 'Ngày TL',allowFiltering: true,textAlign: 'right',allowSorting: false,},
                { fieldName: 'SO_THANG',headerText: 'Số tháng SD',allowFiltering: true,allowSorting: false,},
                { fieldName: 'NGAY_INS',headerText: 'Ngày INS',allowFiltering: true,textAlign: 'right',allowSorting: false,},
                { fieldName: 'LAN_KS',headerText: 'Lần gọi',allowFiltering: true,allowSorting: false,cssClass: 'font-weight-bold'},
                { fieldName: 'HEN_TU',headerText: 'Ngày hẹn đầu',allowFiltering: true,allowSorting: false,},
                { fieldName: 'HEN_DEN',headerText: 'Ngày hẹn cuối',allowFiltering: true,allowSorting: false,},
                { fieldName: 'TEN_DT',headerText: 'Đối tượng',allowFiltering: true,allowSorting: false,},
                { fieldName: 'CHUNHOM',headerText: 'Chủ nhóm',allowFiltering: true,allowSorting: false,},
                { fieldName: 'GOI_KT',headerText: 'Gói KT',allowFiltering: true,allowSorting: false,},
                { fieldName: 'DONVI_TN',headerText: 'ĐV lập HĐ',allowFiltering: true,allowSorting: false,cellCreatedEventEnabled: true,cssClass: 'text-blue'},
                { fieldName: 'NHANVIEN_TN',headerText: 'NV tiếp nhận',allowFiltering: true,allowSorting: false,},
                { fieldName: 'DONVI_QL',headerText: 'Đơn vị QL',allowFiltering: true,allowSorting: false,cssClass: 'text-blue'},
                { fieldName: 'TRAM_VT',headerText: 'Tổ thi công',allowFiltering: true,allowSorting: false,cellCreatedEventEnabled: true,cssClass: 'text-purple'},
                { fieldName: 'TRANGTHAI_HD',headerText: 'Trạng thái HĐ',allowFiltering: true,allowSorting: false,},
                { fieldName: 'NGUOI_CN',headerText: 'Người CN',allowFiltering: true,allowSorting: false,},
                { fieldName: 'NGAY_CN',headerText: 'Ngày CN',allowFiltering: true,textAlign: 'right',allowSorting: false,},
                { fieldName: 'TEN_KIEULD',headerText: 'Kiểu yêu cầu',allowFiltering: true,allowSorting: false,},
                { fieldName: 'NGUOI_XL',headerText: 'Nhân viên hoàn công',allowFiltering: true,allowSorting: false,},
                { fieldName: 'LYDO_HONG',headerText: 'Lý do',allowFiltering: true,allowSorting: false,},
                { fieldName: 'THOIGIAN_TH',headerText: 'Thời gian TH',allowFiltering: true,allowSorting: false,},
                { fieldName: 'NGAY_HOI',headerText: 'Ngày hỏi',allowFiltering: true,textAlign: 'right',allowSorting: false,},
                { fieldName: 'NGUOI_HOI',headerText: 'Người hỏi',allowFiltering: true,allowSorting: false,},
                { fieldName: 'GHICHU',headerText: 'Ghi chú',allowFiltering: true,allowSorting: false,},
                { fieldName: 'TEN_NV_TH',headerText: 'Nhân viên thực hiện',allowFiltering: true,allowSorting: false,},
                { fieldName: 'NVKT_DB',headerText: 'Nhân viên KT quản lý địa bàn',allowFiltering: true,allowSorting: false,},
                { fieldName: 'NVKD_DB',headerText: 'Nhân viên KD quản lý địa bàn',allowFiltering: true,allowSorting: false,},
                { fieldName: 'TRANGTHAI_TB',headerText: 'Trạng thái thuê bao', allowFiltering: true,allowSorting: false,},
                { fieldName: 'ten_loaikh',headerText: 'Loại khách hàng',allowFiltering: true,allowSorting: false,},
                { fieldName: 'TEN_PBHKV',headerText: 'Phòng BH',allowFiltering: true,allowSorting: false,},
                { fieldName: 'TUYENTHU',headerText: 'Tuyến thu',allowFiltering: true,allowSorting: false,},
                { fieldName: 'TEN_NVTC',headerText: 'NVTC',allowFiltering: true,allowSorting: false,},
                { fieldName: 'CHUYENMANG',headerText: 'NCC khác',allowFiltering: true,allowSorting: false,displayAsCheckBox:true,cellCreatedEventEnabled: true,cssClass: 'text-center'}
                ]" v-bind:dataSource="dsKhachHangKS" dataKeyField="DONVI_ID" :showFilter="true" :allowPaging="true"
                    :allowExcelExport="true" :enablePagingServer="true" :totalRecords="totalItemsPhieu" @pageChanged="gridChanged"
                    @selectedRowChanged="onRowDSKhachHangKSSelected" ref="gridKhachHangKS" :panelDataHeight='"400"'
                    @queryCellInfo="onQueryCellInfo" @excelQueryCellInfo="onExcelQueryCellInfo">
                </DataGrid3>
            </div>
        </div>
    </div>
</div>
