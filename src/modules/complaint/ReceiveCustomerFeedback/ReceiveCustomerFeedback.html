<div>
  <breadcrumb :header="header"/>
  <div class="list-actions-top">
    <ul class="list">
      <li>
        <a href="javascript: void(0)"
           :class="{disabled: !tsbtnNhapMoi}">
          <span class="icon one-file-noti"></span> Nhập mới
        </a>
      </li>
      <li>
        <a href="javascript: void(0)"
           @click="tsbtnGhiLai_Click"
           :class="{disabled: !tsbtnGhiLai}">
          <span class="icon one-save"></span> Ghi lại
        </a>
      </li>
      <li>
        <a href="javascript: void(0)"
           :class="{disabled: !tsbtnHuyBo}">
          <span class="icon one-cancel"></span> Hủy
        </a>
      </li>
      <li>
        <a href="javascript: void(0)">
          <span class="icon one-print"></span> In phiếu
        </a>
      </li>
      <li>
        <a href="javascript: void(0)"
           :class="{disabled: !tsbtnXoa}"
           @click="tsbtnXoa_Click"
        >
          <span class="fa fa-times" style="font-size: 20px"></span> Xóa KN
        </a>
      </li>
      <li>
        <a href="javascript: void(0)">
          <span class="icon one-file-attach"></span> Hồ sơ
        </a>
      </li>
      <li>
        <a href="javascript: void(0)"
           :class="{disabled: !tsbtnGiaoPhieu}"
           @click="tsbtnGiaoPhieu_Click"
        >
          <span class="icon one-file-edit"></span> Giao phiếu
        </a>
      </li>
      <li>
        <a href="javascript: void(0)"
           :class="{disabled: !tsbtnKhoaPhieu}"
           @click="tsbtnKhoaPhieu_Click"
        >
          <span class="icon one-check"></span> Khóa phiếu
        </a>
      </li>
<!--      <li>-->
<!--        <a href="javascript: void(0)">-->
<!--          <span class="icon one-file-excel"></span> Đọc file-->
<!--        </a>-->
<!--      </li>-->
      <li>
        <a href="javascript: void(0)"
           @click="tsbtnThongSoKT_Click">
          <span class="icon one-td-settings"></span> Thông số KT
        </a>
      </li>
    </ul>
  </div>
  <div class="page-content">
    <div class="row">
      <div class="col-12">
        <div class="info-row d-flex justify-content-end">
          <div class="key w90">Kỳ hóa đơn</div>
          <div class="value text-secondary">
            <div class="select-custom kyhd">
              <SelectExt v-model="dtpKyHD"
                         :allowFiltering="true"
                         :dataSource="dtpKyHD_DataSource"
                         :disabled="true"
                         dataValueField="id"
                         dataTextField="value"/>
            </div>
          </div>

          <div class="key w70 pl-4">Chu kỳ</div>
          <div class="value text-secondary">
            <div class="select-custom kyhd">
              <SelectExt v-model="cboChuKy"
                         :allowFiltering="true"
                         :dataSource="cboChuKy_DataSource"
                         :disabled="true"
                         dataValueField="id"
                         dataTextField="value"/>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-sm-6 col-12">
        <div class="box-form">
          <div class="legend-title">
            <div class="title pull-left">
              <span>
                <i class="fa fa-minus-square-o text-primary i-panel1"
                   style="font-size: 14px; cursor: pointer"
                   @click="togglePanel('panel1')"></i>
              </span>
              Thông tin thuê bao
            </div>
            <div class="clearfix"></div>
          </div>
          <div style="height: 250px" class="row panel1">
            <div class="col-sm-6 col-12">
              <div class="info-row">
                <div class="key w110">Dịch vụ</div>
                <div class="value">
                  <div class="select-custom">
                    <SelectExt v-model="cboDichVu_VT"
                               :allowFiltering="true"
                               :disabled="true"
                               :dataSource="cboDichVu_VT_DataSource"
                               dataValueField="DICHVUVT_ID"
                               dataTextField="TEN_DVVT"/>
                  </div>
                </div>
              </div>
            </div>

            <div class="col-sm-6 col-12">
              <div class="info-row">
                <div class="key w110">Loại hình</div>
                <div class="value">
                  <div class="select-custom">
                    <SelectExt v-model="cboLoaiHinh"
                               :allowFiltering="true"
                               :disabled="true"
                               :dataSource="cboLoaiHinh_DataSource"
                               dataValueField="LOAITB_ID"
                               dataTextField="LOAIHINH_TB"/>
                  </div>
                </div>
              </div>
            </div>

            <div class="col-sm-6 col-12">
              <div class="info-row">
                <div class="key w110">Số máy/Acc</div>
                <div class="value">
                  <div class="input-more-button">
                    <button class="btn" @click="showFormTraCuuDanhBa">
                      <span class="-ap icon-more_horiz"></span>
                    </button>
                    <input type="text" class="form-control"
                           id="txtMaTB"
                           v-on:keypress.enter="txtMaTB_KeyPress"
                           v-model="txtMaTB">
                  </div>
                </div>
              </div>
            </div>

            <div class="col-sm-6 col-12">
              <div class="info-row m-0">
                <div class="key w110">Ngày tiếp nhận</div>
                <div class="">
                  <vue-date :disable="true" v-model="dtpNgayTN"/>
                </div>
              </div>
            </div>

            <div class="col-sm-6 col-12">
              <div class="info-row">
                <div class="key w110">Tên TB</div>
                <div class="value">
                  <input type="text" class="form-control bg-white"
                         readonly
                         v-model="txtTenTB">
                </div>
              </div>
            </div>

            <div class="col-sm-6 col-12">
              <div class="info-row">
                <div class="key w110">Loại khách hàng</div>
                <div class="value">
                  <div class="select-custom">
                    <SelectExt v-model="cboLoaiKH"
                               :allowFiltering="true"
                               :disabled="true"
                               :dataSource="cboLoaiKH_DataSource"
                               dataValueField="LOAIKH_ID"
                               dataTextField="TEN_LOAIKH"/>
                  </div>
                </div>
              </div>
            </div>

            <div class="col-12">
              <div class="info-row">
                <div class="key w110">Địa chỉ TB</div>
                <div class="value">
                  <input type="text" class="form-control bg-white"
                         readonly
                         v-model="txtDiaChiTB">
                </div>
              </div>
            </div>

            <div class="col-sm-6 col-12">
              <div class="info-row">
                <div class="key w110">Trạng thái</div>
                <div class="value">
                  <input type="text" class="form-control bg-white"
                         readonly
                         v-model="txtTrangThaiTB">
                </div>
              </div>
            </div>

            <div class="col-sm-6 col-12">
              <div class="info-row">
                <div class="key w110">Đối tượng</div>
                <div class="value">
                  <div class="select-custom">
                    <SelectExt v-model="cboDoi_Tuong"
                               :allowFiltering="true"
                               :disabled="true"
                               :dataSource="cboDoi_Tuong_DataSource"
                               dataValueField="DOITUONG_ID"
                               dataTextField="TEN_DT"/>
                  </div>
                </div>
              </div>
            </div>

            <div class="col-12">
              <div class="info-row">
                <div class="key w110">Địa chỉ TT</div>
                <div class="value">
                  <input type="text" class="form-control bg-white"
                         readonly
                         v-model="txtDiaChiTT">
                </div>
              </div>
            </div>

            <div class="col-12">
              <div class="info-row">
                <div class="key w110">Địa chỉ BC</div>
                <div class="value">
                  <input type="text" class="form-control bg-white"
                         readonly
                         v-model="txtDiaChiBC">
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="col-sm-6 col-12">
        <div class="box-form">
          <div class="legend-title">
            <div class="title pull-left">
              Thông tin chi tiết nợ
            </div>
            <div class="clearfix"></div>
          </div>

          <div style="height: 250px" class="panel1">
            <DataGrid :panel-data-height="'180'"
                      :dataSource="gridviewNo.data"
                      :columns="gridviewNo.cols"
                      :showColumnCheckbox="false"
                      :enablePagingServer="false"
                      ref="gridviewNo"
            ></DataGrid>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-sm-6 col-12">
        <div class="box-form">
          <div class="legend-title">
            <div class="title pull-left">
              <span>
                <i class="fa fa-minus-square-o text-primary i-panel2"
                   style="font-size: 14px; cursor: pointer"
                   @click="togglePanel('panel2')"></i>
              </span>
              Thông tin người phản hồi
            </div>
            <div class="clearfix"></div>
          </div>
          <div style="height: 180px" class="row panel2">
            <div class="col-sm-6 col-12">
              <div class="info-row">
                <div class="key w110">Người KN <span class="text-danger">(*)</span></div>
                <div class="value">
                  <input type="text" class="form-control"
                         id="txtNguoiKN"
                         v-model="txtNguoiKN">
                </div>
              </div>
            </div>

            <div class="col-sm-6 col-12">
              <div class="info-row">
                <div class="key w110">Điện thoại LH <span class="text-danger">(*)</span></div>
                <div class="value">
                  <input type="text" class="form-control"
                         id="txtDienThoaiLH"
                         v-model="txtDienThoaiLH">
                </div>
              </div>
            </div>

            <div class="col-sm-6 col-12">
              <div class="info-row">
                <div class="key w110">CMT</div>
                <div class="value">
                  <input type="text" class="form-control"
                         v-model="txtCMT">
                </div>
              </div>
            </div>

            <div class="col-sm-6 col-12">
              <div class="info-row m-0">
                <div class="key w110">Ngày cấp</div>
                <div class="">
                  <vue-date v-model="txtNgayCap" :format="'DD/MM/YYYY'" :type="'date'"/>
                </div>
              </div>
            </div>

            <div class="col-sm-6 col-12">
              <div class="info-row">
                <div class="key w110">Nơi cấp</div>
                <div class="value">
                  <input type="text" class="form-control"
                         v-model="txtNoiCap">
                </div>
              </div>
            </div>

            <div class="col-sm-6 col-12">
              <div class="info-row">
                <div class="key w110">Hình thức KN</div>
                <div class="value">
                  <div class="select-custom">
                    <SelectExt v-model="cboHinhThuc_KN"
                               :allowFiltering="true"
                               :dataSource="cboHinhThuc_KN_DataSource"
                               dataValueField="HTKN_ID"
                               dataTextField="HINHTHUC_KN"/>
                  </div>
                </div>
              </div>
            </div>

            <div class="col-sm-6 col-12">
              <div class="info-row">
                <div class="key w110">Địa chỉ LH</div>
                <div class="value">
                  <div class="input-more-button">
                    <button class="btn" v-b-modal.popupDiaChi>
                      <span class="-ap icon-more_horiz"></span>
                    </button>
                    <input type="text" class="form-control"
                           v-model="txtDiaChi">
                  </div>
                </div>
              </div>
            </div>

            <div class="col-sm-6 col-12">
              <div class="info-row">
                <div class="key w110">Email</div>
                <div class="value">
                  <input type="text" class="form-control"
                         v-model="txtEmail">
                </div>
              </div>
            </div>

            <div class="col-sm-6 col-12">
              <div class="info-row">
                <div class="key w110">
                  <div class="check-action">
                    <input type="checkbox"
                           class="check"
                           v-model="chkHenTL">
                    <span class="name">Hẹn TL từ</span>
                  </div>
                </div>
                <div class="d-flex align-items-center">
                  <vue-date :disable="!chkHenTL"
                            :type="'date'"
                            :format="'DD/MM/YYYY'"
                            id="dtpTuNgay"
                            v-model="dtpTuNgay"/>
                  <vue-date :disable="!chkHenTL"
                            :type="'date'"
                            :format="'DD/MM/YYYY'"
                            v-model="dtpDenNgay"/>
                </div>
              </div>
            </div>

            <div class="col-sm-6 col-12">
              <div class="info-row">
                <div class="key w110">Mã khiếu nại</div>
                <div class="value">
                  <input type="text" class="form-control readonly"
                         readonly
                         v-model="txtMaKN">
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="col-sm-6 col-12">
        <div class="box-form">
          <div class="legend-title">
            <div class="title pull-left">
              Lịch sử
            </div>
            <div class="clearfix"></div>
          </div>

          <div style="height: 180px" class="panel2">
            <DataGrid :panel-data-height="'110'"
                      :dataSource="gridview_ChukyNo.data"
                      :columns="gridview_ChukyNo.cols"
                      :showColumnCheckbox="false"
                      :enablePagingServer="false"
                      ref="gridview_ChukyNo"
            ></DataGrid>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-sm-6 col-12">
        <div class="box-form">
          <div class="legend-title">
            <div class="title pull-left">
              <span>
                <i class="fa fa-minus-square-o text-primary i-panel3"
                   style="font-size: 14px; cursor: pointer"
                   @click="togglePanel('panel3')"></i>
              </span>
              Thông tin phản hồi
            </div>
            <div class="clearfix"></div>
          </div>

          <div style="height: 230px" class="row panel3">
            <div class="col-sm-6 col-12">
              <div class="info-row">
                <div class="key w110">Loại chủ đề</div>
                <div class="value">
                  <div class="select-custom">
                    <SelectExt v-model="cboLoai_CD"
                               :allowFiltering="true"
                               :dataSource="cboLoai_CD_DataSource"
                               dataValueField="loai_id"
                               dataTextField="ten_loai"/>
                  </div>
                </div>
              </div>
            </div>

            <div class="col-sm-6 col-12">
              <div class="info-row">
                <div class="key w110">Chủ đề</div>
                <div class="value">
                  <div class="select-custom">
                    <SelectExt v-model="cboChuDe_KN2"
                               id="cboChuDe_KN2"
                               :allowFiltering="true"
                               :dataSource="cboChuDe_KN2_DataSource"
                               dataValueField="chudekn_id"
                               dataTextField="tenchude"/>
                  </div>
                </div>
              </div>
            </div>

            <div class="col-12">
              <div class="info-row">
                <div class="key w110">Nội dung PH <span class="text-danger">(*)</span></div>
                <div class="value">
                  <textarea v-model="txtNoiDungKN"
                            id="txtNoiDungKN"
                            class="form-control"
                            style="resize: none"
                            rows="9"></textarea>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="col-sm-6 col-12">
        <div class="box-form">
          <div class="legend-title">
            <div class="title pull-left">
              Kết quả xử lý
              <input class="ml-4" type="radio" v-model="chkXuLy" :value="1"/> Xử lý được
              <input class="ml-4" type="radio" v-model="chkXuLy" :value="2"/> Không xử lý được
            </div>
            <div class="pull-right">
              <button class="btn btn-sm btn-primary" style="margin-top: -10px">
                <i class="fa fa-plus-circle"></i> Chèn nợ
              </button>
            </div>
            <div class="clearfix"></div>
          </div>
          <div style="height: 230px" class="panel3">
            <div class="row" v-show="chkXuLy === 2">
              <div class="col-12">
                <div class="info-row">
                  <div class="key w90">Lý do</div>
                  <div class="value">
                  <textarea v-model="txtLyDo"
                            class="form-control"
                            style="resize: none; height: 239px"
                            rows="11"></textarea>
                  </div>
                </div>
              </div>
            </div>
            <div class="row" v-show="chkXuLy === 1">
              <div class="col-sm-5 col-12">
                <div class="info-row">
                  <div class="key w90">Ngày XL</div>
                  <div class="">
                    <vue-date :disable="true" v-model="dtpNgayXL"/>
                  </div>
                </div>

                <div class="info-row">
                  <div class="key w90">Người XL</div>
                  <div class="value">
                    <SelectExt v-model="cboNhanVien"
                               id="cboNhanVien"
                               :allowFiltering="true"
                               :dataSource="cboNhanVien_DataSource"
                               dataValueField="nhanvien_id"
                               dataTextField="ten_nv"/>
                  </div>
                </div>

                <div class="info-row">
                  <div class="key w90">Nội dung XL</div>
                  <div class="value">
                  <textarea v-model="txtNoiDungXL"
                            id="txtNoiDungXL"
                            class="form-control"
                            style="resize: none"
                            rows="2"></textarea>
                  </div>
                </div>

                <div class="info-row">
                  <div class="key w90">N.Nhân</div>
                  <div class="value">
                  <textarea v-model="txtNguyenNhan"
                            class="form-control"
                            style="resize: none"
                            rows="2"></textarea>
                  </div>
                </div>

                <div class="info-row">
                  <div class="key w90">Kết quả lỗi</div>
                  <div class="value">
                    <div class="input-more-button">
                      <button class="btn">
                        <span class="-ap icon-more_horiz"></span>
                      </button>
                      <SelectExt v-model="cboLoi"
                                 id="cboLoi"
                                 :allowFiltering="true"
                                 :dataSource="cboLoi_DataSource"
                                 dataValueField="KETQUAKN_ID"
                                 dataTextField="NOIDUNG"/>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-sm-7 col-12">
                <DataGrid :panel-data-height="'160'"
                          :dataSource="grvTienGC.data"
                          :columns="grvTienGC.cols"
                          :showColumnCheckbox="false"
                          :enablePagingServer="false"
                          ref="grvTienGC"
                ></DataGrid>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-12">
        <vue-card label="Danh sách phản hồi">
          <DataGrid :dataSource="gridviewDS_KHIEUNAI.data"
                    :columns="gridviewDS_KHIEUNAI.cols"
                    :allow-paging="true"
                    :panel-data-height="'250'"
                    :showColumnCheckbox="true"
                    :enablePagingServer="false"
                    ref="gridviewDS_KHIEUNAI"
                    @rowSelected="gridviewDS_KHIEUNAI_FocusedRowChanged"
          ></DataGrid>
        </vue-card>
      </div>
    </div>
  </div>

  <FormTraCuuTB :dsThueBao="dsThueBao"
                ref="formTraCuuTB"/>

  <b-modal ref="popupSearchAccount" size="xl" hide-footer hide-header hide-header-close
           body-class="modal-body p-0 frm-chon-port">
    <SearchAccount @form-close="acceptSearchAccount" :isPopup="true"/>
  </b-modal>
  <ModalChonDiaChi modalId="popupDiaChi" @xacnhan="getDiaChi"/>
  <ThongSoKyThuat ref="frmThongSoKyThuat" :ptarget="'main-wrapper'" :thuebaoid="this.thuebao_id"/>
</div>
