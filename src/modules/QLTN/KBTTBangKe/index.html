<div>
    <div class="list-actions-top">
        <ul class="list">
            <li>
                <a href="#" @click.prevent="onClickTimKiem" title="Tìm kiếm">
                  <span class="icon one-search"></span> Tìm kiếm
                </a>
            </li>
            <li>
                <a href="#" @click.prevent="onClickXuatFile" title="Xuất File">
                  <span class="icon one-excel"></span> Xuất File
                </a>
            </li>
        </ul>
    </div>
    <div class="page-content">
        <div class="box-form">
        <div class="row">
            <div class="col-sm-6 col-12">
                <div class="box-form">
                    <div class="legend-title"><span :class="[!showTTBangKe ? 'icon -ap icon-arrow-up' : 'icon -ap icon-arrow-down']" @click="showTTBangKe = !showTTBangKe"></span>Thông tin bảng kê</div>
                    <div v-show="!showTTBangKe">
                        <div class="row">
                            <div class="col-sm-6 col-12">
                                <div class="info-row">
                                    <div class="key w100">Kỳ hóa đơn</div>
                                    <div class="value">
                                        <div class="select-custom">
                                            <SelectExt v-model.trim="pKyHoaDon" :dataSource="dsKyHoaDon" dataTextField="HIENTHI"
                                            dataValueField="CHUKYNO"/>
                                        </div>
                                    </div>
                                </div>
                                <div class="info-row">
                                    <div class="key w100">Từ ngày</div>
                                    <div class="value">
                                        <div class="input-icon-right">
                                        <input v-model="pTuNgay" type="text" class="form-control">
                                        <span class="icon one-calendar"></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6 col-12">
                                <div class="info-row">
                                    <div class="key w100">Lần gửi</div>
                                    <div class="value">
                                        <input v-model="txtLanGui" type="text" class="form-control bold">
                                    </div>
                                </div>
                                <div class="info-row">
                                    <div class="key w100">Đến ngày</div>
                                    <div class="value">
                                        <div class="input-icon-right">
                                        <input v-model="pDenNgay" type="text" class="form-control">
                                        <span class="icon one-calendar"></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="info-row">
                            <div class="key w100">Trạng thái BK</div>
                            <div class="value">
                                <div class="select-custom">
                                    <select v-model="cboTrangThai" name="" id="" class="form-control">
                                    <option value="0">Mới khởi tạo</option>
                                    <option value="1">Đã gửi KBNN</option>
                                    <option value="6">Hoàn thành</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="info-row">
                            <div class="key w100">Trạng thái tỉnh</div>
                            <div class="value">
                                <div class="select-custom">
                                    <select v-model="cboTrangThaiPV" name="" id="" class="form-control">
                                    <option value="0">Mới khởi tạo</option>
                                    <option value="6">Đã gửi KBNN</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-6 col-12">
                                <div class="info-row">
                                    <div class="key w100">Ngày tạo</div>
                                    <div class="value">
                                        <div class="input-icon-right">
                                        <input v-model="pNgayTao" type="text" class="form-control">
                                        <span class="icon one-calendar"></span>
                                        </div>
                                    </div>
                                </div>
                                <div class="info-row">
                                    <div class="key w100">Ngày nhận</div>
                                    <div class="value">
                                        <div class="input-icon-right">
                                        <input v-model="pNgayNhan" type="text" class="form-control">
                                        <span class="icon one-calendar"></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6 col-12">
                                <div class="info-row">
                                    <div class="key w100">Ngày HT</div>
                                    <div class="value">
                                        <div class="input-icon-right">
                                        <input v-model="pNgayHT" type="text" class="form-control">
                                        <span class="icon one-calendar"></span>
                                        </div>
                                    </div>
                                </div>
                                <div class="info-row">
                                    <div class="key w100">Tổng tiền</div>
                                    <div class="value">
                                        <!-- <input v-model="txtTongTien" type="text" class="form-control tright red"> -->
                                        <vue-numeric class="form-control tright red" currency="" separator="," v-model="txtTongTien"></vue-numeric>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="info-row">
                            <div class="key w100">MSG ID gửi</div>
                            <div class="value">
                                <input v-model="txtMsg_Gui_ID" type="text" class="form-control bold">
                            </div>
                        </div>
                        <div class="info-row">
                            <div class="key w100">MSG ID nhận</div>
                            <div class="value">
                                <input v-model="txtMsg_Nhan_ID" type="text" class="form-control bold">
                            </div>
                        </div>
                        <div class="info-row">
                        <div class="key w100">MSG ID lỗi</div>
                        <div class="value">
                            <input v-model="txtMsg_Loi_ID" type="text" class="form-control bold">
                        </div>
                    </div>
                    </div>
                </div>
            </div>
            <div class="col-sm-6 col-12">
                <div class="box-form">
                    <div class="legend-title"><span :class="[!showDSBangKe ? 'icon -ap icon-arrow-up' : 'icon -ap icon-arrow-down']" @click="showDSBangKe = !showDSBangKe"></span>Danh sách bảng kê</div>
                    <DataGrid v-show="!showDSBangKe" :columns="[
                        {fieldName: 'KY_HD', headerText: 'Kỳ hóa đơn', allowFiltering: true, cssClass:'text-primary'},
                        {fieldName: 'TONGTIEN', headerText: 'Tổng tiền', allowFiltering: true, type:'number',format:'N0'},
                        {fieldName: 'NGAYTAO', headerText: 'Ngày tạo', allowFiltering: true},
                        {fieldName: 'TRANG_THAI', headerText: 'Trạng thái', allowFiltering: true},
                        {fieldName: 'NGAY_HT', headerText: 'Ngày HT', allowFiltering: true},
                        {fieldName: 'MSG_GUI_ID', headerText: 'MSG gửi ID', allowFiltering: true},
                        {fieldName: 'THUTU', headerText: 'Thứ tự', allowFiltering: true},
                        {fieldName: 'MSG_NHAN_ID', headerText: 'MSG nhận ID', allowFiltering: true},
                        {fieldName: 'MSG_LOI_ID', headerText: 'MSG lỗi ID', allowFiltering: true},
                        {fieldName: 'NGAY_NHAN', headerText: 'Ngày nhận', allowFiltering: true},
                        ]" :dataSource="dsBangKe" :showFilter="true" ref="gridDsBangKe" @selectedRowChanged="NAP_DS_CHITIET_BANGKE"
                        :key="keyResetBangKe" :allowPaging="true" :enablePagingServer="false"
                    />
                </div>
            </div>
        </div>
        </div>
        <div class="box-form">
            <div class="legend-title">Danh sách thanh toán</div>
            <DataGrid :columns="[
                {fieldName: 'MA_KH', headerText: 'Mã KH', allowFiltering: true, cssClass:'text-primary', freeze: 'Left'},
                {fieldName: 'MA_TT', headerText: 'Mã TT', allowFiltering: true},
                {fieldName: 'LOAI_DV', headerText: 'Loại DV', allowFiltering: true},
                {fieldName: 'MA_KBNN', headerText: 'Mã KBNN', allowFiltering: true},
                {fieldName: 'TRANGTHAI_GUI', headerText: 'Trạng thái gửi', allowFiltering: true},
                {fieldName: 'TRANGTHAI_NHAN', headerText: 'Trạng thái nhận', allowFiltering: true},
                {fieldName: 'TONGTIEN', headerText: 'Tổng tiền', allowFiltering: true, type:'number',format:'N0', cssClass:'text-danger'},
                {fieldName: 'TIENTRA', headerText: 'Tiền trả', allowFiltering: true, type:'number',format:'N0', cssClass:'text-danger'},
                ]" :dataSource="dsThanhToan" :showFilter="true" ref="gridDsThanhToan" :showColumnCheckbox=true
                :allowPaging="true" :enablePagingServer="false" :enabledSelectFirstRow="false" :key="keyResetThanhToan"
                :aggregates="[
                    {field: 'TONGTIEN', type: 'Custom', footerTemplate: this.customTemplate, customAggregateFn: this.aggCountTongTien},
                    {field: 'TIENTRA', type: 'Custom', footerTemplate: this.customTemplate, customAggregateFn: this.aggCountTongTra},
                ]"
                />
        </div>
    </div>
</div>
