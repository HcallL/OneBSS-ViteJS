
<div class="main-wrapper">
    <div class="list-actions-top">
             <ul class="list">          
               <li>
                 <a href="javascript: void(0)"
                                 @click="onCapNhapClicked">
                   <span class="icon one-calendar-sync"></span>Cập nhật
                 </a>
                 
               </li>
               <li>
                 <a href="javascript: void(0)" @click="onExportExcel()"> 
                   <!-- <downloadexcel :fields="exportExcelFields" :data="this.dsDocTuFile" worksheet="export" name="export.xls" :before-generate="onStartDownload">
                             <span class="icon one-excel"></span> Xuất Excel
                   </downloadexcel> -->
                   <span class="icon one-excel"></span> Xuất Excel 
                 </a>
               </li>
             </ul>
           </div>
           <div class="popup-body">
           <div class="main-title">đọc file giao kế hoạch chăm sóc khách hàng</div>        
           
             <div class="box-form">
               <div class="row">
                 <div class="col-sm-6 col-12">
                   <div class="info-row">
                     <div class="key w100">Đường dẫn</div>
                     <div class="value">
                       <div class="input-more-button">
                         <label for="upload" class="btn">
                           <span class="-ap icon-more_horiz"></span>
                           <input
                             type="file"
                             id="upload"
                             ref="fileInput"
                             style="display: none"
                             @change="onChangeFile"
                             @click="$refs.fileInput.value=null"
                           />
                         </label>
                         <input
                           type="text"
                           class="form-control"
                           id="showFileNameUpload"
                           v-model="txtFileName"
                         />
                       </div>
                     </div>
                   </div>
                 </div>
                 <div class="col-sm-6 col-12">
                   <div class="note mart10">
                     <span class="one-alert text-warning f20 vcenter inline"></span>
                     <span class="text-main"
                       >File excel gồm 3 trường: MA_TT, DOITUONG, LOAI</span
                     >
                     <div class="float-right">
                       <a href="javascript: void(0)" @click="onTaiFileMauClicked">Tải file mẫu</a>
                     </div>
                   </div>
                   
                 </div>
               </div>
             </div>
             <div class="box-form">
               <div class="legend-title">
                 <div class="title pull-left">Danh sách phiếu chờ cập nhật</div>
                 <div class="pull-right red fw6 font-weight-bold">
                   
                   <span> {{msgThongBao}}</span>
                 </div>
                 <div class="clearfix"></div>
               </div>
               <div class="nav tabs tab-over">
                 <a
                     @click="tabDanhSach = false"
                     :class="{ active: !tabDanhSach }"
                     >Danh sách</a
                 >
                 <a
                     @click="tabDanhSach = true"
                     :class="{ active: tabDanhSach }"
                     >Lỗi</a
                 >
               </div>
               <div class="tab-content">
                 <DataGrid3
                     v-show="!tabDanhSach"
                     v-bind:columns="[
                         {
                             fieldName: 'MA_TT',
                             headerText: 'Mã TT',
                             allowFiltering: true,
                         },
                         {
                             fieldName: 'DOITUONG',
                             headerText: 'DOITUONG',
                             allowFiltering: true,
                         },
                         {
                             fieldName: 'TEN_LOAI',
                             headerText: 'LOAI',
                             allowFiltering: true,
                         },
                         
                     ]"
                     :dataSource="dsKhongLoi"
                     :showFilter="true"
                     dataKeyField="STT"
                     :allowPaging="true"
                     :enablePagingServer="false"
                     :enabledSelectFirstRow="true"
                     :allowExcelExport="true"
                     ref="tblDsDocFile"
                   ></DataGrid3>
                   <DataGrid3
                     v-show="tabDanhSach"
                     v-bind:columns="[
                         {
                             fieldName: 'TRANGTHAI',
                             headerText: 'Lý do lỗi',
                             allowFiltering: true,
                         },
                         {
                             fieldName: 'MA_TT',
                             headerText: 'Mã TT',
                             allowFiltering: true,
                         },
                         {
                             fieldName: 'DOITUONG',
                             headerText: 'DOITUONG',
                             allowFiltering: true,
                         },
                         {
                             fieldName: 'TEN_LOAI',
                             headerText: 'LOAI',
                             allowFiltering: true,
                         },
                     ]"
                     :dataSource="dsLoi"
                     :showFilter="true"
                     dataKeyField="STT"
                     :allowPaging="true"
                     :enablePagingServer="false"
                     :enabledSelectFirstRow="true"
                     :allowExcelExport="true"
                     ref="tblDsLoi"
                   >
                 </DataGrid3>
               </div>
             </div>
           </div>
         </div>
       
        
    </div>