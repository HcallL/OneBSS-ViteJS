<div>
    <div class="list-actions-top">
        <ul class="list">
            <li>
                <a class='btn' @click='LAM_MOI' :class="{'disable-btn': isDisableNhapMoi}">
                    <span class="icon one-file-plus"></span> Nhập mới
                </a>
            </li>
            <li>
                <a  class='btn' @click='HOAN_THIEN'>
                    <span class="icon one-file-check"></span> Hoàn thiện
                </a>
            </li>
        </ul>
        <div class="more">
            <a href="#">
                <span class="icon -ap  icon-dots-three-vertical"></span>
            </a>
        </div>
    </div>
    <div class="page-content">
        <div class="row">
            <div class="col-sm-6 col-12">
                <div class="box-form">
                    <div class="legend-title">Thông tin phiếu yêu cầu</div>
                    <div class="row">
                        <div class="col-sm-8 col-12">
                            <div class="info-row">
                                <div class="key w90">Mã GD</div>
                                <div class="value">
                                    <div class="input-more-button">
                                        <button class="btn" @click='btnLayMaGD_Click'>
                                            <span class="-ap icon-more_horiz"></span>
                                        </button>
                                        <input type="text" ref='ma-dg' v-model="dataSelected.ma_gd" @keypress='madg_keypress' class="form-control highlight">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-4 col-12">
                            <div class="info-row">
                                <div class="key w90">Ngày YC</div>
                                <div class="value">
                                    <div class="input-icon-map">
                                        <ejs-datepicker class="form-control bg-none bor0 fw6 text h24" :disabled='isDisable' 
                                        :value="date.dateVal" :format="date.dateFormat" v-model="dataSelected.ngay_yc"></ejs-datepicker>
                                        <!-- <span class="icon one-calendar text-desc"></span>
                                        <span class="check-action fa fa-angle-down text-desc"></span> -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-8 col-12">
                            <div class="info-row">
                                <div class="key w90">Dịch vụ VT</div>
                                <div class="value">
                                    <div class="select-custom">
                                        <SelectExt v-model="dataSelected.dichvu_id" :dataSource="dsDVVT"
                                         dataTextField="ten_dvvt"
                                         dataValueField="dichvuvt_id"
                                         @change ='dichVu_onChange' />
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-4 col-12">
                            <div class="info-row">
                                <div class="key w90">Ngày lập HĐ</div>
                                <div class="value">
                                    <div class="input-icon-map">
                                        <ejs-datepicker class="form-control bg-none bor0 fw6 text h24" 
                                        :value="date.dateVal" :format="date.dateFormat" v-model="dataSelected.ngay_lap_hd"></ejs-datepicker>
                                        <!-- <input type="text" class="form-control">
                                        <span class="icon one-calendar text-desc"></span>
                                        <span class="check-action fa fa-angle-down text-desc"></span> -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-8 col-12">
                            <div class="info-row">
                                <div class="key w90">Kiểu yêu cầu</div>
                                <div class="value">
                                    <div class="select-custom">
                                        <SelectExt v-model="dataSelected.kieuld_id" :dataSource="dsKieuLD"
                                         dataTextField="ten_kieuld"
                                        dataValueField="kieuld_id"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-4 col-12">
                            <div class="info-row">
                                <div class="key w90">Loại hình</div>
                                <div class="value">
                                    <div class="select-custom">
                                        <SelectExt v-model="dataSelected.loaihinh_id" 
                                        :disabled='isDisable'
                                        :dataSource="dsLoaiHinh"
                                         dataTextField="loaihinh_tb"
                                        dataValueField="loaitb_id"
                                        @change="cbbLoaiHinh_Change"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="box-form">
                    <div class="legend-title">Thông tin thuê bao</div>
                    <div class="info-row">
                        <div class="key w90">Số máy/Acc</div>
                        <div class="value">
                            <input type="text" ref='ma-tbao' v-model="dataSelected.somay_acc" @keypress='matb_keypress' class="form-control highlight">
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key w90">Tên thuê bao</div>
                        <div class="value">
                            <input type="text" v-model="dataSelected.ten_tbao" @keypress='tentb_keypress' class="form-control">
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key w90">Địa chỉ TB</div>
                        <div class="value">
                            <input type="text" v-model="dataSelected.diachi_tbao" class="form-control">
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key w90">Địa chỉ LĐ</div>
                        <div class="value">
                            <input type="text" v-model="dataSelected.diachi_ld" class="form-control">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-8 col-12">
                            <div class="info-row">
                                <div class="key w90">Đối tượng</div>
                                <div class="value">
                                    <div class="select-custom">
                                        <SelectExt v-model="dataSelected.doituong_id" 
                                        :dataSource="dsDoiTuong"
                                        dataTextField="ten_dt"
                                       dataValueField="doituong_id"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-4 col-12">
                            <div class="info-row">
                                <div class="key w90">Email</div>
                                <div class="value">
                                    <input type="text" v-model="dataSelected.email" class="form-control">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                </div>
                <div class="box-form">
                    <div class="legend-title">Danh sách số máy</div>
                    <div class="info-row">

                        <div class="value">

                            <div class="bss-1828-list-checks-ncc list-group" ref="somay" v-show='dsSoMay.length>0'
                                            style="max-height: 200px;margin-bottom: 10px;overflow: scroll;">
                                            <b-list-group class="item" v-for="(cc,index) in dsSoMay" :key="index">
                                                <b-list-group-item>
                                                    <div class="check-action check-color">
                                                        <input type="checkbox" :id="cc.hdtb_id" class="check"
                                                            @click="getChecked(cc.hdtb_id)">
                                                        <span class="name">{{cc.ma_tb}}</span>
                                                    </div>
                                                </b-list-group-item>
                                            </b-list-group>
                                        </div>
                            <textarea name="" v-model="dataSelected.dsSo_may" v-show='dsSoMay.length==0'
                            class="form-control" style="height: 120px;resize: none;"></textarea> 
                        </div>
                    </div>
                    
                    
                </div>
            </div>
            <div class="col-sm-6 col-12">
                <div class="box-form">
                    <div class="legend-title">Thông tin khách hàng</div>
                    <div class="info-row">
                        <div class="key">Mã KH</div>
                        <div class="value">
                            <input type="text" v-model="dataSelected.ma_kh" @keypress='makh_keypress' class="form-control">
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key">Tên khách hàng</div>
                        <div class="value">
                            <input type="text" v-model="dataSelected.ten_kh" @keypress='tenkh_keypress' class="form-control">
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key">Địa chỉ KH</div>
                        <div class="value">
                            <input type="text" v-model="dataSelected.diachi_kh" class="form-control">
                        </div>
                    </div>
                </div>
                <div class="box-form">
                    <div class="legend-title">Thông tin thanh toán</div>
                    <div class="row">
                        <div class="col-sm-8 col-12">
                            <div class="info-row">
                                <div class="key">Mã TT</div>
                                <div class="value">
                                    <input type="text" v-model="dataSelected.ma_thanhtoan"  @keypress='matt_keypress'
                                    class="form-control">
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-4 col-12">
                            <div class="info-row">
                                <div class="key w100">Mã đại diện</div>
                                <div class="value">
                                    <input type="text" v-model="dataSelected.ma_daidien"
                                     class="form-control highlight">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="info-row">
                        <div class="key">Tên thanh toán</div>
                        <div class="value">
                            <input type="text" v-model="dataSelected.ten_thanhtoan" @keypress='tentt_keypress'
                             class="form-control">
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key">Địa chỉ TT</div>
                        <div class="value">
                            <input type="text" v-model="dataSelected.diachi_tt"
                             class="form-control">
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key">Địa chỉ CT</div>
                        <div class="value">
                            <input type="text" v-model="dataSelected.diachi_ct" 
                            class="form-control">
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key">Địa chỉ BC</div>
                        <div class="value">
                            <input type="text" v-model="dataSelected.diachi_bc"
                             class="form-control">
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key">Đơn vị QL</div>
                        <div class="value">
                            <div class="select-custom">
                                <SelectExt v-model="dataSelected.donvi_ql_id"
                                        :disabled='!isDisable' 
                                        :dataSource="dsDonViQL"
                                        dataTextField="ten_dv"
                                       dataValueField="donvi_id"/>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-8 col-12">
                            <div class="info-row">
                                <div class="key">Hình thức TT</div>
                                <div class="value">
                                    <div class="select-custom">
                                        <SelectExt v-model="dataSelected.hinhthuc_tt_id"
                                         :dataSource="dsHTTT"
                                        dataTextField="hinhthuc_tt"
                                       dataValueField="httt_id"
                                       @change='Httt_onChange'/>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-4 col-12">
                            <div class="info-row">
                                <div class="key w100">Mã NVTC</div>
                                <div class="value">
                                    <div class="row">
                                        <div class="col-sm-6 col-12">
                                            <input type="text" v-model="dataSelected.ma_nvtc" class="form-control highlight">
                                        </div>
                                        <div class="col-sm-6 col-12">
                                            <input type="text" v-model="dataSelected.ma_tuyen" class="form-control highlight">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-8 col-12">
                            <div class="info-row">
                                <div class="key">Tài khoản</div>
                                <div class="value">
                                    <input type="text" v-model="dataSelected.tai_khoan" class="form-control">
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-4 col-12">
                            <div class="info-row">
                                <div class="key w100">Mã số thuế</div>
                                <div class="value">
                                    <input type="text" v-model="dataSelected.ma_sothue" class="form-control">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key">Ngân hàng</div>
                        <div class="value">
                            <div class="select-custom">
                                <SelectExt v-model="dataSelected.nganhang_id"
                                       :disabled='isDisableNganHang'
                                       :dataSource="dsNganHang"
                                        dataTextField="ten_nh"
                                       dataValueField="nganhang_id"/>
                            </div>
                        </div>
                    </div>
                    
                    <div class="info-row">
                        <div class="key">Ghi chú</div>
                        <div class="value">
                            <textarea name="" class="form-control" v-model="dataSelected.ghichu" style="height: 54px;resize: none;"></textarea>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="box-form">
            <div class="legend-title">Danh sách phiếu yêu cầu</div>
            <DataGrid ref="grid-thuebao" v-bind:columns="[
            {fieldName: 'ma_gd', headerText: 'Mã GD', allowFiltering: true},
            {fieldName: 'ten_kh', headerText: 'Tên khách hàng', allowFiltering: true},
            {fieldName: 'ten_tt', headerText: 'Tên thanh toán', allowFiltering: true},
            {fieldName: 'diachi_tt', headerText: 'Địa chỉ thanh toán', allowFiltering: true},
             ]"
              v-bind:dataSource="dsPhieuYc" 
              :showFilter="true"
              @selectedRowChanged="gridthuebao_selectedRowChanged"
              @pageChanged='gridthuebao_PageChanged'
              :allowPaging="true" 
              :totalRecords='tongphieu'
              enalblepagingServer='false'></DataGrid>            
        </div>
    </div>
    <SearchContractModal 
    ref="popupSearchContract" 
    @accept="acceptSearchContract"
    :loai_hd_id="dataSelected.loaihinh_id"
    :dichvu_id="dataSelected.dichvu_id"
    :ngay_yc="''" :ngay_kt="''"
    :trangthai_hd="1" />  
</div>