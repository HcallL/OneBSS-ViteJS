<b-modal
size="xl"
no-close-on-backdrop
hide-footer
hide-header
hide-header-close
body-class="modal-body p-0"
@shown="onShownModal"
@hidden="onHiddenModal"
:id="id"
:key="key">
    <div class="modal-content popup-box">
        <div class="popup-header">
            <div class="title"><span class="icon one-notepad"></span> Trả phiếu khiếu nại</div>
            <div class="close -ap icon-close" data-dismiss="modal" @click="$bvModal.hide(id)"></div>
        </div>
        <div class="list-actions-top">
            <ul class="list">
                <li>
                    <a href="#" @click="btnLayTTMoi_Click()">
                        <span class="icon one-file-attach"></span> Lấy TT (F5)
                    </a>
                </li>
                <li>
                    <a href="#" @click="btnTraphieu_Click()">
                        <span class="icon nc-icon-glyph files_single-content-03"></span> Trả phiếu
                    </a>
                </li>
            </ul>
        </div>
        <div class="popup-body">
            <div class="box-form">
                <div class="legend-title">Thông tin khiếu nại</div>
                <div class="row">
                    <div class="col-sm-7 col-12">
                        <div class="row">
                            <div class="col-sm-7 col-12">
                                <div class="info-row">
                                    <div class="key">Mã máy/Acc</div>
                                    <div class="value">
                                        <input type="text" class="form-control highlight" v-model="modelInput.txtMaTB" v-on:keyup.enter="onEnterAcc()">
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-5 col-12">
                                <div class="info-row">
                                    <div class="key w100">Ngày tiếp nhận</div>
                                    <div class="value">
                                        <div class="input-icon-right">
                                            <ejs-datepicker
                                                v-model="modelDateTime.dtpNgayTN"
                                                :format="modelDateTime.dateFormat"
                                                :value="modelDateTime.dtpNgayTN"
                                                :enabled="false"
                                            ></ejs-datepicker>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-7 col-12">
                                <div class="info-row">
                                    <div class="key">Người tiếp nhận</div>
                                    <div class="value">
                                        <input type="text" class="form-control" v-model="modelInput.txtNguoiTN" :disabled="true">
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-5 col-12">
                                <div class="info-row">
                                    <div class="key w100">Người liên hệ</div>
                                    <div class="value">
                                        <input type="text" class="form-control" v-model="modelInput.txtNguoiLH" :disabled="true">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-7 col-12">
                                <div class="info-row">
                                    <div class="key">
                                        <div class="check-action">
                                            <input type="checkbox" class="check" v-model='modelCkeckBox.chkHenTL'>
                                            <span class="name">Hẹn TL từ</span>
                                        </div>
                                    </div>
                                    <div class="value">
                                        <div class="input-icon-right">
                                            <ejs-datepicker
                                                v-model="modelDateTime.dtpTuNgay"
                                                :format="modelDateTime.dateFormat"
                                                :value="modelDateTime.dtpTuNgay"
                                                :enabled="modelDateTime.enableDate"
                                            ></ejs-datepicker>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-5 col-12">
                                <div class="info-row">
                                    <div class="key w100">Hẹn TL đến</div>
                                    <div class="value">
                                        <div class="input-icon-right">
                                            <ejs-datepicker
                                                v-model="modelDateTime.dtpDenNgay"
                                                :format="modelDateTime.dateFormat"
                                                :value="modelDateTime.dtpDenNgay"
                                                :enabled="false"
                                            ></ejs-datepicker>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="info-row">
                            <div class="key">
                                Ghi chú
                            </div>
                            <div class="value">
                                <input type="text" class="form-control" v-model="modelInput.txtGhiChu" :disabled="true">
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-5 col-12">
                        <div class="info-row">
                            <div class="key w90">Tên TB</div>
                            <div class="value">
                                <input type="text" class="form-control" v-model="modelInput.txtTenTB" :disabled="true">
                            </div>
                        </div>
                        <div class="info-row">
                            <div class="key w90">Địa chỉ TB</div>
                            <div class="value">
                                <input type="text" class="form-control" v-model="modelInput.txtDiaChiTB" :disabled="true">
                            </div>
                        </div>
                        <div class="info-row">
                            <div class="key w90">Nội dung KN</div>
                            <div class="value">
                                <textarea name=""  v-model="modelInput.txtNoiDungKN" class="form-control" id="" cols="30" rows="10" style="height: 66px;resize: none;"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="legend-title mart20">Thông tin phiếu giao</div>
                <div class="row">
                    <div class="col-sm-7 col-12">
                        <div class="info-row">
                            <div class="key">Ngày giao</div>
                            <div class="value w20 padt7">
                                <div class="check-action">
                                    <input type="checkbox" class="check" v-model='modelCkeckBox.chkNgayGiao'>
                                    <span class="name"></span>
                                </div>
                            </div>
                            <div class="value">
                                <div class="input-icon-right">
                                    <ejs-datepicker
                                                v-model="modelDateTime.dtpNgayGiao"
                                                :format="modelDateTime.dateFormat"
                                                :value="modelDateTime.dtpNgayGiao"
                                                :enabled="modelDateTime.enableDate"
                                            ></ejs-datepicker>
                                </div>
                            </div>
                        </div>
                        <div class="info-row">
                            <div class="key">Số quyết định</div>
                            <div class="value">
                                <input type="text" class="form-control" v-model="modelInput.txtSoQD" :disabled="true">
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-5 col-12">
                        <div class="info-row">
                            <div class="key w90">Đơn vị</div>
                            <div class="value">
                                <input type="text" class="form-control" v-model="modelInput.txtDonViGiao" :disabled="true">
                            </div>
                        </div>
                        <div class="info-row">
                            <div class="key w90">Nhân viên</div>
                            <div class="value">
                                <input type="text" class="form-control" v-model="modelInput.txtNhanVienGiao" :disabled="true">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="legend-title mart20">Thông tin phiếu trả</div>
                <div class="row">
                    <div class="col-sm-7 col-12">
                        <div class="row">
                            <div class="col-sm-7 col-12">
                                <div class="info-row">
                                            <div class="key">Ngày trả</div>
                                            <div class="value w20 padt7">
                                                <div class="check-action">
                                                    <input type="checkbox" class="check" v-model='modelCkeckBox.chkNgayTra'>
                                                    <span class="name"></span>
                                                </div>
                                            </div>
                                            <div class="value">
                                                <div class="input-icon-right">
                                                    <ejs-datepicker
                                                        v-model="modelDateTime.dtpNgayTra"
                                                        :format="modelDateTime.dateFormat"
                                                        :value="modelDateTime.dtpNgayTra"
                                                        :enabled="modelDateTime.enableDate"
                                                    ></ejs-datepicker>
                                                </div>
                                            </div>
                                        </div>
                            </div>
                            <div class="col-sm-5 col-12">
                                <div class="info-row">
                                    <div class="key w50">Kiểu trả</div>
                                    <div class="value">
                                        <div class="select-custom" ref="cboTT">
                                            <SelectExt
                                                v-model="modelCbo.mcboTT"
                                                :settings="{dropdownParent: $refs['cboTT']}"
                                                :dataSource="modelCbo.vcboTT"
                                                dataTextField="NOIDUNG"
                                                dataValueField="LOAIPT_ID"/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="info-row">
                            <div class="key">Ghi chú</div>
                            <div class="value">
                                <textarea name="" class="form-control" v-model="modelInput.txtGhiChuTra" style="height: 66px;resize: none;" id="" cols="30" rows="10"></textarea>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-5 col-12">
                        <div class="info-row">
                            <div class="key w90">Nội dung trả</div>
                            <div class="value">
                                <bss-error-marker :has-error="$v.modelInput.txtNDTra.$error">
                                    <textarea name="" class="form-control" v-model="$v.modelInput.txtNDTra.$model" style="height: 101px;resize: none;" id="" cols="30" rows="10"></textarea>
                                </bss-error-marker>
                            </div>
                        </div>
                        
                    </div>
                </div>
            </div>
            <div class="box-form">
                <div class="legend-title">Danh sách phiếu yêu cầu khiếu nại</div>
                <div class="table-content">
                    <DataGrid ref="grid" v-bind:columns="[
                        {fieldName: 'STT', headerText: 'STT', allowFiltering: true, allowSorting: true, width: 80},
                        {fieldName: 'MA_KN', headerText: 'Mã KN', allowFiltering: true, allowSorting: true, width: 150},
                        {fieldName: 'MA_TB', headerText: 'Số máy/ acc', allowFiltering: true, allowSorting: true, width: 150},
                        {fieldName: 'TEN_TB', headerText: 'Tên thuê bao', allowFiltering: true, allowSorting: true},
                        {fieldName: 'LOAIHINH_TB', headerText: 'Loại hình', allowFiltering: true, allowSorting: true},
                        {fieldName: 'NGAYGIAO', headerText: 'Ngày giao', allowFiltering: true, allowSorting: true},
                        {fieldName: 'DONVI_GIAO', headerText: 'Đơn vị giao', allowFiltering: true, allowSorting: true},
                        {fieldName: 'MA_NV', headerText: 'Nhân viên TC', allowFiltering: true, allowSorting: true},
                        {fieldName: 'PHOMG_BH', headerText: 'Đơn vị QL', allowFiltering: true, allowSorting: true},
                        ]"
                            v-bind:dataSource="dtList"
                            dataKeyField="PHIEUKN_ID"
                            :showFilter="true"
                            :allowPaging = true
                            :enablePagingServer = false
                            @selectedItemsChanged="selectedItemsDsHoSo">
                    </DataGrid>
                </div>
        </div>
        </div>
    </div>
</b-modal>