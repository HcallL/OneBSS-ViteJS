<div class="main-wrapper main-wrappertcabc">
    <breadcrumb :header="header" />
    <!-- <div class="breadcrumb-top">
        <div class="main-title">{{formTitle}}</div>
        <ul class="breadcrumb">
            <li class="breadcrumb-item"><a href="#"><span class="nc-icon-outline ui-1_home-simple"></span> Trang chủ
                </a></li>
            <li class="breadcrumb-item"><a href="#">Tra cứu</a></li>
            <li class="breadcrumb-item"><a href="#">Phát triển thuê bao</a></li>
            <li class="breadcrumb-item active">{{formTitle}}</li>
        </ul>
    </div> -->
    <div class="list-actions-top">
        <ul class="list">
            <li>
                <a href="#" @click.prevent="tsbtnTimKiem_Click">
                    <span class="icon one-search"></span>Tìm kiếm
                </a>
            </li>
            <li>
                <a href="#" @click.prevent="XuatFile">
                    <span class="icon one-download"></span>Xuất file
                </a>
            </li>
            <li>
                <a href="#" @click.prevent="XuatFileExcel2">
                    <span class="icon one-xlsx-import"></span>Xuất Excel
                </a>
            </li>
            <li>
                <a href="#" @click.prevent="tsbtnPhieuChuaTH_Click">
                    <span class="icon one-file-edit2"></span>Phiếu CTH
                </a>
            </li>
            <li>
                <a href="#" @click.prevent="tsbtnCTThiCong_Click">
                    <span class="icon one-file-edit2"></span>Phiếu TC
                </a>
            </li>
            <!-- <li>
                <a href="#" @click.prevent="show_diachild" v-b-modal.pop_diachild>
                    <span class="icon nc-icon-glyph location_position-pin"></span>Địa chỉ LĐ
                </a>
                <pop_diachild  :hdtb_id = "hdtb_id" :ma_tb = "acc_moi" :loai_hd = "loai_hd"
                :ma_gd = "ma_gd" :dichvuvt_id = "dichvu_vt" :diachi="diachi_ld"/>
            </li> -->
            <li>
                <a href="#" @click.prevent="show_diachild2">
                    <span class="icon nc-icon-glyph location_position-pin"></span>Địa chỉ LĐ
                </a>

            </li>
            <!-- https://cntt.vnpt.vn/browse/BSS-1715 -->
            <!-- <li>
                <a href="#" @click="tsbtnTCTienTrinhBH_Click">
                    <span class="icon one-tc"></span>TC Tiến trình
                </a>
            </li> -->


        </ul>

    </div>
    <div class="page-content">
        <div class="box-form">
            <div class="legend-title">Thông tin phiếu yêu cầu</div>
            <div class="row">
                <div class="col-sm-6 col-12" style="padding-left: 15px;">
                    <div class="row">
                        <div class="col-sm-12 col-12">
                            <div class="info-row">
                                <div class="key w90">
                                    <div class="check-action">
                                        <input type="checkbox" class="check" v-model="fCheck.LoaiHdId">
                                        <span class="name">Loại HĐ </span>
                                    </div>
                                </div>
                                <div class="value">
                                    <Select2 :disabled="!fCheck.LoaiHdId" v-bind:class="{ disabled: !fCheck.LoaiHdId }"
                                        v-model="fInput.LoaiHdId" :options="DmLoaiHd" @change='GetDmKieuYeuCaus'  />
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-sm-12 col-12">
                            <div class="info-row">
                                <div class="key w90">
                                    <div class="check-action">
                                        <input type="checkbox" class="check" v-model="fCheck.LoaiDvVTId">
                                        <span class="name">Dịch vụ</span>
                                    </div>
                                </div>
                                <div class="value">
                                    <Select2 :disabled="!fCheck.LoaiDvVTId"
                                        v-bind:class="{ disabled: !fCheck.LoaiDvVTId }" v-model="fInput.LoaiDvVTId"
                                        :options="DmLoaiDichVu" @change='GetDmKieuYeuCaus' />
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-sm-6 col-12">
                            <div class="info-row">
                                <div class="key w90">
                                    <div class="check-action">
                                        <input type="checkbox" class="check" v-model="fCheck.TuNgay">
                                        <span class="name">Từ ngày</span>
                                    </div>
                                </div>
                                <div class="value">
                                    <div class="input-icon-right">
                                        <date-picker v-bind:class="{ disabled: !fCheck.TuNgay }" :format="dateFormat"
                                            :value-type="dateFormat" :time-title-format="dateFormat"
                                            v-model="fInput.TuNgay" :type="typeFormat">
                                            <template #icon-calendar>
                                                <span class="icon one-calendar"></span>
                                            </template>
                                        </date-picker>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6 col-12">
                            <div class="info-row">
                                <div class="key">
                                    Đến ngày
                                </div>
                                <div class="value">
                                    <div class="input-icon-right">
                                        <date-picker v-bind:class="{ disabled: !fCheck.TuNgay }" :format="dateFormat"
                                            :value-type="dateFormat" :time-title-format="dateFormat"
                                            v-model="fInput.DenNgay" :type="typeFormat">
                                            <template #icon-calendar>
                                                <span class="icon one-calendar"></span>
                                            </template>
                                        </date-picker>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-12 col-12">
                            <div class="info-row">
                                <div class="key w90">
                                    <div class="check-action">
                                        <input :disabled="!fCheck.LoaiDvVTId" type="checkbox" class="check"
                                            v-model="fCheck.KieuYeuCauId">
                                        <span class="name">Kiểu YC</span>
                                    </div>
                                </div>
                                <div class="value">
                                    <Select2 :disabled="!fCheck.KieuYeuCauId"
                                        v-bind:class="{ disabled: !fCheck.KieuYeuCauId }" v-model="fInput.KieuYeuCauId"
                                        :options="DmKieuYeuCau" />
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-sm-8 col-12">
                            <div class="info-row">
                                <div class="key w90">
                                    <div class="check-action">
                                        <input type="checkbox" class="check" v-model="fCheck.TtPhieuId">
                                        <span class="name">TT Phiếu</span>
                                    </div>
                                </div>
                                <div class="value">
                                    <!--
                                    <div class="select-custom">
                                        <select name="" id="" class="form-control" v-model="fInput.TtPhieuId"
                                            v-bind:class="{ disabled: !fCheck.TtPhieuId }">
                                            <option value=""></option>
                                            <option v-for="item in DmTTPhieu" v-bind:value="item.ttph_id">{{
                                                item.trangthai_ph}}
                                            </option>
                                        </select>
                                    </div>
                                    -->
                                    <Select2 :disabled="!fCheck.TtPhieuId"
                                        v-bind:class="{ disabled: !fCheck.TtPhieuId }" v-model="fInput.TtPhieuId"
                                        :options="DmTTPhieu" />
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-4 col-12">
                            <div class="info-row">
                                <div class="key">
                                    Trạng thái
                                </div>
                                <div class="value">
                                    <!--
                                    <div class="select-custom">
                                        <select name="" id="" class="form-control" v-model="fInput.TtId">
                                            <option value=""></option>
                                            <option v-for="item in DsTTPhieu" v-bind:value="item.trangthai_id">{{
                                                item.trangthai}}
                                            </option>
                                        </select>
                                    </div>
                                    -->
                                    <Select2 :disabled="!fCheck.TtPhieuId || fInput.TtPhieuId!=1"
                                        v-bind:class="{ disabled: !fCheck.TtPhieuId || fInput.TtPhieuId!=1 }"
                                        v-model="fInput.TtId" :options="DsTTPhieu" />
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-8 col-12">
                            <div class="info-row">
                                <div class="key w90">
                                    <div class="check-action">
                                        <input type="checkbox" class="check" v-model="fCheck.KieuKhoaMoId">
                                        <span class="name">Kiểu KM</span>
                                    </div>
                                </div>
                                <div class="value">
                                    <!--
                                    <div class="select-custom">
                                        <select name="" id="" class="form-control" v-model="fInput.KieuKhoaMoId"
                                            v-bind:class="{ disabled: !fCheck.KieuKhoaMoId }">
                                            <option value=""></option>
                                            <option v-for="item in DmKieuKhoaMo" v-bind:value="item.kieukm_id">{{
                                                item.kieu_km}}
                                            </option>
                                        </select>
                                    </div>
                                    -->
                                    <Select2 :disabled="!fCheck.KieuKhoaMoId"
                                        v-bind:class="{ disabled: !fCheck.KieuKhoaMoId }" v-model="fInput.KieuKhoaMoId"
                                        :options="DmKieuKhoaMo" />
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-4 col-12">
                            <div class="info-row">
                                <div class="key">
                                    <div class="check-action">
                                        <input type="checkbox" class="check" v-model="fCheck.KieuKhoaMayId">
                                        <span class="name">Chiều KM</span>
                                    </div>
                                </div>
                                <div class="value">
                                    <!-- <div class="select-custom">
                                        <select name="" id="" class="form-control" v-model="fInput.KieuKhoaMayId"
                                            v-bind:class="{ disabled: !fCheck.KieuKhoaMayId }">
                                            <option value=""></option>
                                            <option v-for="item in DmChieuKhoaMay" v-bind:value="item.chieukm_id">
                                                {{item.chieu_km}}
                                            </option>
                                        </select>
                                    </div> -->
                                    <Select2 :disabled="!fCheck.KieuKhoaMayId"
                                        v-bind:class="{ disabled: !fCheck.KieuKhoaMayId }"
                                        v-model="fInput.KieuKhoaMayId" :options="DmChieuKhoaMay" />
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-8 col-12">
                            <div class="info-row">
                                <div class="key w90">
                                    <div class="check-action">
                                        <input type="checkbox" class="check" v-model="fCheck.TtHdId">
                                        <span class="name">TTH.Đồng</span>
                                    </div>
                                </div>
                                <div class="value">
                                    <!-- <div class="select-custom">
                                        <select name="" id="" class="form-control" v-model="fInput.TtHdId"
                                            v-bind:class="{ disabled: !fCheck.TtHdId }">
                                            <option value=""></option>
                                            <option v-for="item in DmTrangThaiHD" v-bind:value="item.ttph_id">{{
                                                item.trangthai_hd}}
                                            </option>
                                        </select>
                                    </div> -->
                                    <Select2 :disabled="!fCheck.TtHdId" v-bind:class="{ disabled: !fCheck.TtHdId }"
                                        v-model="fInput.TtHdId" :options="DmTrangThaiHD" />
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-4 col-12">
                            <div class="info-row">
                                <div class="key">
                                    <div class="check-action">
                                        <input type="checkbox" class="check" v-model="fCheck.UseLHD">
                                        <span class="name">User LHĐ/PL</span>
                                    </div>
                                </div>
                                <div class="value">
                                    <input type="text" :disabled="!fCheck.UseLHD" class="form-control highlight"
                                        v-model="fInput.UseLHD" v-bind:class="{ disabled: !fCheck.UseLHD }">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6 col-12" style="padding-left: 15px;">
                    <div class="row">
                        <div class="col-sm-4 col-12">
                            <div class="info-row">
                                <div class="key w100">Số máy/Acc</div>
                                <div class="value">
                                    <input type="text" v-model.trim="fInput.MaThueBao"  v-on:keyup.enter='txtMaTB_KeyPress' class="form-control highlight  bold">
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-8 col-12">
                            <div class="info-row">
                                <div class="key w60">Số ảo</div>
                                <div class="value">
                                    <input type="text" v-model="fInput.SoAo" class="form-control  bold">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-12 col-12">
                            <div class="info-row">
                                <div class="key w100">Tên thuê bao</div>
                                <div class="value">
                                    <input type="text" v-model="fInput.TenThueBao" class="form-control fw6  bold"
                                        v-on:keyup.enter="Search">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-12 col-12">
                            <div class="info-row">
                                <div class="key w100">Địa chỉ LĐ</div>
                                <div class="value">
                                    <input type="text" v-model="fInput.DiaChiLd" class="form-control fw6 bold">
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-sm-12 col-12">
                            <div class="info-row">
                                <div class="key w100">Địa chỉ LĐ đầu</div>
                                <div class="value">
                                    <input type="text" v-model="fInput.DiaChiLd_Dau" readonly="true"
                                        class="form-control">
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-sm-12 col-12">
                            <div class="info-row">
                                <div class="key w100">Địa chỉ LĐ cuối</div>
                                <div class="value">
                                    <input type="text" v-model="fInput.DiaChiLd_Cuoi" readonly="true"
                                        class="form-control">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-12 col-12">
                            <div class="info-row">
                                <div class="key w100">Hẹn lắp</div>
                                <div class="value henLap">
                                    <gridView :headers="HenLap.headers" :datalist="HenLap.data" :flcol="HenLap.flcol"
                                        :showCheck='false' :showHeader='true' :lastcoltemplate="-1">
                                    </gridView>
                                    <!-- <div class="row">
                                        <div class="col-sm-12 col-12">
                                            <DataGrid v-bind:columns="HenLap.headers2" v-bind:dataSource="HenLap.data"
                                            :showColumnCheckbox="false" :enable-paging-server="false" :allowPaging="false"
                                            :showFilter="true">
                                        </DataGrid>
                                        </div>
                                    </div> -->

                                    <!--
                            <div class="box-move-select-table">
                                <div class="row">
                                    <DataGrid v-bind:columns="HenLap.headers2" v-bind:dataSource="HenLap.data"
                                        :showColumnCheckbox="false" :enable-paging-server="false" :allowPaging="true"
                                        :showFilter="true" ref="refHenLap">
                                    </DataGrid>
                                </div>
                            </div>
                            -->
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
        <div class="box-form">
            <div class="legend-title">
                <div class="pull-left">Danh sách phiếu giao đến</div>
                <div class="pull-right">
                    <div class="list-checks red">
                        <div class="item">
                            Tổng số: {{TongSoPhieu}}
                        </div>
                        <div class="item">
                            Phiếu mới: {{TongSoPhieuMoi}}
                        </div>
                        <div class="item">
                            Phiếu đã thực hiện: {{TongSoPhieuThucHien}}
                        </div>
                        <div class="item">
                            Phiếu trả lại: {{TongSoPhieuTraLai}}
                        </div>
                    </div>
                </div>
                <div class="clearfix"></div>
            </div>
            <div class="table-content">
                <DataGrid v-show="true" v-bind:columns="gridview_DsPhieu.headers" v-bind:dataSource="gridview_DsPhieu.data" :allowGrouping="true"
                    :showColumnCheckbox="false" :enable-paging-server="false" :allowPaging="allowPaging" :showFilter="showFilter"
                    ref="refgridview_DsPhieu" @pageChanged="grid_pageChanged" :allowExcelExport="true"
                    @selectedRowChanged="gridview_DsPhieu_SelectRow" @rowDoubleClicked="DblClickTree">
                </DataGrid>
                <!-- export excel all page -->
                <DataGrid v-show="false" v-bind:columns="gridview_DsPhieu.headers2" v-bind:dataSource="gridview_DsPhieu.data2" :allowGrouping="true"
                    :showColumnCheckbox="false" :enable-paging-server="false" :allowPaging="false" :showFilter="false"
                    ref="refgridview_DsPhieuExcel"  @actionComplete="refgridview_DsPhieuExcel_ActionComplete" :allowExcelExport="true" >
                </DataGrid>
                 <!-- end export excel all page -->
            </div>
        </div>
    </div>
    <b-modal id="popupComponents" size="xl" hide-footer hide-header hide-header-close body-class="modal-body p-0">
        <component :is="popupComponent" isPopup="true" @form-close="DiaChiLapDatClosed"></component>
    </b-modal>

    <popupLayDuLieuBC ref="dialogLayDuLieuBC"></popupLayDuLieuBC>
    <showDiaChiLapDat ref="dialogObjShowDiaChiLapDat" :hdtb_id="hdtb_id" :dichvuvt_id="dichvu_id" :ma_tb="ma_tb"
        :ma_gd="ma_gd" :loai_hd="loai_hd"></showDiaChiLapDat>
    <ExportDataModal ref="exportDataModal" :data="this.gridview_DsPhieu.dataExcel"></ExportDataModal>

  <!-- <ejs-dialog :enableResize='true' :visible="false" ref="dialogObjTraCuuPhieuThiCong" :animationSettings="animationSettings"
              :header='"Tra cứu phiếu TC chưa thực hiện"' showCloseIcon=true target="#app .main-wrapper" :position='position' width='100%' :target='target'
  >
    <keep-alive>
      <div class="popupComponentPayment">
        <component :is="userComponentModuleNoConstruction"  ref='refdialogSearchConstructionNoConstruction'  v-bind="popupComponentAttr" v-on="popupComponentEvts" />
      </div>
    </keep-alive>
  </ejs-dialog>    

  <ejs-dialog :enableResize='true' :visible="false" ref="refdialogObjSearchInstallDetail" :animationSettings="animationSettings"
              :header='modalTitle' showCloseIcon=true target="#app .main-wrapper" :position='position' width='100%'
             >
    <keep-alive>
      <div class="popupComponentPayment">
        <component :is="userComponentModule"  ref='refdialogObjSearchInstallDetailContent'  v-bind="popupComponentAttr" v-on="popupComponentEvts" />
      </div>
    </keep-alive>
  </ejs-dialog>
  <ejs-dialog :enableResize='true' :visible="false" ref="refdialogObjDeclareLandline" :animationSettings="animationSettings"
              :header='modalTitle' showCloseIcon=true target="#app .main-wrapper" :position='position' width='100%'
  >
    <keep-alive>
      <div class="popupComponentPayment">
        <component :is="userComponentModuleDeclareLandline"  ref='refObjDeclareLandline'  v-bind="popupComponentAttr" v-on="popupComponentEvts" />
      </div>
    </keep-alive>
  </ejs-dialog>

  <ejs-dialog :enableResize='true' :visible="false" ref="refdialogObjfrmHoanCongDMAdsl_Huyen" :animationSettings="animationSettings"
              :header='modalTitle' showCloseIcon=true target="#app .main-wrapper" :position='position' width='100%'
  >
    <keep-alive>
      <div class="popupComponentPayment">
        <component :is="userComponentModuleHoanCongDMAdslHuyen"  ref='refObjfrmHoanCongDMAdsl_Huyen' :data="popupComponentData" v-bind="popupComponentAttr" v-on="popupComponentEvts" />
      </div>
    </keep-alive>
  </ejs-dialog> -->

  <ejs-dialog :enableResize='true' :visible="false" ref="generalDialog" :animationSettings="animationSettings"
              :header='modalTitle' showCloseIcon=true target="#app .main-wrapper" :position='position' width='100%'
  >
    <keep-alive>
      <div class="popupComponentPayment">
        <component :is="userComponentModule"  ref='dialogComponent'   v-bind="popupComponentAttr" v-on="popupComponentEvts" @hook:mounted="handleComponentMounted"/>
      </div>
    </keep-alive>
  </ejs-dialog>

</div>
