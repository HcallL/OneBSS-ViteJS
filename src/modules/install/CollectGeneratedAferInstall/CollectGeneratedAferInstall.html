<div class="main-wrapper">
    <div class="breadcrumb-top">
        <div class="main-title">trạm - thu tiền phát sinh</div>
        <ul class="breadcrumb">
            <li class="breadcrumb-item"><a href="#"><span class="nc-icon-outline ui-1_home-simple"></span> Trang chủ </a></li>
            <li class="breadcrumb-item"><a href="#">Thanh toán</a></li>
            <li class="breadcrumb-item active"><a href="#">Trạm - Thu tiền phát sinh</a></li>
        </ul>
    </div>
    <div class="list-actions-top">
        <ul class="list">
            <li>
                <a href="#" @click.prevent="btnLayTTClicked">
                    <span class="icon one-file-attach"></span> Lấy TT (F5)
                </a>
            </li>
            <li>
                <a href="#" @click.prevent="btnUpdateClicked">
                    <span class="icon one-reload1"></span> Cập nhật (F9)

                </a>
            </li>
            <li>
                <a href="#" @click.prevent="onAssignClick">
                    <span class="icon one-file-edit2"></span> Giao việc
                </a>
            </li>
            <li :class="hoanCongEnable === false ? 'disabled' : ''">
                <a href="#" @click.prevent="onHoanCongClick" 
                    >
                    <span class="icon one-hoancong"></span> Hoàn công
                </a>
            </li>
            <li>
                <a href="#">
                    <span class="icon one-file-download"></span>Xuất phiếu
                </a>
            </li>
        </ul>
    </div>
    <div class="page-content">
        
        <div class="row">
            <div class="col-sm-6 col-12">
                <div class="box-form">
                    <div class="legend-title">Thông tin khách hàng</div>
                    <div class="row">
                        <div class="col-sm-6 col-12">
                            <div class="info-row">
                                <div class="key w120">Dịch vụ</div>
                                <div class="value">
                                    <div class="select-custom">
                                        <SelectExt ref="" dataTextField="TEN_DVVT" dataValueField="DICHVUVT_ID"
                                            :dataSource="listbox.DSDichVu.DataSource" v-model="DichVuVT" v-on:change="DSDichVuChange($event)"> 
                                        </SelectExt>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6 col-12">
                            <div class="info-row">
                                <div class="key w80">Quy trình</div>
                                <div class="value">
                                    <div class="select-custom">
                                        <SelectExt ref="" dataTextField="quytrinh" dataValueField="quytrinh_id"
                                            :dataSource="listbox.DSQuyTrinh.DataSource" v-model="QuyTrinhDV" v-on:change="GetHuongGiaoTheoQuyTrinh($event)">
                                        </SelectExt>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-6 col-12">
                            <div class="info-row">
                                <div class="key w120">Mã giao dịch</div>
                                <div class="value">
                                    <input type="text" class="form-control" v-model="MaGD">
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6 col-12">
                            <div class="info-row">
                                <div class="key w80">Mã thuê bao</div>
                                <div class="value">
                                    <input type="text" class="form-control" v-model="MaTB">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key w120">Kiểu yêu cầu</div>
                        <div class="value">
                            <input type="text" class="form-control" v-model="KieuYC">
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key w120">Tên khách hàng</div>
                        <div class="value">
                            <input type="text" class="form-control" v-model="TenKH">
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key w120">Địa chỉ khách hàng</div>
                        <div class="value">
                            <input type="text" class="form-control" v-model="DiaChiKH">
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key w120">Tên thanh toán</div>
                        <div class="value">
                            <input type="text" class="form-control" v-model="TenTT">
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key w120">Địa chỉ thanh toán</div>
                        <div class="value">
                            <input type="text" class="form-control" v-model="DiaChiTT">
                        </div>
                    </div>
                    <div class="legend-title mart20">Thông tin hoàn công</div>
                    <div class="row">
                        <div class="col-sm-6 col-12">
                            <div class="info-row">
                                <div class="key w120">
                                    <div class="check-action">
                                        <input type="checkbox" class="check" v-model="KetQuaXL">
                                        <span class="name">Kết quả XL</span>
                                    </div>
                                </div>
                                <div class="value">
                                    <div class="select-custom">
                                        <SelectExt ref="" dataTextField="ketqua_xl" dataValueField="kqxl_id"
                                            :dataSource="listbox.DSKQXuLy.DataSource" v-model="KetQuaXuLy" :disabled="!isKetQuaXL"> 
                                        </SelectExt>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6 col-12">
                            <div class="info-row">
                                <div class="key w80">Đổi tốc độ</div>
                                <div class="value padt7 w20">
                                    <div class="check-action">
                                        <input type="checkbox" class="check" v-model="DoiTocDo">
                                        <span class="name"></span>
                                    </div>
                                </div>
                                <div class="value">
                                    <div class="select-custom">
                                        <SelectExt ref="" dataTextField="toc_do" dataValueField="tocdo_id"
                                            :dataSource="listbox.DSTocDo.DataSource" v-model="TocDo" :disabled="!isTocDo">
                                        </SelectExt>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key w120">
                            <div class="check-action">
                                <input type="checkbox" class="check" v-model="KhuyenMai">
                                <span class="name">T.Trước</span>
                            </div>
                        </div>
                        <div class="value">
                            <div class="input-more-button">
                                <button class="btn">
                                    <span class="-ap icon-more_horiz"></span>
                                </button>
                                <div class="select-custom">
                                    <SelectExt ref="" dataTextField="ten_km" dataValueField="khuyenmai_id"
                                        :dataSource="listbox.DSKhuyenMai.DataSource" v-model="CBBKhuyenMai" :disabled="!isKhuyenMai">
                                    </SelectExt>
                                </div>
                            </div>
                        </div>
                        <div class="value w30 nowrap">
                            <button class="btn btn-second">
                                <span class="one-eye f20 inline vcenter"></span> Chi tiết
                            </button>
                        </div>
                    </div>

                    

                    <div class="row">
                        <div class="col-sm-6 col-12">
                            <div class="info-row">
                                <div class="key w120">
                                    Cước ĐC
                                </div>
                                <div class="value">
                                    <input type="text" class="form-control" v-model="CuocDatCoc" :disabled="true">
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6 col-12">
                            <div class="info-row">
                                <div class="key w80">Tiền/ tháng</div>
                                
                                <div class="value">
                                    <input type="text" class="form-control" v-model="TienTrenThang" :disabled="true">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-6 col-12">
                            <div class="info-row">
                                <div class="key w120">
                                    Số tháng
                                </div>
                                <div class="value">
                                    <input type="text" class="form-control" v-model="SoThang" :disabled="true">
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6 col-12">
                            <div class="info-row">
                                <div class="key w80">Tổng tiền</div>
                                
                                <div class="value">
                                    <div class="input-more-button">
                                        <button class="btn">
                                            <span class="-ap icon-more_horiz"></span>
                                        </button>
                                        <input type="text" class="form-control red tright" v-model="TongTien" :readonly="true">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-sm-6 col-12">
                <div class="box-form">
                    <div class="legend-title">Thông tin giao việc</div>
                    <div class="row">
                        <div class="col-sm-6 col-12">
                            <div class="info-row">
                                <div class="key w100">
                                    <div class="check-action">
                                        <input type="checkbox" class="check" v-model="ngaygv">
                                        <span class="name">Ngày GV</span>
                                    </div>
                                </div>
                                <div class="value">
                                    <div class="input-icon-right">
                                        <flat-pickr class="form-control" :config="dateconfig" v-model="NgayGiaoViec" :disabled="!isNgayGV"/>
                                        <span class="icon one-calendar"></span>

                                        <!-- <date-picker 
                                            input-class="form-control" 
                                            type="datetime" 
                                            :format="datetimeFormat" 
                                            :value-type="'format'"
                                            :disabled="!isNgayGV"
                                            v-model="NgayGiaoViec">
                                        </date-picker> -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6 col-12">
                            <div class="info-row">
                                <div class="key w80">Ngày HT</div>
                                <div class="value padt7 w20">
                                    <div class="check-action">
                                        <input type="checkbox" class="check" v-model="ngayht">
                                        <span class="name"></span>
                                    </div>
                                </div>
                                <div class="value">
                                    <div class="input-icon-right">
                                        <flat-pickr class="form-control" :config="dateconfig" v-model="NgayHoanThanh" :disabled="!isNgayHT"/>
                                        <span class="icon one-calendar"></span>

                                        <!-- <date-picker 
                                            input-class="form-control" 
                                            type="datetime" 
                                            :format="datetimeFormat" 
                                            :value-type="'format'"
                                            :disabled="!isNgayGV"
                                            v-model="NgayGiaoViec">
                                        </date-picker> -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key w100">Người GV</div>
                    
                        <div class="value">
                            <div class="select-custom">
                                <SelectExt ref="" dataTextField="ten_nv" dataValueField="nhanvien_id"
                                    :dataSource="listbox.DSNguoiGiaoViec.DataSource" v-model="NguoiGiaoViec"> 
                                 </SelectExt>
                            </div>
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key w100">Nhân viên YC</div>
                        <div class="value">
                            <input type="text" class="form-control" v-model="NhanVienYeuCau">
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key w100">Nội dung giao</div>
                        <div class="value">
                            <input type="text" class="form-control" v-model="NoiDungGiao">
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key w100">Nội dung TH</div>
                        <div class="value">
                            <div class="input-more-button">
                                <button class="btn" @click="updateTHClick">
                                    <span class="nc-icon-glyph ui-1_edit-76 f16"></span>
                                </button>
                                <input type="text" class="form-control " v-model="NoiDungThucHien">
                            </div>
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="key w100">Ghi chú</div>
                        <div class="value">
                            <textarea name="" class="form-control" style="height: 66px;resize: none;" id="" cols="30" rows="10" v-model="GhiChu"></textarea>
                        </div>
                    </div>
                    <div class="legend-title mart20">Danh sách nhân viên thực hiện</div>
                    <div class="table-content" style="height: 140px;">
                        <DataGrid :columns="DSNhanVienThucHien.header" ref="DSNhanVienThucHien" :dataSource="DSNhanVienThucHien.DataSource" :enable-paging-server="false"
                        :allowPaging="false" :showFilter="false">
                        </DataGrid>
                    </div>
                </div>
                
            </div>
            
        </div>
        <div class="box-form">
            <div class="legend-title">Danh sách hợp đồng</div>
            <div class="table-content">
                <DataGrid :columns="DSHopDong.header" ref="DSHopDong" :dataSource="DSHopDong.DataSource" :enable-paging-server="false"
                :allowPaging="false" :showFilter="false" @selectedRowChanged="ListDataFocus">
                </DataGrid>
            </div>
        </div>
    </div>
    <footer class="footer">
        VNPT-IT &copy; 2021
    </footer>
    <ejs-dialog :enableResize='true' :visible="false" ref="giaoPhieuNhanVien" :header='"Giao phiếu nhân viên"' showCloseIcon=true :target="target" width='60%' height="800">
        <GiaoPhieuNhanVien @giaoviec_success="giaoviec_success" ref="formgiaphieu" :phieu_id="modelGiaoViec.phieu_id" :nguoigv_id="modelGiaoViec.nguoigv_id" :ngaygiao="modelGiaoViec.ngaygiao" :ma_tb="modelGiaoViec.ma_tb" :hdtb_id="modelGiaoViec.hdtb_id" :huonggiao_id="modelGiaoViec.huonggiao_id"/>
    </ejs-dialog>
</div>