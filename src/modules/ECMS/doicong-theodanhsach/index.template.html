<div>
  <div class="list-actions-top">
    <ul class="list">
      <li>
        <a href="javascript:void(0)" @click="layThongTin">
          <span class="icon one-file-attach"></span> Lấy TT
        </a>
      </li>
      <li :hidden="activetab != 1">
        <a href="javascript:void(0)" @click="nhapMoiAction"  :class="{'disabled': !isDisableBtnWhenEmpty}">
          <span class="icon  one-file-plus"></span> Nhập mới
        </a>
      </li>
      <li :hidden="activetab != 1">
        <a href="javascript:void(0)" @click="capNhatAction">
          <span class="icon one-reload1"></span>Cập nhật
        </a>
      </li>
      <li :hidden="activetab != 1">
        <a href="javascript:void(0)" @click="huybo">
          <span class="icon nc-icon-glyph ui-1_circle-remove"></span>Hủy bỏ
        </a>
      </li>
      <li :hidden="activetab != 1">
        <a href="javascript:void(0)" @click="xoaPhieu"  :class="{'disabled': !isDisableBtnWhenEmpty}">
          <span class="icon one-file-trash"></span>Xóa phiếu
        </a>
      </li>
      <li :hidden="activetab != 2">
        <a href="javascript:void(0)" @click="xoaDSHS">
          <span class="icon one-trash"></span>Xóa DS
        </a>
      </li>
      <li :hidden="activetab != 2 || !isVisibleVCIVPI">
        <a href="javascript:void(0)" @click="giuVciVpi">
          <span class="icon one-vci"></span>Giữ Vci Vpi
        </a>
      </li>
      <li :hidden="activetab != 3">
        <a href="javascript:void(0)" @click="ganCong()">
          <span class="icon  one-hoancong"></span>Gán cổng
        </a>
      </li>
      <li :hidden="activetab != 3">
        <a href="javascript:void(0)" @click="goCong()">
          <span class="icon nc-icon-glyph ui-1_circle-remove"></span>Gỡ cổng
        </a>
      </li>
      <li :hidden="activetab != 2">
        <a href="javascript:void(0)" @click="linkTaiFileMau_Click">
          <span class="icon one-template"></span>Tải file mẫu
        </a>
      </li>
      <li :hidden="activetab != 2">
        <b-form-file  id="fileUpload" ref="fileUpload" @change="this.onChange" accept=".xls, .xlsx" class="-ap icon-more_horiz" v-show="arrayImportFile.ok"></b-form-file>
        <a @click="this.chooseFiles" title="File excel MA_TB hoặc MA_LT">
          <span class="icon one-excel"></span> Nhập từ excel
        </a>
      </li>

      <li :hidden="activetab == 1">
        <a href="javascript:void(0)"  @click="xuatExcel()">
          <span class="icon one-xlsx-import"></span>Xuất Excel
          <!-- <download-excel :data="arrayDataGrids.dataExport" >
            <span class="icon one-xlsx"></span>Xuất Excel
          </download-excel> -->
        </a>
      </li>
      <download-excel :data="dataExcelEx" id="exportexcel"  style="display: none;">
        <span class="icon one-xlsx"></span>Xuất Excel
      </download-excel>
      <download-excel :data="errExcel.dataEx" id="exporterror"  style="display: none;">
        <span class="icon one-xlsx"></span>Xuất Excel
      </download-excel>
      <li :hidden="activetab != 3">
        <a href="javascript:void(0)" @click="xuatVisa()">
          <download-excel :data="arrayDataExcelExport.dataVisa" >
            <span class="icon one-file-visa"></span>File Visa
          </download-excel>
        </a>
      </li>
      <li :hidden="activetab != 3">
        <a href="javascript:void(0)" @click="xuatVisaCu()">
          <span class="icon one-file-visa"></span>File Visa cũ
          <!-- <download-excel :data="arrayDataExcelExport.dataVisaCu" >
            <span class="icon one-file-visa"></span>File Visa cũ
          </download-excel> -->
        </a>
      </li>
      <li :hidden="activetab != 3">
        <a href="javascript:void(0)" @click="kichHoat()">
          <span class="icon one-file-arrow-up"></span>Kích hoạt
        </a>
      </li>
      <li :hidden="activetab != 3">
        <a href="javascript:void(0)" @click="guiCauHinh()">
          <span class="icon one-clipart-arrow-right"></span>Gửi cấu hình
        </a>
      </li>
      <li :hidden="activetab != 3">
        <a href="javascript:void(0)" @click="huyCongCu()">
          <span class="icon one-remove-outline"></span>Hủy cổng cũ
        </a>
      </li>
      <li :hidden="activetab != 3">
        <a href="javascript:void(0)" @click="hoanThien()">
          <span class="icon one-file-check"></span>Hoàn thiện
        </a>
      </li>
      <li :hidden="activetab != 3">
        <a href="#/ecms/doicong-theodanhsach" @click="dongHoSo()">
          <span class="icon one-file-lock"></span>Đóng hồ sơ
        </a>
      </li>
    </ul>
    <div class="more dropdown">
      <a href="javascript:void(0)" data-toggle="dropdown">
        <span class="icon -ap  icon-dots-three-vertical"></span>
      </a>
      <ul class="dropdown-menu">
        <li>
          <a href="javascript:void(0)">
            <span class="dropdown-icon one-phone-remove"></span> Xóa TT
          </a>
        </li>
        <li>
          <a href="javascript:void(0)">
            <span class="dropdown-icon nc-icon-glyph business_contacts"></span> Liên hệ
          </a>
        </li>
        <li>
          <a href="javascript:void(0)">
            <span class="dropdown-icon nc-icon-glyph ui-1_email-83"></span> Email
          </a>
        </li>
      </ul>
    </div>
  </div>
  <div class="page-content">
    <div class="legend-title">
    <span class="icon fa fa-angle-up" @click="tonggle_div" v-show="div_search"></span>
    <span class="icon fa fa-angle-down" @click="tonggle_div" v-show="!div_search"></span>
      Tiêu chí tìm kiếm
    </div>
    <div class="box-form" v-show="div_search">
      <div class="row">
        <div class="col-sm-4 col-12">
          <div class="info-row">
            <div class="key w90">
              Trạng thái HS
            </div>
            <div class="value">
              <div class="select-custom">
                <select name="" class="form-control" v-model="arrayCBO.cboTTHS">
                  <option v-for="ttct in arrayDataToCbo.dsTTCC" :value="ttct.TTCC_ID">{{ttct.TRANGTHAI_CC}}</option>
                </select>
              </div>
            </div>
          </div>
        </div>
        <div class="col-sm-4 col-12">
          <div class="info-row">
            <div class="key w90">
              Số máy/ACC
            </div>
            <div class="value">
              <div class="input-icon-right">
                <input type="text" class="form-control highlight" v-model="arrayInputTab1.soMayAcc" @keyup.enter="txtMaTB_KeyPress">
                <span class="icon one-search"></span>
              </div>
            </div>
          </div>
        </div>
        <div class="col-sm-2 col-12">
          <div class="info-row">
            <div class="key w70">
              Từ ngày <span style="color: red">*</span>
            </div>
            <div class="value">
              <div class="input-icon-right">
                <bss-error-marker :has-error="$v.arrayDate.fromDate.$error">
                  <ejs-datepicker
                      v-model="$v.arrayDate.fromDate.$model"
                      :format="arrayDate.dateFormat"
                      :value="arrayDate.fromDate"
                  ></ejs-datepicker>
                </bss-error-marker>
              </div>
            </div>
          </div>
        </div>
        <div class="col-sm-2 col-12">
          <div class="info-row">
            <div class="key w70">
              Đến ngày <span style="color: red">*</span>
            </div>
            <div class="value">
              <div class="input-icon-right">
                <bss-error-marker :has-error="$v.arrayDate.toDate.$error">
                  <ejs-datepicker
                      v-model="$v.arrayDate.toDate.$model"
                      :format="arrayDate.dateFormat"
                      :value="arrayDate.toDate"
                  ></ejs-datepicker>
                </bss-error-marker>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="nav tabs tab-over">
      <a href="#tabB1" data-toggle="tab" id="tabB1" v-if="isVisiblexTabHoSo" @click="onclickTab(1)" :class="[ activetab == 1 ? 'active' : '' ]">B1. Lập hồ sơ cắt chuyển</a>
      <a href="#tabB2" data-toggle="tab" id="tabB2" @click="onclickTab(2)" :class="[ activetab == 2 ? 'active' : '' ]">B2. Lập danh sách cắt chuyển cổng</a>
      <a href="#tabB3" data-toggle="tab" id="tabB3" @click="onclickTab(3)" :class="[ activetab == 3 ? 'active' : '' ]">B3. Cấp cổng cho số máy/account</a>
    </div>
    <div class="tab-content box-form">
      <div :class="[ activetab == 1 ? 'active' : '' ]" id="tabB1" v-show="activetab == 1">
        <div class="row">
          <div class="col-sm-6 col-12">
            <div class="info-row">

              <div class="key w80">
                Tên hồ sơ <span style="color: red">*</span>
              </div>
              <div class="value">
                <bss-error-marker :has-error="$v.arrayInputTab1.tenHoSo.$error">
                  <input type="text" class="form-control" v-model="$v.arrayInputTab1.tenHoSo.$model" ref = 'tenHoSo'>
                </bss-error-marker>
              </div>
            </div>
          </div>
          <div class="col-sm-3 col-12">
            <div class="info-row">
              <div class="key w90">
                Trạng thái <span style="color: red">*</span>
              </div>
              <div class="value">
                <bss-error-marker :has-error="$v.arrayCBO.cboTrangThai.$error">
                  <div class="select-custom" ref="cboTT">
                    <SelectExt
                          v-model.trim="$v.arrayCBO.cboTrangThai.$model"
                          :settings="{dropdownParent: $refs['cboTT']}"
                          :dataSource="arrayDataToCbo.dsTTCCIn"
                          dataTextField="TRANGTHAI_CC"
                          :disabled="buttonState.isDisableCboTT"
                          dataValueField="TTCC_ID"/>
                  </div>
                </bss-error-marker>
              </div>
            </div>
          </div>
          <div class="col-sm-3 col-12">
            <div class="info-row">
              <div class="key w100">
                Ngày bắt đầu <span style="color: red">*</span>
              </div>
              <div class="value">
                <div class="input-icon-right">
                    <ejs-datepicker
                      v-model="$v.arrayDate.startDate.$model"
                      :format="arrayDate.dateFormat"
                      :value="arrayDate.startDate"
                    ></ejs-datepicker>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-3 col-12">
            <div class="info-row">
              <div class="key w80">
                Loại hồ sơ <span style="color: red">*</span>
              </div>
              <div class="value">
                <bss-error-marker :has-error="$v.arrayCBO.cboHoSo.$error">
                  <div class="select-custom" ref="cboLoaiHS">
                    <SelectExt
                          v-model.trim="arrayCBO.cboHoSo"
                          :settings="{dropdownParent: $refs['cboLoaiHS']}"
                          :dataSource="arrayDataToCbo.dsHoSoCC"
                          dataTextField="LOAI_HS_CC"
                          :disabled="buttonState.isDisableCbo"
                          dataValueField="LOAIHSCC_ID"/>
                  </div>
                </bss-error-marker>
              </div>
            </div>
          </div>
          <div class="col-sm-3 col-12">
            <div class="info-row">
              <div class="key w80">
                Hình thức <span style="color: red">*</span>
              </div>
              <div class="value">
                <bss-error-marker :has-error="$v.arrayCBO.cboKieuCC.$error">
                  <div class="select-custom" ref="cboKieuCC">
                    <SelectExt
                          v-model.trim="arrayCBO.cboKieuCC"
                          :settings="{dropdownParent: $refs['cboKieuCC']}"
                          :dataSource="arrayDataToCbo.dsKieuCC"
                          dataTextField="TEN_KIEU"
                          :disabled="buttonState.isDisableCbo"
                          dataValueField="KIEUCC_ID"/>
                  </div>
                </bss-error-marker>
              </div>
            </div>
          </div>
          <div class="col-sm-3 col-12">
            <div class="check-action mart5">
              <input type="checkbox" class="check" v-model="arrayInputTab1.chkChuyen119" :disabled="buttonState.isDisableCbo">
              <span class="name">Chuyển 119</span>
            </div>
          </div>
          <div class="col-sm-3 col-12">
            <div class="info-row">
              <div class="key w100">
                Ngày kết thúc <span style="color: red">*</span>
              </div>
              <div class="value">
                <div class="input-icon-right">
                  <ejs-datepicker
                    v-model="arrayDate.endDate"
                    :format="arrayDate.dateFormat"
                    :value="arrayDate.endDate"
                  ></ejs-datepicker>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="info-row">
          <div class="key w80">
            Ghi chú
          </div>
          <bss-error-marker :has-error="$v.arrayInputTab1.ghiChu.$error">
            <input type="text" class="form-control" v-model="$v.arrayInputTab1.ghiChu.$model">
          </bss-error-marker>
        </div>
        <div class="legend-title">Danh sách hồ sơ</div>
        <div class="table-content" v-show="arrayDataGrids.dsHoSoTab1">
          <DataGrid v-bind:columns="[
            {fieldName: 'STT', headerText: 'Stt', width:58, allowFiltering: false},
            {fieldName: 'TEN_HS', headerText: 'Tên hồ sơ', allowFiltering: true, allowSorting: false, cssClass: 'text-success'},
            {fieldName: 'LOAI_HS_CC', headerText: 'Loại hồ sơ', allowFiltering: true, allowSorting: false},
            {fieldName: 'TEN_KIEU', headerText: 'Kiểu cắt chuyển', allowFiltering: true, allowSorting: false},
            {fieldName: 'TRANGTHAI_CC', headerText: 'Trạng thái cắt chuyển', allowFiltering: true, allowSorting: false},
            {fieldName: 'NGAY_YC', headerText: 'Ngày yêu cầu', allowFiltering: true, allowSorting: false},
            {fieldName: 'NGAYBD_DK', headerText: 'Ngày bắt đầu', allowFiltering: true, allowSorting: false},
            {fieldName: 'NGAYKT_DK', headerText: 'Ngày KT dự kiến', allowFiltering: true, allowSorting: false},
            {fieldName: 'SO_TB_DK', headerText: 'Số thuê bao cắt chuyển', allowFiltering: true, allowSorting: false},
            {fieldName: 'MA_ND', headerText: 'Người lập', allowFiltering: true, allowSorting: false, cssClass: 'text-danger'},
            ]"
              v-bind:dataSource="arrayDataGrids.dsHoSoTab1"
              :showFilter="true"
              :allowPaging = true
              :enablePagingServer = false
              @selectedRowChanged="onClickdsHoSoTab1">

          </DataGrid>
        </div>
      </div>
      <div :class="[ activetab == 2 ? 'active' : '' ]" id="tabB2" v-show="activetab == 2">
        <div class="legend-title">Danh sách thuê bao cắt chuyển</div>
        <div class="info-row">
          <div class="key w80 nowrap">
            Hồ sơ cắt chuyển
          </div>
          <div class="value">
            <div class="select-custom">

              <ComboboxGrid ref="cboHSTab2" v-bind:columns="[
                      {fieldName: 'TEN_HS', headerText: 'Tên hồ sơ', allowFiltering: true},
                      {fieldName: 'LOAI_HS_CC', headerText: 'Loại hồ sơ', allowFiltering: true},
                      {fieldName: 'TEN_KIEU', headerText: 'Kiểu hồ sơ', allowFiltering: true},
                      ]" v-bind:dataSource="arrayDataToCbo.dsHoSoCCTab2" textField="TEN_HS" valueField="HSCC_ID"
                            :enabledSelectFirstRow="false"
                            @selectedChanged="cbb_selectedChanged">
              </ComboboxGrid>


            </div>
          </div>
          <div class="value w60 nowrap">
            <div class="check-action mart5">
              <input type="checkbox" class="check" v-model="arrayInputTab1.chkCungDoiCap">
              <span class="name">Lấy kèm các mã cùng đôi cáp</span>
            </div>
          </div>
        </div>
        <DataGrid v-bind:columns="[
            {fieldName: 'STT', headerText: 'Stt', width:58, allowFiltering: false},
            {fieldName: 'SLOT', headerText: 'Slot', allowFiltering: true, allowSorting: false, width: 70},
            {fieldName: 'PORT', headerText: 'Port', allowFiltering: true, allowSorting: false, width: 70},
            {fieldName: 'ONT_ID', headerText: 'Ont ID', allowFiltering: true, allowSorting: false, width: 70},
            {fieldName: 'VPI', headerText: 'Vpi', allowFiltering: true, allowSorting: false, width: 70},
            {fieldName: 'VCI', headerText: 'Vci', allowFiltering: true, allowSorting: false, width: 70},
            {fieldName: 'MA_TB', headerText: 'Số máy/ACC', allowFiltering: true, allowSorting: false, cssClass: 'text-primary'},
            {fieldName: 'MA_LT', headerText: 'Mã LT', allowFiltering: true, allowSorting: false},
            {fieldName: 'MADOICAP', headerText: 'Mã đôi cáp', allowFiltering: true, allowSorting: false, width: 110},
            {fieldName: 'DICHVU_VT', headerText: 'Dịch vụ', allowFiltering: true, allowSorting: false, cssClass: 'text-danger'},
            {fieldName: 'LOAIHINH_TB', headerText: 'Loại hình', allowFiltering: true, allowSorting: false, cssClass: 'text-success'},
            {fieldName: 'TOCDO', headerText: 'Gói cước', allowFiltering: true, allowSorting: false},
            {fieldName: 'TEN_TB', headerText: 'Tên thuê bao', allowFiltering: true, allowSorting: false},
            {fieldName: 'DIACHI_LD', headerText: 'Địa chỉ lắp đặt', allowFiltering: true, allowSorting: false},
            {fieldName: 'HOLD_VCI_VPI', headerText: 'Giữ VciVpi', allowFiltering: true, allowSorting: false, allowHtml: true, width: 110, freeze:'right', cssClass: 'text-success'},
            {fieldName: 'TRANGTHAI_TB', headerText: 'Trạng thái', allowFiltering: true, allowSorting: false, freeze:'right', cssClass: 'text-danger'},
            ]"
                  v-bind:dataSource="arrayDataGrids.dsHoSoTab2"
                  dataKeyField="MA_TB"
                  :showFilter="true"
                  :showColumnCheckbox="true"
                  :enabledSelectFirstRow="false"
                  :allowPaging = true
                  :enablePagingServer = false
                  :defaultColumnCheckboxChecked ="true"
                  @selectedItemsChanged="selectedItemsTab2">

        </DataGrid>
      </div>
      <div :class="[ activetab == 3 ? 'active' : '' ]" id="tabB3" v-show="activetab == 3">
        <div class="grid-stack-box">
          <Split style="calc(100vh - 300px);" :gutterSize="16">
            <SplitArea :size="45" :minSize="500">
              <div class="box-col box-form" id="boxLeft">
                <div class="legend-title">Danh sách thuê bao cắt chuyển</div>
                <div class="row">
                  <div class="col-sm-6 col-12">
                    <div class="info-row">
                      <div class="key">Hồ sơ cắt chuyển</div>
                      <div class="value">
                        <div class="select-custom">
                          <ComboboxGrid ref="cboHSTab3" v-bind:columns="[
                          {fieldName: 'TEN_HS', headerText: 'Tên hồ sơ', allowFiltering: true},
                          {fieldName: 'LOAI_HS_CC', headerText: 'Loại hồ sơ', allowFiltering: true},
                          {fieldName: 'TEN_KIEU', headerText: 'Kiểu hồ sơ', allowFiltering: true},
                          ]" v-bind:dataSource="arrayDataToCbo.dsHoSoCCTab3" textField="TEN_HS" valueField="HSCC_ID"
                                :enabledSelectFirstRow="false"
                                @selectedChanged="changeHSCCTab3">
                     </ComboboxGrid>
                          <!-- <select name="" id="" class="form-control" v-model="arrayCBO.cboHoSoTab3" @change="changeHSCCTab3()">
                            <option v-for="ttct in arrayDataToCbo.dsHoSoCCTab3" :value="ttct.HSCC_ID">{{ttct.TEN_HS}}</option>
                          </select> -->
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-sm-6 col-12">
                    <div class="info-row">
                      <div class="key text-main fw6" style="width: 160px;">Số ACC chọn: {{arraySelectedItem.soChonAcc}}</div>
                      <div class="value">
                        <div class="check-action mart5">
                          <input type="checkbox" class="check" v-model="arrayInputTab3.ckbAuto_BNM">
                          <span class="name">Tự động cấu hình</span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-sm-6 col-12">
                    <div class="info-row">
                      <div class="key">Trạng thái</div>
                      <div class="value">
                        <div class="select-custom">
                          <select name="" id="6" class="form-control" disabled="disabled">
                            <option value="">[Chưa chọn giá trị]</option>
                          </select>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-sm-6 col-12">
                    <div class="info-row">
                      <div class="key  text-main fw6" style="width: 160px;">Số port: <span class="text-success">  {{arraySelectedItem.soPort}}</span> - Số VciVpi: <span class="text-success"> {{arraySelectedItem.soVciVpi}}</span></div>
                      <div class="value">
                        <div class="check-action mart5">
                          <input type="checkbox" class="check" v-model="arrayInputTab3.ckbAuto_KH">
                          <span class="name">Tự động kích hoạt</span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="table-content xo marb0">
                  <DataGrid
                    ref="grid-hoso-tab3"
                    v-bind:columns="[
                      {fieldName: 'STT', headerText: 'Stt', width:58, freeze:'left', allowFiltering: false},
                      {fieldName: 'MA_TB', headerText: 'Số máy/ACC', allowFiltering: true, allowSorting: false, freeze:'left', width: 120, cssClass: 'text-primary'},
                      {fieldName: 'MA_LT', headerText: 'Mã LT', allowFiltering: true, allowSorting: false, freeze:'left', width: 110},
                      {fieldName: 'DSLAM_CU', headerText: 'Dslam cũ', allowFiltering: true, allowSorting: false, width: 140},
                      {fieldName: 'PORT_CU', headerText: 'Port cũ', allowFiltering: true, allowSorting: false, width: 90},
                      {fieldName: 'ONT_ID_CU', headerText: 'Ont ID cũ', allowFiltering: true, allowSorting: false, width: 90},
                      {fieldName: 'VPI_VCI_CU', headerText: 'Vpi - Vci cũ', allowFiltering: true, allowSorting: false, width: 90},
                      {fieldName: 'DSLAM', headerText: 'Dslam mới', allowFiltering: true, allowSorting: false, width: 90, cssClass: 'text-danger'},
                      {fieldName: 'PORT_MOI', headerText: 'Port mới', allowFiltering: true, allowSorting: false, width: 90, cssClass: 'text-danger'},
                      {fieldName: 'ONT_ID_MOI', headerText: 'Ont ID mới', allowFiltering: true, allowSorting: false, width: 90, cssClass: 'text-danger'},
                      {fieldName: 'VPI_VCI_MOI', headerText: 'Vpi - Vci mới', allowFiltering: true, allowSorting: false, width: 90, cssClass: 'text-danger'},
                      {fieldName: 'MADOICAP', headerText: 'Mã đôi cáp', allowFiltering: true, allowSorting: false, width: 120},
                      {fieldName: 'LOAIHINH_TB', headerText: 'Dịch vụ', allowFiltering: true, allowSorting: false, width: 120},
                      {fieldName: 'NGAY_KH', headerText: 'Ngày KH', allowFiltering: true, allowSorting: false, width: 120},
                      {fieldName: 'NGAY_CH', headerText: 'Ngày CH', allowFiltering: true, allowSorting: false, width: 120},
                      {fieldName: 'TRANGTHAI_TB', headerText: 'Trạng thái TB', allowFiltering: true, allowSorting: false},
                      {fieldName: 'LOG_KH', headerText: 'Log KH', allowFiltering: true, allowSorting: false},
                      {fieldName: 'TEMP_KH', headerText: 'Temp KH', allowFiltering: true, allowSorting: false},
                      {fieldName: 'TOCDO', headerText: 'Gói cước', allowFiltering: true, allowSorting: false},
                      {fieldName: 'TEN_TB', headerText: 'Tên thuê bao', allowFiltering: true, allowSorting: false},
                      {fieldName: 'DIACHI_LD', headerText: 'Địa chỉ lắp đặt', allowFiltering: true, allowSorting: false},
                      {fieldName: 'TRANGTHAI_KH_ID', headerText: 'Cấu hình', allowFiltering: true, allowSorting: false, width: 90,textAlign: 'center', freeze:'right',cellCreatedEventEnabled: true},
                      {fieldName: 'TRANGTHAI_CC', headerText: 'Trạng thái cổng', allowFiltering: true, allowSorting: false,  freeze:'right', width: 120, cssClass: 'text-success'}

                      ]"
                            v-bind:dataSource="arrayDataGrids.dsHoSoTab3"
                            dataKeyField="DKCC_ID"
                            panelDataHeight="350px"
                            :showFilter="true"
                            :showColumnCheckbox="true"
                            :allowPaging = "true"
                            :enablePagingServer = "false"
                            :enabledSelectFirstRow="false"
                            @selectedItemsChanged="selectedItemsHso"
                            @queryCellInfo="onQueryCellInfodsHoSoTab3">

                  </DataGrid>

                </div>
              </div>
            </SplitArea>
            <SplitArea :size="55" :minSize="500">
              <div class="box-col box-form" id="boxRight">
                <div class="legend-title">Danh sách cổng</div>
                <div class="row">
                  <div class="col-sm-5 col-12">
                    <div class="info-row">
                      <div class="key w110">Trạm thiết bị</div>
                      <div class="value">
                        <div class="select-custom">
                          <SelectExt v-model="arrayCBO.cboTramTBTab3" :dataSource="arrayDataToCbo.dsTramTBTab3" dataTextField="TEN_DV"
                                            dataValueField="DONVI_ID" @change="changeTramTbi()"/>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-sm-7 col-12">
                    <div class="info-row">
                      <div class="key w60">Dslam</div>
                      <div class="value">
                        <div class="select-custom">
                          <ComboboxGrid ref="cap-goc1" v-bind:columns="[
                            {fieldName: 'TENDSLAM', headerText: 'Tên Dslam', allowFiltering: true, width: 150},
                            {fieldName: 'LOAI_TBI', headerText: 'Loại thiết bị', allowFiltering: true, width: 70},
                            {fieldName: 'PORTTD', headerText: 'Loại Port', allowFiltering: true, width: 70},
                            ]"
                            v-bind:dataSource="arrayDataToCbo.dsDslamTab3"
                            textField="TENDSLAM"
                            valueField="DSLAM_ID"
                            @selectedChanged="cbbDslam_selectedChanged"
                            >
                          </ComboboxGrid>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-sm-5 col-12">
                    <div class="info-row">
                      <div class="key w110">Kiểu quy hoạch</div>
                      <div class="value">
                        <div class="select-custom">
                          <select name="" id="9" class="form-control" v-model="arrayCBO.cboKieuQuyhoachTab3" @change="changeCboKieuQH()" :disabled="!enableSelectFollowPortTD">
                            <option v-for="ttct in arrayDataToCbo.dsKieuQuyhoachTab3" :value="ttct.QUYHOACH_ID">{{ttct.QUYHOACH}}</option>
                          </select>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-sm-7 col-12">
                    <div class="info-row">
                      <div class="key w60">Loại QH</div>
                      <div class="value">
                        <div class="select-custom">
                          <select name="" id="10" class="form-control" v-model="arrayCBO.cboLoaiQuyhoachTab3" @change="changeCboLoaiQH()" :disabled="!enableSelectFollowPortTD">
                            <option v-for="ttct in arrayDataToCbo.dsLoaiQuyhoachTab3" :value="ttct.LOAIKN_ID">{{ttct.KETNOI}}</option>
                          </select>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="grid-stack-box" v-show="visibleGridTab3" >
                  <Split style="calc(100vh - 400px);" :gutterSize="16" v-if="!sPort_TD">
                      <SplitArea :size="45" :minSize="150" style="width:50%;float:left">
                        <div class="box-col" id="boxLeft1" >
                          <div class="legend-title">
                            <button class="btn btn-primary" style="padding: 0px 6px;font-size: 13px;" @click="addRowPort(arraySelectedItem.soChonAcc)">
                              <span class="-ap icon-plus2" style="color: white; margin: 0px;"></span>
                            </button>
                            <div class="pull-left mart10 padl5">Danh sách Port</div>
                          </div>
                          <div class="table-content">
                            <DataGrid ref = 'grid-port-tab3' v-bind:columns="[
                                  {fieldName: 'STT', headerText: 'Stt', width:42, allowFiltering: false},
                                  {fieldName: 'SLP', headerText: 'Port', allowFiltering: true,width: 60, allowSorting: false},
                                  {fieldName: 'ONT_ID', headerText: 'Ont ID', allowFiltering: true,width: 60, allowSorting: false},
                                  ]"
                                    v-bind:dataSource="arrayDataGrids.dsLuoiPortTab3"
                                    dataKeyField="PORTVL_ID"
                                    panelDataHeight="350px"
                                    :showFilter="true"
                                    :allowPaging = "true"
                                    :enablePagingServer = "false"
                                    :pageSize ="100"
                                    :showColumnCheckbox="true"
                                    :enabledSelectFirstRow="false"
                                    @selectedItemsChanged="selectedItemsPort">
                          </DataGrid>
                          </div>
                      </div>
                      </SplitArea>
                      <SplitArea :size="55" :minSize="150" style="width:50% ;float:right">
                        <div class="box-col" id="boxRight1">
                          <div class="clearfix"></div>
                          <div class="legend-title">
                            <button class="btn btn-primary" style="padding: 0px 6px;font-size: 13px;" @click="addRowVci(arraySelectedItem.soChonAcc)">
                              <span class="-ap icon-plus2" style="color: white; margin: 0px;"></span>
                            </button>
                            <div class="pull-left mart10 padl5">Danh sách vci vpi</div>
                            <div class="pull-right select2vpi">
                              <div class="select-custom">
                                <select name="" id="11" class="form-control" v-model="arrayCBO.cboTrangthaiVCIVPITab3" @change="changeCboTrangthaiVCIVPI()">
                                  <option v-for="ttct in arrayDataToCbo.dsTTVciVpiTab3" :value="ttct.TT_PORT_ID">{{ttct.TRANGTHAI_PORT}}</option>
                                </select>
                              </div>
                            </div>
                            <div class="clearfix"></div>
                          </div>
                          <div class="table-content">
                            <DataGrid ref = 'grid-vcivpi-tab3' v-bind:columns="[
                                {fieldName: 'STT', headerText: 'Stt', width:55, allowFiltering: false},
                                {fieldName: 'VPI', headerText: 'Vpi/Svlan', allowFiltering: true, allowSorting: false, width: 70, cssClass: 'text-danger'},
                                {fieldName: 'VCI', headerText: 'Vci/Cvlan', allowFiltering: true, allowSorting: false, width: 70, cssClass: 'text-success'},
                                {fieldName: 'TRANGTHAI', headerText: 'Trạng thái', allowFiltering: true, allowSorting: false, width: 130}
                                ]"
                                      v-bind:dataSource="arrayDataGrids.dsVCIVPITab3"
                                      dataKeyField="PORTVL_ID"
                                      panelDataHeight="350px"
                                      :showFilter="true"
                                      :showColumnCheckbox="true"
                                      :allowPaging = "true"
                                      :enablePagingServer = "false"
                                      :pageSize ="100"
                                      :enabledSelectFirstRow="false"
                                      @selectedItemsChanged="selectedItemsVCI">

                            </DataGrid>
                          </div>
                        </div>
                      </SplitArea>
                  </Split>
                  <Split style="calc(100vh - 400px);" :gutterSize="16" v-else>
                        <div class="box-col" id="boxLeft1">
                          <div class="legend-title mart23">Danh sách Port</div>
                          <div class="table-content">
                            <DataGrid v-bind:columns="[
                                    {fieldName: 'STT', headerText: 'Stt', width:58, allowFiltering: false},
                                    {fieldName: 'TEN_CARD', headerText: 'Card', allowFiltering: true, allowSorting: false, width: 70},
                                    {fieldName: 'VITRI', headerText: 'Vị trí port', allowFiltering: true, allowSorting: false, width: 100},
                                    {fieldName: 'SLOT', headerText: 'Slot', allowFiltering: true, allowSorting: false, width: 80},
                                    {fieldName: 'PORT', headerText: 'Port', allowFiltering: true, allowSorting: false, width: 80},
                                    {fieldName: 'VPI', headerText: 'Vpi/Svlan', allowFiltering: true, allowSorting: false, width: 100},
                                    {fieldName: 'VCI', headerText: 'Vci/Cvlan', allowFiltering: true, allowSorting: false, width: 100},
                                    {fieldName: 'RACK', headerText: 'Rack', allowFiltering: true, allowSorting: false, width: 80},
                                    {fieldName: 'SHELF', headerText: 'Shelf', allowFiltering: true, allowSorting: false, width: 80},
                                    {fieldName: 'SELFID01', headerText: 'SeftID', allowFiltering: true, allowSorting: false, width: 80},
                                    {fieldName: 'SELFID02', headerText: 'OLT Slot', allowFiltering: true, allowSorting: false, width: 100},
                                    {fieldName: 'SELFID03', headerText: 'OLT Port', allowFiltering: true, allowSorting: false, width: 100},
                                    {fieldName: 'SELFID04', headerText: 'ONU ID', allowFiltering: true, allowSorting: false, width: 100},
                                    {fieldName: 'ADSL_PORT', headerText: 'ADSL Port', allowFiltering: true, allowSorting: false, width: 100},
                                    {fieldName: 'ONT_ID', headerText: 'ONT ID', allowFiltering: true, allowSorting: false, width: 100},
                                    {fieldName: 'PORT_MDF', headerText: 'Port MDF', allowFiltering: true, allowSorting: false, width: 100},
                                    {fieldName: 'TRANGTHAI_PORT', headerText: 'Trạng thái', allowFiltering: true, allowSorting: false, cssClass: 'text-danger' },
                                    {fieldName: 'TB_CUNGPORT', headerText: 'TB cùng Port', allowFiltering: true, allowSorting: false, width: 100},
                                    {fieldName: 'DS_MA_TB', headerText: 'DS Thuê bao', allowFiltering: true, allowSorting: false, width: 100},
                                    {fieldName: 'ONU_PASSWORD', headerText: 'Onu Pass', allowFiltering: true, allowSorting: false, width: 100},
                                    {fieldName: 'SYSTEM', headerText: 'System', allowFiltering: true, allowSorting: false, width: 100},
                                    {fieldName: 'PORT_ID', headerText: 'Port Logic ID', allowFiltering: true, allowSorting: false, width: 120},
                                    {fieldName: 'PORTVL_ID', headerText: 'Port Vật lý ID', allowFiltering: true, allowSorting: false, width: 120}
                                    ]"
                                      ref="ref-ds-port"
                                      v-bind:dataSource="arrayDataGrids.dsPortFixTab3"
                                      dataKeyField="PORT_ID"
                                      panelDataHeight="350px"
                                      :showFilter="true"
                                      :allowPaging = true
                                      :enablePagingServer = false
                                      :showColumnCheckbox="true"
                                      :enabledSelectFirstRow="false"
                                      @selectedItemsChanged="selectedItemsPortFix">
                            </DataGrid>
                          </div>
                      </div>
                  </Split>
                </div>
              </div>
            </SplitArea>
          </Split>
        </div>

      </div>
    </div>
  </div>
  <!-- Modal -->
  <b-modal v-model="arrayDataXoa.modalXoa" title="" size="sm" hide-footer>
    <span>Bạn có chắc muốn xóa hồ sơ này?</span>
    <div class="modal-footer">
      <button type="button" class="btn btn-secondary" data-dismiss="modal" @click="arrayDataXoa.modalXoa =! arrayDataXoa.modalXoa">Hủy</button>
      <button type="button" class="btn btn-primary" @click="xacNhanXoa">Đồng ý</button>
    </div>
  </b-modal>
  <b-modal id="modal-xacnhan-themds" title="Thêm danh sách từ file Excel" ok-only @ok="okThemDS">
    <div>Bạn có muốn thêm danh sách thuê bao vào hồ sơ không?</div>
    <template #modal-footer="{ ok, cancel }">
      <b-button variant="primary" style="color: white" @click="ok()">Xác nhận</b-button>
      <b-button variant="secondary" style="color: white" @click="cancel()">Hủy bỏ</b-button>
    </template>
  </b-modal>
</div>

