<div class="tracuu-splitter-theo-port-olt">
    <div class="list-actions-top">
        <ul class="list">
            <li>
                <a href="javascript:void(0)" @click="onClickButtonTraCuu">
                    <span class="icon one-file-search"></span> Tra cứu
                </a>
            </li>
            <li>
                <a href="javascript:void(0)" @click="onClickButtonXuatExcel">
                    <span class="icon one-xlsx"></span> Xuất Excel
                </a>
            </li>
        </ul>
    </div>
    <div class="page-content">
        <div class="box-form">
            <div class="legend-title">Tìm kiếm thông tin Splitter</div>
            <div class="row">
                <div class="col-sm-6 col-12">
                    <div class="info-row">
                        <div class="key w100">
                            <div class="check-action">
                                <input type="checkbox" class="check" :checked="true" :disabled="true">
                                <span class="name">TTVT <BssRequiredMarker/></span>
                            </div>
                        </div>
                        <div class="value">
                            <BssErrorMarker :has-error="$v.ttvtId.$error">
                                <ejs-dropdownlist 
                                    locale='vi-VN' 
                                    v-model="$v.ttvtId.$model"
                                    :dataSource='dsTtvt' 
                                    :allowFiltering='true' 
                                    :fields="{value:'DONVI_ID', text: 'TEN_DV'}" ></ejs-dropdownlist>
                            </BssErrorMarker>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6 col-12">
                    <div class="info-row">
                        <div class="key w100">
                            <div class="check-action">
                                <input type="checkbox" class="check" :checked="true" :disabled="true">
                                <span class="name">Tổ QL <BssRequiredMarker/></span>
                            </div>
                        </div>
                        <div class="value">
                            <BssErrorMarker :has-error="$v.toQlId.$error">
                                <ejs-dropdownlist 
                                    locale='vi-VN' 
                                    v-model="$v.toQlId.$model"
                                    :dataSource='dsToQl' 
                                    :allowFiltering='true' 
                                    :fields="{value:'DONVI_ID', text: 'TEN_DV'}" ></ejs-dropdownlist>
                            </BssErrorMarker>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-6 col-12">
                    <div class="info-row">
                        <div class="key w100">
                            <div class="check-action">
                                <input type="checkbox" class="check" v-model="chkVeTinhChecked">
                                <span class="name">Vệ tinh</span>
                            </div>
                        </div>
                        <div class="value">
                            <ejs-dropdownlist 
                                locale='vi-VN' 
                                v-model="veTinhId"
                                :dataSource='dsVeTinh' 
                                :allowFiltering='true' 
                                :fields="{value:'DONVI_ID', text: 'TEN_DV'}"
                                :enabled="chkVeTinhChecked"></ejs-dropdownlist>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6 col-12">
                    <div class="info-row">
                        <div class="key w100">
                            <div class="check-action">
                                <input type="checkbox" class="check" v-model="chkOltChecked">
                                <span class="name">Thiết bị OLT</span>
                            </div>
                        </div>
                        <div class="value">
                            <ejs-dropdownlist 
                                locale='vi-VN' 
                                v-model="oltId"
                                :dataSource='dsOlt' 
                                :allowFiltering='true' 
                                :fields="{value:'THIETBI_ID', text: 'TEN_TB'}"
                                :enabled="chkOltChecked"></ejs-dropdownlist>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-6 col-12">
                    <div class="info-row">
                        <div class="key w100">
                            <div class="check-action">
                                <input type="checkbox" class="check" v-model="chkCardOltChecked">
                                <span class="name">Card OLT</span>
                            </div>
                        </div>
                        <div class="value tracuu-splitter-theo-port-olt">
                            <treeselect
                                v-model="cardOltId"
                                :multiple="false"
                                :flat="true"
                                :options="dsCardOlt"
                                :searchable="false"
                                :disabled="!chkCardOltChecked"
                                :clearable="false"
                                noOptionsText="Không có dữ liệu"
                                placeholder="" />
                        </div>
                    </div>
                </div>
                <div class="col-sm-6 col-12">
                    <div class="info-row">
                        <div class="key w100">
                            <div class="check-action">
                                <input type="checkbox" class="check" v-model="chkPortOltChecked">
                                <span class="name">Port OLT</span>
                            </div>
                        </div>
                        <div class="value tracuu-splitter-theo-port-olt-ejs-multiselect">
                            <ejs-multiselect 
                                mode="CheckBox"
                                selectAllText="Chọn tất cả"
                                unSelectAllText="Bỏ chọn tất cả"
                                v-model="portOltId"
                                locale='vi-VN' 
                                :dataSource='dsPortOlt' 
                                :allowFiltering='true' 
                                :fields="{value:'PORTVL_ID', text: 'VITRI'}" 
                                :showSelectAll="true"
                                :showDropDownIcon="true"
                                :enabled="chkPortOltChecked"></ejs-multiselect>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-4 col-12">
                    <div class="info-row">
                        <div class="key w100">
                            Tên/Ký hiệu
                        </div>
                        <div class="value">
                            <input type="text" placeholder="Nhập tên/ký hiệu Splitter cần tìm" ref="input-ten-kyhieu" class="form-control highlight" v-model="kyHieu" v-on:keyup.enter="onClickButtonTraCuu">
                        </div>
                    </div>
                </div>
                <div class="col-sm-8 col-12">
                    <div class="info-row">
                        <div class="key w100">
                            Địa chỉ
                        </div>
                        <div class="value">
                            <input type="text" placeholder="Nhập địa chỉ/ghi chú" class="form-control highlight" v-model="diaChi">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="group-buttons marb10 mart10">
            <button class="btn btn-second button-note-bg padt5 padb5" @click="onClickButtonTraCuu">
                <span class="one-file-search normal inline vcenter f24"></span> Tra cứu
            </button>
            <button class="btn btn-second button-note-bg padt5 padb5" @click="onClickButtonLamLai">
                <span class="one-reload normal inline vcenter f24"></span> Làm lại
            </button>
            <div class="inline">
                <div class="list-note">
                    <span class="fw6 inline vcenter marl10">Ghi chú:</span>
                    <div class="inline item vcenter marl10">
                        <span class="shape inline vcenter w24 h24" style="background: #ED5050;"></span> Splitter đã hết cổng
                    </div>
                    <div class="inline item vcenter marl10">
                        <span class="shape inline vcenter w24 h24" style="background: #F39738;"></span> Splitter còn 1 cổng
                    </div>
                    <div class="inline item vcenter marl10">
                        <span class="shape inline vcenter w24 h24" style="background: #EAC344;"></span> Splitter còn 2 cổng
                    </div>
                </div>
            </div>
        </div>
        <div class="box-form tracuu-splitter-theo-port-olt">
            <div class="legend-title">Danh sách thuê bao</div>
            <div class="table-content grid">
                <ejs-treegrid
                    ref="grid-splitter"
                    class="table-result"
                    locale='vi-VN'
                    gridLines='Both'
                    childMapping="childrent"
                    clipMode="EllipsisWithTooltip"
                    :selectionSettings="{enableToggle: false}"
                    :pageSettings="{ pageSize: 10 }"
                    :dataSource="dsSplitterTree"
                    :allowPaging='false'
                    :allowFiltering='true'
                    :allowSorting="true"
                    :allowResizing='true'
                    :treeColumnIndex='1'
                    :dataBound="onDataBoundTreeGrid('grid-splitter')"
                    :queryCellInfo="onQueryCellInfo">
                    <e-columns>
                        <e-column field="" headerText='' textAlign="Center" width="20" clipMode="Ellipsis" :customAttributes="{class: 'cell-mark-selection'}" :allowResizing="false" :allowFiltering="false" :template='columnTemplate'></e-column>
                        <e-column field='TEN_KC' headerText='Tên Splitter' headerTextAlign='Center' width="130" :filterBarTemplate='filterBarTemplate'></e-column>
                        <e-column field='STT' headerText='STT' headerTextAlign='Center' width="80" textAlign="Right" :filterBarTemplate='filterBarTemplate'></e-column>
                        <e-column field='KETCUOI_ID' headerText='ID' headerTextAlign='Center' width="100" textAlign="Right" :filterBarTemplate='filterBarTemplate'></e-column>
                        <e-column field='CAP_SP' headerText='Cấp SP' headerTextAlign='Center' width="80" textAlign="Right" :filterBarTemplate='filterBarTemplate'></e-column>
                        <e-column field='NGAY_CN' headerText='Ngày cập nhật' headerTextAlign='Center' textAlign="Right" width="130" :filterBarTemplate='filterBarTemplate'></e-column>
                        <e-column field='DIACHI' headerText='Địa chỉ' headerTextAlign='Center' width="200" :filterBarTemplate='filterBarTemplate'></e-column>
                        <e-column field='DUNGLUONG' headerText='Dung lượng' headerTextAlign='Center' textAlign="Right" width="100" :filterBarTemplate='filterBarTemplate'></e-column>
                        <e-column field='DLSD' headerText='Đã dùng' headerTextAlign='Center' textAlign="Right" width="100" :filterBarTemplate='filterBarTemplate'></e-column>
                        <e-column field='DLROI' headerText='Chưa dùng' headerTextAlign='Center' textAlign="Right" width="100" :filterBarTemplate='filterBarTemplate'></e-column>
                        <e-column field='TEN_OLT' headerText='Thiết bị OLT' headerTextAlign='Center' width="130" :filterBarTemplate='filterBarTemplate'></e-column>
                        <e-column field='PORT_OLT' headerText='Cổng OLT (slot/port)' headerTextAlign='Center' textAlign="Right" width="100" :filterBarTemplate='filterBarTemplate'></e-column>
                    </e-columns>
                </ejs-treegrid>
            </div>
        </div>
    </div>
    <b-modal id="modal-tuychon" title="Tùy chọn" ok-only @ok="okChonKieuXuatExcel">
        <div style="position: relative;">
            <div>Chọn định dạng trình bày dữ liệu xuất</div>
            <div style="padding-left: 20px; padding-top: 10px;">
                <input type="radio" id="radio-dang-excel" :value="1" v-model="tuyChonXuatExcel">
                <label for="radio-dang-excel">Xuất dữ liệu dạng bảng excel</label>
            </div>
            <div style="padding-left: 20px">
                <input type="radio" id="radio-dang-tree" :value="2" v-model="tuyChonXuatExcel">
                <label for="radio-dang-tree">Xuất dữ liệu dạng cây (Giống như trên giao diện chương trình)</label>
            </div>          
        </div>
        <template #modal-footer="{ ok, cancel }">
            <b-button variant="primary" style="color: white" @click="ok()">Xác nhận</b-button>
            <b-button variant="secondary" style="color: white" @click="cancel()">Hủy bỏ</b-button>
        </template>
    </b-modal>
    <ModalXuatDuLieu 
        id="modal-xuat-dulieu-tracuu-splitter-theo-port-olt" 
        :thuocTinh="dsThuocTinh"
        :data="dsThueBaoXuatExcel"></ModalXuatDuLieu>
</div>